<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Adding Custom Password Complexity Policies</title><link rel="Prev" href="ta-using_password_complexity_policy.html" title="Previous" /><link rel="Next" href="co-working_with_response_header_rules.html" title="Next" /><link rel="StyleSheet" href="css/_my_webmethods_server_webhelp.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/_my_webmethods_server_webhelp_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/my-webmethods-server-webhelp/ta-customizing_password_complexity.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pt0X5m17licGovGT61xPLMQ" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/my-webmethods-server-webhelp/ta-customizing_password_complexity.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>My webMethods Server</span>&nbsp;10.15 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../my-webmethods-server-webhelp/to-about_mws_webhelp.html#wwconnect_header">My webMethods Server Webhelp</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../my-webmethods-server-webhelp/_my_webmethods_server_webhelp.1.139.html#wwconnect_header">Administering My webMethods Server</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../my-webmethods-server-webhelp/to-part_system_admin.html#wwconnect_header">System Administrator Functions</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../my-webmethods-server-webhelp/to-managing_security.html#wwconnect_header">Managing Security</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../my-webmethods-server-webhelp/ta-using_password_complexity_policy.html#wwconnect_header">Using Password Complexity Policies</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">Adding Custom Password Complexity Policies</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0ENV3S" class="Heading_5">Adding Custom Password Complexity Policies</div><div id="wwID0E1V3S" class="Body">To implement a custom password complexity policy, you include a password complexity Java class in a <span class="ph">Composite Application Framework</span> (CAF) application. When you deploy the application to <span class="ph">My webMethods Server</span>, the server registers the Java class. The password complexity policy component is then available for use during subsequent requests to the server. Implementing the password complexity policy does not require restarting <span class="ph">My webMethods Server</span>.</div><div id="wwID0EMW3S" class="Body">Before creating the Java class, you must create a CAF application in <span class="ph">Designer</span>. For more information about creating, working with, and deploying CAF applications, see <span class="ph"> </span><span class="ph_002c_Citation">webMethods CAF and OpenUI Development Help</span>.</div><div id="wwID0EAX3S" class="procedure"><span><img src="icon_task_xpe.png" alt="*" border="0" width="20" height="13" /></span>To implement a custom password complexity as a Java class</div><div id="wwID0EKX3S" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span><span class="Command"> In an existing CAF application in </span><span class="Command_002c_Command">Designer</span><span class="Command">, create a Java class that implements the </span><span class="Command_002c_apiname">ISystemPasswordComplexityPolicy</span><span class="Command"> interface. The component is registered as an OSGi service via the </span><span class="Command_002c_apiname">@Component</span><span class="Command"> annotation. </span></div><div id="wwID0EYY3S" class="Body_1">The following example shows how to implement the custom password complexity policy.</div><div id="wwID0E4Y3S" class="Preformatted_1">package caf.war.cafapp1.dir;<br /><br />import java.util.Map;<br />import java.util.regex.Pattern;<br />  <br />import org.osgi.service.component.annotations.Activate;<br />import org.osgi.service.component.annotations.Component;<br />import org.osgi.service.component.annotations.Deactivate;<br />import org.osgi.service.component.annotations.Reference;<br />import org.slf4j.Logger;<br />import org.slf4j.LoggerFactory;<br /> <br />import com.webmethods.portal.resources.Ui;<br />import com.webmethods.portal.service.dir.IDirPrincipal;<br />import com.webmethods.portal.service.dir.ISystemPasswordComplexityPolicy;<br />import com.webmethods.portal.service.global.IGlobalProvider;<br />import com.webmethods.portal.service.global.IMessageInfo;<br />import com.webmethods.portal.system.init.InitializationException;<br />  <br />/**<br /> * Custom implementation of password complexity policy<br /> */<br />@Component (<br />   service = {<br />       ISystemPasswordComplexityPolicy.class<br />   },<br />   property = {<br />       "name:String=CustomSystemPasswordComplexityPolicy1"<br />   },<br />   immediate = true<br />)<br />public class CustomSystemPasswordComplexityPolicy1 implements<br />        ISystemPasswordComplexityPolicy {<br />    private Logger logger = LoggerFactory.getLogger(getClass());<br /> <br />    //references to other services<br />    private IGlobalProvider gp = null;<br />    <br />    /**<br />     * Reference injection of the other OSGi service<br />     */<br />    @Reference<br />    protected void bindGlobalProvider(IGlobalProvider globalProvider) {<br />        if (logger.isTraceEnabled()) {<br />            logger.trace("Bound IGlobalProvider");<br />        }<br />  <br />        this.gp = globalProvider;<br />    }<br />  <br />    /**<br />     * Activation of OSGi declaritive service<br />     * @param config the configuration properties of the OSGi service<br />     * @throws InitializationException if activation fails<br />     */<br />    @Activate<br />    protected void activate(Map&lt;String,Object&gt; config) throws<br />InitializationException {<br />        if (logger.isInfoEnabled()) {<br />            logger.info("Activating service");<br />        }<br />    }<br />  <br />    /**<br />     * Deactivation of OSGi declaritive service<br />     */<br />    @Deactivate<br />    protected void deactivate() {<br />        if (logger.isInfoEnabled()) {<br />            logger.info("Deactivating service");<br />        }<br />    }<br />  <br />    /**<br />     * Check the candidate password to make sure the value satisfies the<br />complexity<br />     * requirements. If the password is not complex enough, this method<br />should throw<br />     * an {@link InvalidPasswordException} with the reason. If no exception<br />is thrown<br />     * the password is valid.<br />     *<br />     * @param candidatePassword the password to check<br />     * @throws InvalidPasswordException if the password is not valid<br />     */<br />    @Override<br />    public void checkPasswordForNewUser(String candidatePassword)<br />            throws InvalidPasswordException {<br />        if (candidatePassword == null || candidatePassword.length() &lt; 6) {<br />            IMessageInfo messageInfo = gp.getMessageInfo(Ui.class,<br />                    "password.too.short", null);<br />            String msg = messageInfo.getLocalizedMessage(false);<br />            throw new InvalidPasswordException(msg);<br />        }<br /> <br />        boolean hasUpper = !candidatePassword.toLowerCase().equals(candidatePassword);<br />        boolean hasLower = !candidatePassword.toUpperCase().equals(candidatePassword);<br />        if (!(hasUpper &amp;&amp; hasLower)) {<br />            IMessageInfo messageInfo = gp.getMessageInfo(Ui.class,<br />                    "password.mix.case", null);<br />            String msg = messageInfo.getLocalizedMessage(false);<br />            throw new InvalidPasswordException(msg);<br />        }<br />  <br />        boolean hasNumberOrSpecialChar = Pattern.matches(".*[\\W\\d]+.*$",<br />candidatePassword);<br />        if (!hasNumberOrSpecialChar) {<br />            IMessageInfo messageInfo = gp.getMessageInfo(Ui.class,<br />                    "password.special.char", null);<br />            String msg = messageInfo.getLocalizedMessage(false);<br />            throw new InvalidPasswordException(msg);<br />        }<br />    }<br />  <br />    /**<br />     * Check the candidate password to make sure the value satisfies the<br />complexity<br />     * requirements. If the password is not complex enough, this method<br />should throw<br />     * an {@link InvalidPasswordException} with the reason. If no exception<br />is thrown<br />     * the password is valid.<br />     *<br />     * @param user the user whose password is being checked.<br />     * @param candidatePassword the password to check<br />     * @throws InvalidPasswordException if the password is not valid<br />     */<br />    @Override<br />    public void checkPasswordForExistingUser(IDirPrincipal user,<br />            String candidatePassword) throws InvalidPasswordException {<br />        checkPasswordForNewUser(candidatePassword);<br />    }<br />  <br />    /**<br />     * Return how long a password is valid (in milliseconds) before it<br />expires. The user<br />     * will not be able to login after this time duration has expired<br />and the user must be<br />     * reset by an administrator or a custom reset password page.<br />     *<br />     * @param user the user to get the expiration value for.<br />     * @return return -1 for no password expiration, or the duration (in ms)<br />     */<br />    @Override<br />    public long getPasswordExpirationDuration(IDirPrincipal user) {<br />        try {<br />            if ("sysadmin".equals(user.getName())) {<br />                return -1; //don't expire the sysadmin password.<br />            }<br />        } catch (Exception e) {<br />            logger.warn(e.getMessage(), e);<br />        }<br />        return 1 * 60 * 60 * 1000; //1 hour<br />    }<br />  <br />    /**<br />     * Returns a description of the expected pattern a password must have.<br />This text<br />     * is displayed on the create user and update user pages of the UI.<br />     *<br />     * @return password descriptive text.<br />     */<br />    @Override<br />    public String getPasswordPatternText() {<br />        IMessageInfo messageInfo = gp.getMessageInfo(Ui.class,<br />                 "password.complexity.description", null);<br />        return messageInfo.getLocalizedMessage(false);<br />    }<br />  }</div><div id="wwID0EFZ3S" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span><span class="Command">Deploy the application to </span><span class="Command_002c_Command">My webMethods Server</span><span class="Command">. </span></div><div id="wwID0EC13S" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span><span class="Command">Configure </span><span class="Command_002c_Command">My webMethods Server</span><span class="Command"> to use your custom class on the </span><span class="Command_002c_uicontrol">Properties</span><span class="Command"> page for the </span><span class="Command_002c_codeph">system</span><span class="Command"> directory service, as described in </span>
    <a href="../my-webmethods-server-webhelp/ta-using_password_complexity_policy.html#wwID0E2H3S"
   
     title="Using Password Complexity Policies"
    ><span class="Command_002c_heading-page">Using Password Complexity Policies</span></a><span class="Command">. </span></div><div id="wwID0EV23S" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>4. </span></span><span class="Command">Debug and test the Java class. </span></div><div id="wwID0EL33S" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>5. </span></span><span class="Command"> If required, make further changes to the Java class and repeat steps 2 and 3 until the class works as expected. </span></div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright Â© 2004-2023&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>