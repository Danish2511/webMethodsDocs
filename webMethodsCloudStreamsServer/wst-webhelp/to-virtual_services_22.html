<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>The Content-Based Routing Rule Step (SOAP)</title><link rel="Prev" href="to-virtual_services_21.html" title="Previous" /><link rel="Next" href="to-virtual_services_23.html" title="Next" /><link rel="StyleSheet" href="css/_cloudstreams_webhelp.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/_cloudstreams_webhelp_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/wst-webhelp/to-virtual_services_22.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pN_002bVsdzdaU_002b7kweBXz7HbRTA" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/wst-webhelp/to-virtual_services_22.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>CloudStreams</span>&nbsp;10.15 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../wst-webhelp/to-wst_webhelp_landing_page.html#wwconnect_header">webMethods CloudStreams Documentation</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../wst-webhelp/_cloudstreams_webhelp.1.006.html#wwconnect_header">Administering webMethods CloudStreams</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../wst-webhelp/to-virtual_services.html#wwconnect_header">Virtual Services</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../wst-webhelp/to-virtual_services_12.html#wwconnect_header">Creating a New Virtual Service (SOAP)</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../wst-webhelp/to-virtual_services_15.html#wwconnect_header">The In Sequence Step (SOAP)</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../wst-webhelp/to-virtual_services_19.html#wwconnect_header">The Routing Rule Step for HTTP or HTTPS (SOAP)</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">The Content-Based Routing Rule Step (SOAP)</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0E5OIM" class="Heading_6">The <span class="Quote">Content-Based</span> Routing Rule Step (SOAP)</div><div id="wwID0EUPIM" class="Body">If you have a native service that is hosted at two or more endpoints, you can use the Content-Based routing protocol to route specific types of messages to specific endpoints based on specific values that appear in the request message.</div><div id="wwID0EZPIM" class="Body">You might use this capability, for example, to determine which operation the consuming application has requested, and route requests for complex operations to an endpoint on a fast machine.</div><div id="wwID0E5PIM" class="Body">The requests are routed according to the content-based routing rules you create. That is, they are routed based on the successful evaluation of one or more XPath expressions that are constructed utilizing the content of the request payload. For example, a routing rule might allow requests for half of the methods of a particular service to be routed to Service A, and the remaining methods to be routed to Service B.</div><div id="wwID0EDQIM" class="procedure"><span><img src="icon_task_xpe.png" alt="*" border="0" width="20" height="13" /></span>To configure the <span class="Quote">Routing Rule</span> step for <span class="procedure">Content-Based</span> routing (SOAP)</div><div id="wwID0E1QIM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span><span class="Command">Open </span><span class="Command_002c_Command">Software AG Designer</span><span class="Command"> and display the </span><span class="Command_002c_Command">CloudStreams</span><span class="Command"> Development perspective by clicking </span><span class="Command_002c_uicontrol">Window &gt; Open Perspective &gt; Other &gt; CloudStreams Development</span><span class="Command">. </span></div><div id="wwID0EFSIM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span><span class="Command">In the </span><span class="Command_002c_Command">CloudStreams</span><span class="Command"> Governance view, expand your </span><span class="Command_002c_Command">CloudStreams</span><span class="Command"> Governance project and double-click the virtual service name. </span></div><div id="wwID0EKTIM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span><span class="Command">Expand </span><span class="Command_002c_uicontrol">In Sequence</span><span class="Command">. </span></div><div id="wwID0EJUIM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>4. </span></span><span class="Command">Click </span><span class="Command_002c_uicontrol">Routing Rule</span><span class="Command"> and complete the fields in the </span><span class="Command_002c_uicontrol">General</span><span class="Command"> page in the Properties view as follows. </span></div><div class="ww_skin_page_overflow"><table class="NoRules2" cellspacing="0" summary=""><tr><td class="Table_Cell_Head" style="padding-left: 2pt; padding-right: 2pt; width: 90pt"><div id="wwID0EXWIM" class="Table_Cell_Head">Option</div></td><td class="Table_Cell_Head" style="padding-left: 2pt; padding-right: 2pt; width: 324pt"><div id="wwID0E4WIM" class="Table_Cell_Head">Description</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EMXIM" class="Table_Cell"><span class="uicontrol">Name</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EWXIM" class="Table_Cell">You can optionally change the step name. There are no naming restrictions.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EBYIM" class="Table_Cell"><span class="uicontrol">Type</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ELYIM" class="Table_Cell">(Read-only field.) <span class="uicontrol">Routing Rule</span>.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E2YIM" class="Table_Cell"><span class="uicontrol">Protocol</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EFZIM" class="Table_Cell">(Read-only field.) <span class="uicontrol">HTTP</span>.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EVZIM" class="Table_Cell"><span class="uicontrol">Routing Type</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E6ZIM" class="Table_Cell">Select <span class="uicontrol">Content-Based</span>.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EP1IM" class="Table_Cell"><span class="uicontrol">Rule Name</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E61IM" class="Table_Cell">Assign a name to the rule.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EK2IM" class="Table_Cell"><span class="uicontrol">XPath</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E12IM" class="Table_Cell">Create an XPath expression as follows:</div><div id="wwID0EF3IM" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Click the icon next to this field to display the XPath Editor.</div><div id="wwID0EY3IM" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>In the XPath Editor that appears, the <span class="uicontrol">Namespace</span> tab displays all predefined namespaces in the WSDL. If you want to add custom namespaces, click <span class="uicontrol">Add Custom Namespace/prefix</span>, specify a name and value for the namespace, and click <span class="uicontrol">OK</span>. To add additional rows, use the plus button at the end of the row to add them.</div><div id="wwID0EX4IM" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>In the XPath Editor's <span class="uicontrol">Nodes</span> tab, expand the namespace's node, choose the method you want for the XPath expression, and click <span class="uicontrol">OK</span>.</div><div id="wwID0ES5IM" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>In the XPath Editor's <span class="uicontrol">Evaluator</span> tab, evaluate the XPath expression by specifying an argument in the <span class="uicontrol">XPath Expression</span> field, and clicking <span class="uicontrol">Evaluate</span>.</div><div id="wwID0ER6IM" class="Numbered_1_Continued">The true/false result of the evaluation is displayed in the <span class="uicontrol">Result</span> field.</div><div id="wwID0E46IM" class="Table_Cell">To specify additional XPath expressions, use the plus button at the end of the row to add them.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EIAJM" class="Table_Cell"><span class="uicontrol">Route To</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ESAJM" class="Table_Cell">Specify where to route the request if the rule criteria are met. Specify either the URL of a native service or a connection pool name.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EEBJM" class="Table_Cell">Click the icon next to this field and complete the Configure Endpoint Properties dialog box as follows:</div><div id="wwID0EQBJM" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="uicontrol">Optimization Method</span>: Select one of the following options:</div><div id="wwID0ELCJM" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="uicontrol">None</span>: The default.</div><div id="wwID0EBDJM" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="uicontrol">MTOM</span>: Indicates that <span class="ph">CloudStreams</span> expects to receive a request with a Message Transmission Optimization Mechanism (MTOM) attachment, and will forward the attachment to the native service.</div><div id="wwID0E2DJM" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="uicontrol">SwA</span>: Indicates that <span class="ph">CloudStreams</span> expects to receive a <span class="Quote">SOAP with Attachment</span> (SwA) request, and will forward the attachment to the native service.</div><div id="wwID0E1EJM" class="Note_2"><span class="Bold">Note:<br /></span>Bridging between SwA and MTOM is not supported. If a consumer sends an SwA request, <span class="ph">CloudStreams</span> can only forward SwA to the native provider. The same is true for MTOM, and applies to responses received from the native provider. That is, an SwA or MTOM response received by <span class="ph">CloudStreams</span> from a native provider will be forwarded to the caller using the same format it received.</div><div id="wwID0EYFJM" class="Note_2"><span class="Bold">Note:<br /></span>When sending SOAP requests that do not contain a MTOM or SWA attachment to a virtual service for a native provider endpoint that returns an MTOM or SWA response, the request <span class="parmname">Accept</span> header must be set to 'multipart/related' (or the virtual service's Request Processing Step should include an IS service callout that sets the BUILDER_TYPE context variable to 'multipart/related'). This is necessary so <span class="ph">CloudStreams</span> knows how to parse the response properly.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EUHJM" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="uicontrol">Connection Timeout</span>: The time interval (in seconds) after which a connection attempt will timeout. If a value is not specified (or if the value 0 is specified), <span class="ph">CloudStreams</span> will use the default value specified in <span class="ph">Integration Server</span>.</div><div id="wwID0ESIJM" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="uicontrol">Read Timeout</span>: The time interval (in seconds) after which a socket read attempt will timeout. If a value is not specified (or if the value 0 is specified), the default is 30 seconds.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ECKJM" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="uicontrol">SSL Options</span>: Optional. To enable SSL client authentication for the endpoint, you must specify values for both the <span class="uicontrol">Client Certificate Alias</span> field and the <span class="uicontrol">IS Keystore Alias</span> field. If you specify a value for only one of these fields, a deployment error will occur. You may leave both fields blank.</div><div id="wwID0EFLJM" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="uicontrol">Client Certificate Alias</span>: The client's private key to be used for performing SSL client authentication.</div><div id="wwID0E2LJM" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="uicontrol">IS Keystore Alias</span>: The keystore alias of the instance of <span class="ph">Integration Server</span> on which <span class="ph">CloudStreams</span> is running. This value (along with the value of <span class="uicontrol">Client Certificate Alias</span>) will be used for performing SSL client authentication.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EGNJM" class="Table_Cell"><span class="uicontrol">Default To</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EWNJM" class="Table_Cell">Enter a native service endpoint to route the request to in case all routing rules evaluate to False. Then, click the icon next to this field and complete the Configure Endpoint Properties dialog box, as described for the <span class="uicontrol">Route To</span> field above.</div></td></tr></table></div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright Â© 2013-2022&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>