<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Health Monitor Plugin</title><link rel="Prev" href="to-servletplugin.html" title="Previous" /><link rel="Next" href="co-about_exporting_and_importing_realm_xml_config.html" title="Next" /><link rel="StyleSheet" href="css/_universal_messaging_docset_reverb_diba2.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/_universal_messaging_docset_reverb_diba2_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/num-webhelp/co-health_monitor_plugin.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pdAW8HRrfkgzGibd5WqEaSQ" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/num-webhelp/co-health_monitor_plugin.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>Universal Messaging</span>&nbsp;10.15 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../num-webhelp/to-title_administration_guide.html#wwconnect_header">Administration Guide</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../num-webhelp/to-overview_enterprise_manager.html#wwconnect_header">Universal Messaging Enterprise Manager</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../num-webhelp/to-overview-plugins.html#wwconnect_header">Plugins</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">Health Monitor Plugin</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0E3UTS" class="Heading_3">Health Monitor Plugin</div><div id="wwID0EEVTS" class="Body">The Health Monitor plugin adds an HTTP REST endpoint to the URL of the session to which the realm server is connected. This allows clients to query the current state of the realm server. The endpoint defines the "liveness" of the server. The plugin returns the result of the health checks that run on the server at periodic intervals.</div><div id="wwID0EQVTS" class="Section_Title">Adding the plugin to the realm server</div><div id="wwID0EVVTS" class="Body">The plugin can be added to a realm server using either of the following methods:</div><div id="wwID0ETWTS" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Using the <span class="uicontrol">Add Plugin</span> feature in the <span class="uicontrol">Comms &gt; Interfaces &gt; Plugins</span> dialog of the Enterprise Manager. In this case, you define the name of the new URL endpoint in the <span class="uicontrol">URL Path</span> field of the <span class="uicontrol">Add Plugin</span> dialog.</div><div id="wwID0EVXTS" class="List_1_Continued">See the section 
    <a href="../num-webhelp/to-overview-plugins.html#wwID0EXNQS"
   
     title="Plugins"
    ><span class="heading-page">Plugins</span></a> for details.</div><div id="wwID0E1YTS" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Using the command line tool <span class="codeph">AddHealthMonitorPlugin</span>. In this case, you define the name of the new URL endpoint using the <span class="codeph">-mountpath</span> argument of the tool.</div><div id="wwID0EUZTS" class="List_1_Continued">For details of running this command line tool, see the section 
    <a href="../num-webhelp/co-clu_syntax_miscellaneous.html#wwID0ET2VU"
   
     title="Syntax: Miscellaneous Tools"
    ><span class="heading-page">Syntax: Miscellaneous Tools</span></a>.</div><div id="wwID0EP1TS" class="Section_Title">Endpoints</div><div id="wwID0EU1TS" class="Body">Endpoints do not support authentication and to ensure secure access to the endpoint, you must configure the endpoint over an HTTPs interface. If the requested endpoint is not valid, the browser returns a "404" error code with a "Not Found" response status.</div><div id="wwID0EZ1TS" class="Body">Following is a list of the available endpoints and their function:</div><div id="wwID0EE2TS" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="inlinetitle">HealthMonitor</span></div><div id="wwID0E22TS" class="List_1_Continued">To access the HealthMonitor endpoint use either a blank mount point (/) or "health" mount point (/health).</div><div id="wwID0EA3TS" class="List_1_Continued">For example, if your server mount point is "monitor," the URL is: <span class="filepath">http://localhost:9000/monitor/</span> or <span class="filepath">http://localhost:9000/monitor/health</span>.</div><div id="wwID0EO3TS" class="List_1_Continued">The realm server runs four different tasks at regular intervals on the server to monitor the health status of the server:</div><div id="wwID0EZ3TS" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="ph">Memory monitor Task (MemoryHealthMonitor):</span></div><div id="wwID0EP4TS" class="List_2_Continued">This task monitors the memory status of the server and will produce an alert/error as soon as any memory related issues are found. The task checks the heap and direct memory usage, and if the usage exceeds a threshold value of 95%, then it is considered as an error and the error will be reported and logged.</div><div id="wwID0EU4TS" class="List_2_Continued">The server is not considered to be unhealthy when the first such error occurs; instead a server is considered unhealthy only if the memory monitor task returns an error 3 times consecutively.</div><div id="wwID0E14TS" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="ph">Stalled-Tasks Monitor Task (StalledTasksMonitor):</span></div><div id="wwID0EQ5TS" class="List_2_Continued">If any thread pool has more than 5 stalled tasks, this is considered an error, but the status is only reported as unhealthy if the error occurs 5 times consecutively.</div><div id="wwID0EW5TS" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="ph">Cluster state monitor Task (ClusterStateMonitor):</span></div><div id="wwID0EM6TS" class="List_2_Continued">If a server is configured to be part of a cluster, and the last time that the server successfully joined the cluster is more than 600000 milliseconds (10 minutes) ago, then the server is considered to be unhealthy.</div><div id="wwID0ES6TS" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="ph">Server round trip Task (ServerRoundTripMonitor):</span></div><div id="wwID0EIAUS" class="List_2_Continued">The server round trip checks the processing time in a cluster. <span class="codeph">nClusterRoundTripEvent</span> events are synchronous events that measure the processing time in a cluster. The realm server sends these events into the cluster and records the time it takes to complete the processing in cluster. If the event takes more than 30 seconds to complete processing and get acknowledged, then that is considered to be an error. Not getting an acknowledgement back for this event is also considered to be an error. If 5 consecutive such errors, the server is considered to be unhealthy.</div><div id="wwID0EUAUS" class="List_1_Continued"><span class="inlinetitle">Server Responses</span></div><div id="wwID0E5AUS" class="List_1_Continued">If the server is fully operational, and is an active member of a cluster, the query returns a response "OK" of the following form:</div><div id="wwID0EDBUS" class="Preformatted_1">{"ServerStatus":"OK","ServerStatusDetails":"{}"}</div><div id="wwID0EJBUS" class="List_1_Continued">Even when the return code is "OK", the response can contain additional information (in JSON format), such as useful statistics, or as an indication that the server is approaching certain limits.</div><div id="wwID0EOBUS" class="List_1_Continued">If the server is not fully operational, the query returns a status "ERROR" with an appropriate description of the problem, for example:</div><div id="wwID0ETBUS" class="Preformatted_1"><br />{"ServerStatus":"ERROR","ServerStatusDetails":<br />  {"MemoryHealthMonitor":<br />    "Max threshold of used Heap memory is exceeded, Heap memory used - 338 MB"<br />  }<br />}</div><div id="wwID0E1BUS" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="inlinetitle">IsMaster</span></div><div id="wwID0ERCUS" class="List_1_Continued">The IsMaster endpoint determines whether the current server is the primary node in a cluster.</div><div id="wwID0EWCUS" class="List_1_Continued">To access the IsMaster endpoint use the "IsMaster" mount point. This mount point is not case-sensitive. "IsMaster," "isMaster," and "ismaster" are all valid values.</div><div id="wwID0E2CUS" class="List_1_Continued">For example, if your server mount point is "monitor," the URL is: <span class="filepath">http://localhost:9000/monitor/isMaster</span>.</div><div id="wwID0EFDUS" class="List_1_Continued"><span class="inlinetitle">Server Responses</span></div><div id="wwID0EPDUS" class="List_1_Continued">If the server is fully operational, and is the primary node of the cluster, the query returns a response "OK (200)" of the following form:</div><div id="wwID0EUDUS" class="Preformatted_1">{"ClusterState":"MASTER"}</div><div id="wwID0E1DUS" class="List_1_Continued">If the server is not fully operational, the query returns a status "Service Unavailable” (503)" with an appropriate description of the problem, for example:</div><div id="wwID0EFEUS" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>The server is part of an active cluster as a secondary node:</div><div id="wwID0EYEUS" class="Preformatted_2">{"ClusterState":"SLAVE"}</div><div id="wwID0E6EUS" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>The server is part of a cluster which is not active:</div><div id="wwID0ESFUS" class="Preformatted_2">{"ClusterState":"OFFLINE"}</div><div id="wwID0EZFUS" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>The server is part of an active cluster, but is currently reconnecting to it:</div><div id="wwID0EMGUS" class="Preformatted_2">{"ClusterState":"RECOVERY"}</div><div id="wwID0ETGUS" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>The server is not part of a cluster:</div><div id="wwID0EGHUS" class="Preformatted_2">{"ClusterState":"NON_CLUSTERED"}</div><div id="wwID0EPHUS" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="inlinetitle">GetClusterState</span></div><div id="wwID0EGIUS" class="List_1_Continued">The GetClusterState endpoint determines the current cluster state of a given server.</div><div id="wwID0ELIUS" class="List_1_Continued">To access the GetClusterState endpoint use the "GetClusterState" mount point. This mount point is not case-sensitive. "GetClusterState," "getClusterState," and "getclusterstate" are all valid values.</div><div id="wwID0EQIUS" class="List_1_Continued">For example, if your server mount point is "monitor," the URL is: <span class="filepath">http://localhost:9000/monitor/getClusterState</span>.</div><div id="wwID0E1IUS" class="List_1_Continued"><span class="inlinetitle">Server Responses</span></div><div id="wwID0EEJUS" class="List_1_Continued">Regardless of the cluster state of the server, the query returns the response "OK (200)" for the same scenarios described for the IsMaster endpoint.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright © 2013-2022&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>