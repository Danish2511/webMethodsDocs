<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>AMQP Transactions</title><link rel="Prev" href="co-amqp_messages.html" title="Previous" /><link rel="Next" href="co-amqp_client_libraries.html" title="Next" /><link rel="StyleSheet" href="css/_universal_messaging_docset_reverb_diba2.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/_universal_messaging_docset_reverb_diba2_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/num-webhelp/co-amqp_transactions.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pN2hYUj3iAdg_002b4aBfj8M40KQ" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/num-webhelp/co-amqp_transactions.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>Universal Messaging</span>&nbsp;10.15 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../num-webhelp/to-title_concepts.html#wwconnect_header">Concepts</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../num-webhelp/to-amqp_header.html#wwconnect_header">AMQP</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../num-webhelp/to-title_amqp_guide.html#wwconnect_header">AMQP Guide</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">AMQP Transactions</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0E3ERQ" class="Heading_3">AMQP Transactions</div><div id="wwID0EEFRQ" class="Body">Transactional messaging allows for the coordinated outcome of otherwise independent transfers, extending to an arbitrary number of message transfers spread across any number of distinct links in either direction.</div><div id="wwID0EJFRQ" class="Body">An AMQP transaction scenario extends the roles of the two AMQP containers enclosing the Sender and Receiver nodes, to additionally act as a transactional controller and transactional resource respectively. This is established over a control link initiated by the controller, while allocation and completion are communicated using the AMQP <span class="codeph">declare</span> and <span class="codeph">discharge</span> type messages.</div><div id="wwID0EXFRQ" class="Body">In an brokered environment such as one that involves Universal Messaging, AMQP transactions are involved in transactional publishing or transactional subscribing where the UM realm is the transactional resource and the AMQP application is the transactional controller.</div><div id="wwID0EDGRQ" class="Section_Title">Transactional Capabilities</div><div id="wwID0EIGRQ" class="Body">To initiate an AMQP transaction, the container acting as the transactional controller establishes a control link to the container acting as the transactional resource. During this handshake, the containers exchange capability maps to determine if the transactional capability can be supported. The following table illustrates these capabilities:</div><div class="ww_skin_page_overflow"><table class="rules1" cellspacing="0" summary=""><tr><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EUHRQ" class="Table_Cell_Head">AMQP Transactional Capability</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0E1HRQ" class="Table_Cell_Head">AMQP Symbol</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EAIRQ" class="Table_Cell_Head">Description</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EGIRQ" class="Table_Cell_Head">UM 10.15</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EUIRQ" class="Table_Cell">Local Transactions</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E1IRQ" class="Table_Cell">amqp:local-transactions</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EAJRQ" class="Table_Cell">Indicates support local transactions.</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div class="ww_skin_page_overflow"><div id="wwID0EGJRQ" class="Table_Cell"><img class="Default" src="../num-webhelp/images/green_tick_icon.png" width="100%" style="display: inline; float: none; left: 0pt; max-height: 16px; max-width: 16px; top: 0pt" alt="(tick)" /></div></div></td></tr></table></div><div id="wwID0EZJRQ" class="Body">Description: When a UM realm acts as an AMQP container, it advertises AMQP local transaction capability.</div><div class="ww_skin_page_overflow"><table class="rules1" cellspacing="0" summary=""><tr><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EFLRQ" class="Table_Cell_Head">AMQP Transactional Capability</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0ELLRQ" class="Table_Cell_Head">AMQP Symbol</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0ERLRQ" class="Table_Cell_Head">Description</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EXLRQ" class="Table_Cell_Head">UM 10.15</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EFMRQ" class="Table_Cell">Distributed Transactions</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ELMRQ" class="Table_Cell">amqp:distributed-transactions</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ERMRQ" class="Table_Cell">Indicates support AMQP Distributed Transactions</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div class="ww_skin_page_overflow"><div id="wwID0EXMRQ" class="Table_Cell"><img class="Default" src="../num-webhelp/images/red_cross_icon.png" width="100%" style="display: inline; float: none; left: 0pt; max-height: 16px; max-width: 16px; top: 0pt" alt="(error)" /></div></div></td></tr></table></div><div id="wwID0EKNRQ" class="Body">Description: Distributed transactions are not currently defined by the AMQP specification.</div><div class="ww_skin_page_overflow"><table class="rules1" cellspacing="0" summary=""><tr><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EWORQ" class="Table_Cell_Head">AMQP Transactional Capability</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0E3ORQ" class="Table_Cell_Head">AMQP Symbol</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0ECPRQ" class="Table_Cell_Head">Description</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EIPRQ" class="Table_Cell_Head">UM 10.15</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EWPRQ" class="Table_Cell">Promotable Transactions</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E3PRQ" class="Table_Cell">amqp:promotable-transactions</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ECQRQ" class="Table_Cell">Indicates support AMQP Promotable Transactions</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div class="ww_skin_page_overflow"><div id="wwID0EIQRQ" class="Table_Cell"><img class="Default" src="../num-webhelp/images/red_cross_icon.png" width="100%" style="display: inline; float: none; left: 0pt; max-height: 16px; max-width: 16px; top: 0pt" alt="(error)" /></div></div></td></tr></table></div><div id="wwID0E2QRQ" class="Body">Description: Promotable transactions are not currently supported in Universal Messaging.</div><div class="ww_skin_page_overflow"><table class="rules1" cellspacing="0" summary=""><tr><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EHSRQ" class="Table_Cell_Head">AMQP Transactional Capability</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0ENSRQ" class="Table_Cell_Head">AMQP Symbol</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0ETSRQ" class="Table_Cell_Head">Description</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EZSRQ" class="Table_Cell_Head">UM 10.15</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EHTRQ" class="Table_Cell">Multi Transactions Per Session</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ENTRQ" class="Table_Cell">amqp:multi-txns-per-ssn</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ETTRQ" class="Table_Cell">Indicates support multiple active transactions on a single session</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div class="ww_skin_page_overflow"><div id="wwID0EZTRQ" class="Table_Cell"><img class="Default" src="../num-webhelp/images/red_cross_icon.png" width="100%" style="display: inline; float: none; left: 0pt; max-height: 16px; max-width: 16px; top: 0pt" alt="(error)" /></div></div></td></tr></table></div><div id="wwID0EMURQ" class="Body">Description: Multiple transactions per session are not currently supported in Universal Messaging.</div><div class="ww_skin_page_overflow"><table class="rules1" cellspacing="0" summary=""><tr><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EYVRQ" class="Table_Cell_Head">AMQP Transactional Capability</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0E5VRQ" class="Table_Cell_Head">AMQP Symbol</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EEWRQ" class="Table_Cell_Head">Description</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EKWRQ" class="Table_Cell_Head">UM 10.15</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EYWRQ" class="Table_Cell">Multi Sessions Per Transaction</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E5WRQ" class="Table_Cell">amqp:multi-ssns-per-txn</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EEXRQ" class="Table_Cell">Indicates support transactions whose txn-id is used across sessions on one connection</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div class="ww_skin_page_overflow"><div id="wwID0EKXRQ" class="Table_Cell"><img class="Default" src="../num-webhelp/images/red_cross_icon.png" width="100%" style="display: inline; float: none; left: 0pt; max-height: 16px; max-width: 16px; top: 0pt" alt="(error)" /></div></div></td></tr></table></div><div id="wwID0E4XRQ" class="Body">Description: Multiple sessions per transaction are not currently supported in Universal Messaging.</div><div id="wwID0EKYRQ" class="Section_Title">Transaction Declare</div><div id="wwID0EPYRQ" class="Body">To begin transactional work, a transaction needs to be declared. After the control link is established, the transaction controller container sends a special AMQP message to the transaction <span class="codeph">coordinator</span> container, whose body consists of the <span class="codeph">declare</span> type in a single <span class="codeph">amqp-value</span> section. A successful transaction declare, concludes with the coordinator container settling the declaration with a disposition outcome of <span class="codeph">declared</span>, allowing the controller container to use it for message transfers.</div><div id="wwID0ENZRQ" class="Section_Title">Transaction Discharge</div><div id="wwID0ESZRQ" class="Body">To conclude transactional work, a transaction needs to be discharged. This is done by the transactional controller container sending a special AMQP message to the transaction coordinator container, whose body consists of the <span class="codeph">discharge</span> type in a single <span class="codeph">amqp-value</span> section. In order to indicate a successful or failing discharge, the transaction controller container uses the fail flag on indicates that it wishes to commit or rollback the transactional work by setting the fail flag on the <span class="codeph">discharge</span> body. Please note that the transaction coordinator can always also indicate a failing discharge if it is unable to honor the transaction controller's request.</div><div id="wwID0EM1RQ" class="Section_Title">Transactional Delivery State</div><div id="wwID0ER1RQ" class="Body">AMQP transactions introduce an additional message delivery state called transactional state, which effectively wraps a regular message delivery state with a transaction ID. As discussed in previous sections, AMQP message deliveries consist of a notion of settlement which indicates when a node gives up trying to deliver a transfer and forgets all state. AMQP transactions do not change this model but interact with it as defined in the following sections.</div><div id="wwID0EW1RQ" class="Body">NOTE: In Universal Messaging, AMQP delivery tags are uniquely identified using a long:long naming scheme consisting of &lt;store unique ID&gt;:&lt;EID&gt; . In transactional scenarios, the UM native TX ID is mapped to the AMQP TX ID.</div><div id="wwID0ED2RQ" class="Section_Title">Transactional Publishing</div><div id="wwID0EI2RQ" class="Body">When the AMQP transaction controller container wishes to publish transactionally, it sets the delivery state to <span class="codeph">transactional-state</span>, as explained in the previous section and pointing to a declared TX ID. This transactional state has the effect of the message not being available at the destination node of the transactional resource container, until after the transaction has been successfully discharged.</div><div id="wwID0ES2RQ" class="Body">On receiving a non-settled delivery associated with a TX id, the transactional resource container sends a <span class="codeph">disposition</span> response similar to the when non transactional publishing is used, with the delivery state being a <span class="codeph">transactional-state</span> .</div><div id="wwID0EA3RQ" class="Body">The following table illustrates how this is mapped to a successful Universal Messaging transactional publish, which is disposed with an accept state:</div><div class="ww_skin_page_overflow"><table class="rules1" cellspacing="0" summary=""><tr><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EM4RQ" class="Table_Cell_Head">Remote Disposition State</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0ES4RQ" class="Table_Cell_Head">UM Transformer Result</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EY4RQ" class="Table_Cell_Head">Sender Settle Mode</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0E54RQ" class="Table_Cell_Head">UM 10.15</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EM5RQ" class="Table_Cell">transactional</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ES5RQ" class="Table_Cell">NOT null</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EY5RQ" class="Table_Cell">N/A</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div class="ww_skin_page_overflow"><div id="wwID0E55RQ" class="Table_Cell"><img class="Default" src="../num-webhelp/images/green_tick_icon.png" width="100%" style="display: inline; float: none; left: 0pt; max-height: 16px; max-width: 16px; top: 0pt" alt="(tick)" /></div></div></td></tr></table></div><div id="wwID0ER6RQ" class="Body">Description: When UM receives a non-partial delivery transactional delivery, it tries to examine and transform its contents using the configured UM transformer. Following that, an asynchronous UM TX native publish request is queued. Finally, when the UM server has processed the native TX publish request, it will accept it with a transaction state set to the TX ID and advance the link ONLY If it is not already settled. If it is already settled, no further action will be taken. This is equivalent to a UM TX publisher.</div><div id="wwID0EW6RQ" class="Body">The following table illustrates how this is mapped to an unsuccessful Universal Messaging transactional publish, which is disposed with a rejected state:</div><div class="ww_skin_page_overflow"><table class="rules1" cellspacing="0" summary=""><tr><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EIBSQ" class="Table_Cell_Head">Remote Disposition State</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EOBSQ" class="Table_Cell_Head">UM Transformer Result</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EUBSQ" class="Table_Cell_Head">Sender Settle Mode</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0E1BSQ" class="Table_Cell_Head">AMQP Errors</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EACSQ" class="Table_Cell_Head">UM 10.15</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EOCSQ" class="Table_Cell">transactional</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EUCSQ" class="Table_Cell">NOT null</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E1CSQ" class="Table_Cell">N/A</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EADSQ" class="Table_Cell">amqp:unauthorized-access (fatal) amqp:resource-limit-exceeded (transient) amqp:internal-error (fatal) amqp:not-found (fatal)</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div class="ww_skin_page_overflow"><div id="wwID0EGDSQ" class="Table_Cell"><img class="Default" src="../num-webhelp/images/green_tick_icon.png" width="100%" style="display: inline; float: none; left: 0pt; max-height: 16px; max-width: 16px; top: 0pt" alt="(tick)" /></div></div></td></tr></table></div><div id="wwID0EZDSQ" class="Body">As discussed in the accepted state mappings, a transactional AMQP publisher with these settings is mapped to an asynchronous UM TX native publish request getting queued. When the UM server has completed processing the native TX publish request, and an error has occurred, the delivery is rejected and settled as follows:</div><div id="wwID0ECESQ" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span>amqp:unauthorized-access : UM ACLs do not allow publishing for this subject. This is a fatal error so the link is closed.</div><div id="wwID0ETESQ" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span>amqp:resource-limit-exceeded: UM store capacity has been reached. This is a transient error so the link is advanced.</div><div id="wwID0EEFSQ" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span>amqp:internal-error: An unexpected UM internal error has occurred. This is a fatal error so the link is closed.</div><div id="wwID0EVFSQ" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>4. </span></span>amqp:not-found: The UM server is unable to find the destination node. This is fatal error so the link is closed.</div><div id="wwID0EPGSQ" class="Section_Title">Transactional Subscribing</div><div id="wwID0EUGSQ" class="Body">When an AMQP transaction controller container wishes to associate the outcome of a delivery with a transaction it sets the state of the delivery to a <span class="codeph">transactional-state</span> as explained in previous sections. and pointing to a declared TX id. This transactional state has the effect of the message not being released from the transactional resource container, until after the transaction has been successfully discharged.</div><div id="wwID0E5GSQ" class="Body">On receiving a non-settled delivery associated with a TX id, the transactional controller container sends a <span class="codeph">disposition</span> response similar to the when non transactional subscribing is used, with the delivery state being a <span class="codeph">transactional-state</span>.</div><div id="wwID0EMHSQ" class="Body">The following table illustrates how this is mapped to an successful Universal Messaging durable topic ack / transactional queue reader commit, which is disposed with an accept state:</div><div class="ww_skin_page_overflow"><table class="rules1" cellspacing="0" summary=""><tr><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0E5ISQ" class="Table_Cell_Head">Remote Disposition State</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EEJSQ" class="Table_Cell_Head">Delivery Settled</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EKJSQ" class="Table_Cell_Head">Receiver Settle Mode</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EQJSQ" class="Table_Cell_Head">Source Durability</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EWJSQ" class="Table_Cell_Head">UM 10.15</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EEKSQ" class="Table_Cell">transactional</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EKKSQ" class="Table_Cell">N/A</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EQKSQ" class="Table_Cell">N/A</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EWKSQ" class="Table_Cell">N/A</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div class="ww_skin_page_overflow"><div id="wwID0E3KSQ" class="Table_Cell"><img class="Default" src="../num-webhelp/images/green_tick_icon.png" width="100%" style="display: inline; float: none; left: 0pt; max-height: 16px; max-width: 16px; top: 0pt" alt="(tick)" /></div></div></td></tr></table></div><div id="wwID0EQLSQ" class="Body">Descruption: When UM receives an unsettled disposition frame with a remote state of transactional, it first extracts the delivery tag which is expected in the form &lt;um store uniqueid&gt;:&lt;um event EID&gt;, followed by extracting the durable name from the link. Following that it updates internal data structures in the sender session context resulting in a native durable subscriber ACK or UM native transactional queue reader commit getting queued. When the UM server has completed processing the request, the delivery is accepted and settled.</div><div id="wwID0EVLSQ" class="Body">The following table illustrates how this is mapped to an unsuccessful Universal Messaging durable topic ack / transactional queue reader commit, which is disposed with a rejected state:</div><div class="ww_skin_page_overflow"><table class="rules1" cellspacing="0" summary=""><tr><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EHNSQ" class="Table_Cell_Head">Remote Disposition State</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0ENNSQ" class="Table_Cell_Head">Delivery Settled</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0ETNSQ" class="Table_Cell_Head">Receiver Settle Mode</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0EZNSQ" class="Table_Cell_Head">AMQP Errors</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: NaN%"><div id="wwID0E6NSQ" class="Table_Cell_Head">UM 10.15</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ENOSQ" class="Table_Cell">transactional</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ETOSQ" class="Table_Cell">N/A</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EZOSQ" class="Table_Cell">N/A</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E6OSQ" class="Table_Cell">amqp:internal-error (fatal)</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div class="ww_skin_page_overflow"><div id="wwID0EFPSQ" class="Table_Cell"><img class="Default" src="../num-webhelp/images/green_tick_icon.png" width="100%" style="display: inline; float: none; left: 0pt; max-height: 16px; max-width: 16px; top: 0pt" alt="(tick)" /></div></div></td></tr></table></div><div id="wwID0EYPSQ" class="Body">Description: As discussed in the accepted state mappings, a transactional AMQP consumer with these settings is mapped to a topic durable consumer or a queue transactional reader commit getting queued. When the UM server has completed processing the request, and an error has occurred, the delivery is rejected and settled as follows:</div><div id="wwID0E4PSQ" class="Body">amqp:internal-error: An unexpected UM internal error has occurred. This is a fatal error so the link is closed.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright Â© 2013-2022&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>