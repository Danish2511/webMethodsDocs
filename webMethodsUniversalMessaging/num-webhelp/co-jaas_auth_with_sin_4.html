<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>SIN Authentication Templates for JAAS</title><link rel="Prev" href="co-jaas_auth_with_sin_3.html" title="Previous" /><link rel="Next" href="to-jaas_auth_with_headers.html" title="Next" /><link rel="StyleSheet" href="css/_universal_messaging_docset_reverb_diba2.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/_universal_messaging_docset_reverb_diba2_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/num-webhelp/co-jaas_auth_with_sin_4.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pCPNkEouSofFsN4BQ8wryAA" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/num-webhelp/co-jaas_auth_with_sin_4.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>Universal Messaging</span>&nbsp;10.15 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../num-webhelp/to-title_concepts.html#wwconnect_header">Concepts</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../num-webhelp/to-header_security.html#wwconnect_header">Security</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../num-webhelp/to-header_authentication.html#wwconnect_header">Authentication</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../num-webhelp/co-jaas_auth_with_sin.html#wwconnect_header">Server JAAS Authentication with Software AG Security Infrastructure</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">SIN Authentication Templates for JAAS</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0EEKOO" class="Heading_4">SIN Authentication Templates for JAAS</div><div id="wwID0ENKOO" class="Body">Universal Messaging installation delivers a JAAS configuration file jaas.conf that comes with a pre-configured <span class="codeph">UM-Default</span> JAAS context and templates for several other authentication scenarios. The <span class="codeph">UM-Default</span> is selected by default due to the setting of the property <span class="codeph">Nirvana.auth.server.jaaskey</span> in the Server_Common.conf file, as described above.</div><div id="wwID0E6KOO" class="Body"><span class="Bold">1. Internal user repository</span></div><div id="wwID0EJLOO" class="Body">The <span class="codeph">UM-Default</span> JAAS context sets up authentication using the internal user repository that is stored in <span class="codeph">users.txt</span>:</div><div id="wwID0EXLOO" class="Preformatted">/*<br /> * Authentication with SAG internal user repository - by default the user database file<br /> * is located under &lt;INSTALL_DIR&gt;/common/conf/users.txt in a standard Software AG<br /> * installation. Depending on how the product is started one may need to<br /> * reconfigure the path to the database file (using an absolute path)<br /> */<br />UM-Default {<br />  com.softwareag.security.jaas.login.internal.InternalLoginModule sufficient<br />        template_section=INTERNAL<br />        internalRepository="../../../../common/conf/users.txt";<br />};<br /></div><div id="wwID0E4LOO" class="Body">The file users.txt is the internal user repository to be used for authentication when clients attach to the Universal Messaging server. It is located in <span class="filepath_002c_varname">&lt;InstallDir&gt;</span><span class="filepath">/common/conf</span>. If you have multiple Universal Messaging servers, you can use the same users.txt file to unify client authentication for all of the servers.</div><div id="wwID0ENMOO" class="Body">You might wish to vary the client authentication depending on the Universal Messaging server being used. For example, you might want to define username USER1 with password PASSWORD1 on the first server, but on the second server you want to define the same username USER1 with a different password PASSWORD2. To do this, you will need two users.txt files, one for each server, and change the pathname <span class="codeph">"../../../../common/conf/"</span> in each server's jaas.conf file to the path where the server-specific users.txt file is located. You can also provide custom names instead of the default users.txt.</div><div id="wwID0EXMOO" class="Body">To update the username/password definitions in each users.txt file as required, use the <span class="codeph">internaluserrepo.bat</span> or <span class="codeph">internaluserrepo.sh</span> script in <span class="filepath_002c_varname">&lt;InstallDir&gt;</span><span class="filepath">/common/bin</span>. For example, to add a user with password "mypwd1" and username "myuser1", run this command on the command line:</div><div id="wwID0EPNOO" class="Preformatted">internaluserrepo.bat -f &lt;path_to_users.txt&gt; -c -p mypwd1 myuser1</div><div id="wwID0EVNOO" class="Body">To get instructions on how to create and delete usernames/passwords, as well as how to display a list of existing usernames, run the script with the "-h" option:</div><div id="wwID0E1NOO" class="Preformatted">internaluserrepo.bat -h</div><div id="wwID0EAOOO" class="Body"><span class="Bold">2. LDAP Lookup</span></div><div id="wwID0EKOOO" class="Body">The LDAP look up method involves logging on to the LDAP server either anonymously (if allowed) or by using a predefined principal, and performing a lookup for a user entry matching a certain attribute. Finally the SIN-specific LDAP login module will attempt to bind with the retrieved user's distinguished name and the supplied password. The following template configuration is provided where you should fill in the required properties:</div><div id="wwID0EPOOO" class="Preformatted"><br />/*<br /> * Authentication with an LDAP server by looking up users based on an attribute.<br /> * The login module will use the configured principal (parameter "prin") to bind<br /> * and perform a lookup.<br /> * The principal can be omitted if the LDAP server is configured to allow <br /> * anonymous bind and lookup.<br /> * Afterwards the login module will search for an entry under <br /> * the specified root DN with the attribute<br /> * configured through the "uidprop" matching the supplied username.<br /> * The "uidprop" parameter can be omitted, its default value is "cn".<br /> */<br />UM-LDAP-Lookup {<br />    com.softwareag.security.sin.is.ldap.lm.LDAPLoginModule sufficient<br />       url="&lt;LDAP URL&gt;"<br />       prin="&lt;principal complete DN&gt;"<br />       cred="&lt;principal password&gt;"<br />       userrootdn="&lt;root DN for searching users&gt;"<br />       uidprop="&lt;user ID property name&gt;";<br />};<br /></div><div id="wwID0EVOOO" class="Body"><span class="Bold">3. Active Directory direct bind</span></div><div id="wwID0E6OOO" class="Body">With active directory the SIN-specific LDAP login module offers the possibility for a direct bind with the supplied username and password, using the following configuration template where the user should fill in the active directory URL.</div><div id="wwID0EEPOO" class="Preformatted"><br />/*<br /> * Authentication with an Active Directory server by binding directly with <br /> * the supplied credentials.<br /> * Active Directory allows for a direct bind with a principal in the <br /> * format "domainPrefix\user".<br /> */<br />UM-AD-DirectBind {<br />  com.softwareag.security.sin.is.ldap.lm.LDAPLoginModule sufficient<br />       url="&lt;LDAP URL&gt;"<br />       noPrinIsAnonymous=false<br />       useFQDNForAuth=true;<br />};<br /></div><div id="wwID0EKPOO" class="Body"><span class="Bold">4. LDAP direct bind</span></div><div id="wwID0EUPOO" class="Body">It is also possible to attempt a direct bind against an LDAP server where the bind DN will be constructed by the SIN-specific JAAS login module using a prefix and a suffix, with the supplied username in-between. In this case the user is required to configure the URL of the LDAP server, as well as the prefix and the suffix to be used for the construction of the bind DN:</div><div id="wwID0EZPOO" class="Preformatted">/*<br /> * Authentication with an LDAP server by building a complete DN and binding directly.<br /> * The bind DN will be composed by prepending the supplied username with the <br /> * value of the "dnprefix" parameter and appending the value <br /> * of the "dnsuffix" parameter.<br /> */<br />UM-LDAP-DirectBind-Affixes {<br />    com.softwareag.security.sin.is.ldap.lm.LDAPLoginModule sufficient<br />       url="&lt;LDAP URL&gt;"<br />       noPrinIsAnonymous=false<br />       useaf=true<br />       dnprefix="&lt;Bind DN prefix&gt;"<br />       dnsuffix="&lt;Bind DN suffix&gt;";<br />};<br /></div><div id="wwID0E6POO" class="Body"><span class="Bold">5. Combination of any of the above</span></div><div id="wwID0EJQOO" class="Body">JAAS is extremely flexible and allows for using a combination of different back-ends, such as, several LDAP servers and/or repositories. For example it is possible to configure LDAP authentication with an internal user repository as a fallback mechanism:</div><div id="wwID0EOQOO" class="Preformatted">/*<br /> * Authentication with an LDAP server through a user lookup, with an <br /> * internal user repository as a fallback mechanism. <br /> * This configuration would first try to log in against the LDAP if that fails<br /> * would try authentication against the internal user repository. <br /> * Similarly one could use several LDAP servers or <br /> * combine more authentication backends.<br /> */<br />UM-Combined {<br />    com.softwareag.security.sin.is.ldap.lm.LDAPLoginModule sufficient<br />       url="&lt;LDAP URL&gt;"<br />       prin="&lt;principal complete DN&gt;"<br />       cred="&lt;principal password&gt;"<br />       userrootdn="&lt;root DN for searching users&gt;"<br />       uidprop="&lt;user ID property name&gt;";<br /><br /><br />    com.softwareag.security.jaas.login.internal.InternalLoginModule sufficient<br />        template_section=INTERNAL<br />        internalRepository="../../../../common/conf/users.txt";<br />};<br /></div><div id="wwID0EUQOO" class="Body"><span class="Bold">6. Combining X.509 client certificate with a username/password authentication</span></div><div id="wwID0E5QOO" class="Body">Authentication is configured globally for a Universal Messaging realm server, which means that if a user connects over an SSL/TLS interface that requires a X.509 client certificate, the user would still have to undergo an authentication check in order to establish a viable session. This is where the SIN X.509 certificate login module comes in handy, as it would allow users to authenticate with a presented client certificate over an SSL/TLS interface, or alternatively, present a username and a password credentials if connecting over an interface that does not require a client certificate. This can be achieved using the following template of the X.509 client certificate login module in combination with either an internal user repository, or an LDAP login module (or both).</div><div id="wwID0EDROO" class="Preformatted">/*<br /> * Authentication with a X.509 certificate chain, and a username/password, as a<br /> * fallback mechanism. This configuration would first try to log in using an X.509<br /> * certificate chain (if present), and if that fails, it would attempt<br /> * authentication against an internal user repository. A certificate chain would<br /> * only be present if the user connected through a TLS/SSL enabled interface that<br /> * required a client certificate, and this login context will give precedence to<br /> * the X.509 certificate chain credential.<br /> * <br /> * The same scenario can be implemented with an LDAP server by replacing the<br /> * internal user repository login module with an LDAP login module configuration.<br /> * <br /> * This context would allow that in a server that has authentication enforced<br /> * globally, users can connect with a username and a password through insecure<br /> * interfaces (or TLS/SSL enabled interfaces using server certificates only), and<br /> * using an X.509 certificate over an TLS/SSL interface that requires a client<br /> * certificate. <br />*/<br />UM-X509-UsernamePassword {<br />    com.softwareag.security.jaas.login.modules.X509CertificateLoginModule sufficient<br />        truststore_url="&lt;truststore file URL&gt;"<br />        truststore_password="&lt;truststore password&gt;"<br />        create_user_principal=true;<br /><br /><br />  com.softwareag.security.jaas.login.internal.InternalLoginModule sufficient<br />        template_section=INTERNAL<br />        internalRepository="../../../../common/conf/users.txt";<br />};<br /></div><div id="wwID0EJROO" class="Body">To use any custom JAAS context, or any of the predefined templates, you would need to modify the value of the <span class="codeph">Nirvana.auth.server.jaaskey</span> system property inside the Server_Common.conf file in the server's <span class="codeph">bin</span> directory, pointing it to the context to be used. At the moment the context name is globally defined for the entire server.</div><div id="wwID0EXROO" class="Note"><span class="Bold">Note:<br /></span>Since the jaas.conf file is edited manually and requires certain knowledge of the default JAAS configuration file format, there is always the possibility of a syntactic error. Such errors during parsing of the file will be printed to the UMRealmService.log file which resides under the server's <span class="codeph">bin</span> directory.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright Â© 2013-2022&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>