<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Event Filtering using Selectors</title><link rel="Prev" href="to-nfilteringguide.html" title="Previous" /><link rel="Next" href="co-eventfilter_subjects_and_principals.html" title="Next" /><link rel="StyleSheet" href="css/_universal_messaging_docset_reverb_diba2.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/_universal_messaging_docset_reverb_diba2_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/num-webhelp/to-nadvancedfiltering.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pI2nb1ZE4a_002fXLtnrnubcJQg" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/num-webhelp/to-nadvancedfiltering.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>Universal Messaging</span>&nbsp;10.15 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../num-webhelp/to-title_concepts.html#wwconnect_header">Concepts</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../num-webhelp/to-header_common_features.html#wwconnect_header">Commonly Used Features</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../num-webhelp/co-events_concept.html#wwconnect_header">Events</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">Event Filtering using Selectors</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0E6L6Q" class="Heading_3">Event Filtering using Selectors</div><div id="wwID0EHM6Q" class="Body">Universal Messaging supports <span class="term">standard selector based filtering</span> and some advanced filtering concepts which will be described here .</div><div id="wwID0EYM6Q" class="Section_Title">Content Sensitive Filtering</div><div id="wwID0E4M6Q" class="Body">Each Universal Messaging event can contain an event dictionary and a tag, as well as a byte array of data. Standard filtering, as defined by JMS, allows dictionary entries to be evaluated based on the value of the dictionary keys prior to delivering the data to the consumer.</div><div id="wwID0ECN6Q" class="Body">Universal Messaging also supports a more advanced form of filtering based on the content of the event data (byte array) itself as well as time and location sensitive filtering. Universal Messaging also supports filtering based on arrays and dictionaries contained within event dictionaries. There is no limit to the dept of nested properties that can be filtered.</div><div id="wwID0EPN6Q" class="Section_Title">Filtering based on nested arrays and dictionaries</div><div id="wwID0EUN6Q" class="Body">An event dictionary can contain primitive types as well as dictionaries. They can also contain arrays of primitive types and arrays of dictionaries. Universal Messaging supports the ability to filter based on these nested arrays and dictionaries.</div><div id="wwID0EZN6Q" class="Body">If an nEventProperties object contains a key called NAMES which stores a String[] then it is possible to specify a filter that will only deliver events that match based on values within the array.</div><div id="wwID0ETO6Q" class="Preformatted_1"><br />NAMES[] = 'myname'<br /></div><div id="wwID0ECO6Q-3" class="List_1_Continued">- Returns events where any element in the NAMES array = 'myname'</div><div id="wwID0ELP6Q" class="Preformatted_1"><br />NAMES[1] = 'myname'<br /></div><div id="wwID0E1O6Q-3" class="List_1_Continued">- Returns events where the second element in the array = 'myname'</div><div id="wwID0ETP6Q" class="Body">Similarly, if the array was an nEventProperties[] it would be possible to filter based on the values within the individual nEventProperties objects contained within the array.</div><div id="wwID0EYP6Q" class="Body">For example if the event's nEventProperties contains a key called CONTACTS which stores an nEventProperties[] then the following selectors will be available.</div><div id="wwID0ESQ6Q" class="Preformatted_1"><br />CONTACTS[].name = 'aname'<br /></div><div id="wwID0EBQ6Q-3" class="List_1_Continued">- Return events where the CONTACTS array contains an nEventProperties which contains a key called name with the value 'aname'</div><div id="wwID0EKR6Q" class="Preformatted_1"><br />CONTACTS[1].name = 'aname'<br /></div><div id="wwID0EZQ6Q-3" class="List_1_Continued">- Return events where the second element in the CONTACTS array of nEventProperties contains a key called name with the value 'aname'</div><div id="wwID0ECS6Q" class="Preformatted_1"><br />CONTACTS[].NAMES[] = 'myname'<br /></div><div id="wwID0ERR6Q-3" class="List_1_Continued">- Return events where the CONTACTS array contains a NAMES arrays with a value 'myname' somewhere in the NAMES array.</div><div id="wwID0ESS6Q" class="Section_Title">EventData Byte[] Filtering</div><div id="wwID0EXS6Q" class="Body">Universal Messaging's filtering syntax supports a keyword called 'EVENTDATA' that corresponds to the actual byte array of data within the Universal Messaging event. There are a number of operations that can be performed on the event data using this keyword.</div><div id="wwID0E3S6Q" class="Body">This enables a reduction in the amount of data you wish to send to clients, since rather than querying pre-determined dictionary values, you can now query the actual data portion of the event itself without having to provide dictionary entries. If you have a message structure and part of this structure includes the length of each value within the structure, then you can refer to each portion of data. Alternatively if you know the location of data within your byte array, these can be used for filtering quite easily.</div><div id="wwID0ECT6Q" class="Body">Below is a list of the available operations that can be performed on the EVENTDATA.</div><div id="wwID0ENU6Q" class="Preformatted_1"><br />EVENTDATA.LENGTH()<br /></div><div id="wwID0E3T6Q-3" class="List_1_Continued">- Returns the length of the byte[] of the data in the event.</div><div id="wwID0EXV6Q" class="Preformatted_1"><br />EVENTDATA.AS-BYTE(offset)<br /></div><div id="wwID0EGV6Q-3" class="List_1_Continued">- Returns the byte value found within the data at the specified offset.</div><div id="wwID0EBX6Q" class="Preformatted_1"><br />EVENTDATA.AS-SHORT(offset)<br /></div><div id="wwID0EQW6Q-3" class="List_1_Continued">- Returns a short value found within the data at the specified offset. Length of the data is 2 bytes.</div><div id="wwID0EMY6Q" class="Preformatted_1"><br />EVENTDATA.AS-INT(offset)<br /></div><div id="wwID0E1X6Q-3" class="List_1_Continued">- Returns an int value found within the data at the specified offset. Length of the data is 4 bytes.</div><div id="wwID0EWZ6Q" class="Preformatted_1"><br />EVENTDATA.AS-LONG(offset)<br /></div><div id="wwID0EFZ6Q-3" class="List_1_Continued">- Returns a long value found within the data at the specified offset. Length of the data is 8 bytes.</div><div id="wwID0EA26Q" class="Preformatted_1"><br />EVENTDATA.AS-FLOAT(offset)<br /></div><div id="wwID0EP16Q-3" class="List_1_Continued">- Returns a float value found within the data at the specified offset. Length of the data is 4 bytes.</div><div id="wwID0EK36Q" class="Preformatted_1"><br />EVENTDATA.AS-DOUBLE(offset)<br /></div><div id="wwID0EZ26Q-3" class="List_1_Continued">- Returns a double value found within the data at the specified offset. Length of the data is 8 bytes.</div><div id="wwID0EU46Q" class="Preformatted_1"><br />EVENTDATA.AS-STRING(offset, len)<br /></div><div id="wwID0ED46Q-3" class="List_1_Continued">- Returns a String value found within the data at the specified offset for the length specified.</div><div id="wwID0E556Q" class="Preformatted_1"><br />EVENTDATA.TAG()<br /></div><div id="wwID0EN56Q-3" class="List_1_Continued">- Returns the String TAG of the event if it has one.</div><div id="wwID0EH66Q" class="Body">For example, we could provide a filter string of the following form if we know that at position 0, the first 2 bytes are a string that represents a value you wish to filter on:</div><div id="wwID0EN66Q" class="Preformatted"><br />EVENTDATA.AS-STRING(0, 2) = 'UK'<br /></div><div id="wwID0ET66Q" class="Body">You can use the LIKE operator in the filter expression, for example:</div><div id="wwID0EZ66Q" class="Preformatted"><br />EVENTDATA.AS-STRING(0, 2) LIKE 'U_'<br /></div><div id="wwID0EIAAR" class="Section_Title">Time Sensitive Filtering</div><div id="wwID0ENAAR" class="Body">Universal Messaging's filtering syntax also supports a function called 'NOW()' that is evaluated at the server as the current time in milliseconds using the standard Java time epoch. This function enables you to filter events from the server using a time sensitive approach. For example, if your data contained a dictionary key element called 'DATE_SOLD' that contained a millisecond value representing the data when an item was sold, one could provide a filter string on a subscription in the form of:</div><div id="wwID0ESAAR" class="Preformatted"><br />DATA_SOLD &lt; (NOW() - 86400000)<br /></div><div id="wwID0EYAAR" class="Body">Which would deliver events corresponding to items sold in the last 24 hours. This is a powerful addition to the filtering engine within Universal Messaging.</div><div id="wwID0EFBAR" class="Section_Title">Location Sensitive Filtering</div><div id="wwID0EKBAR" class="Body">Universal Messaging's filtering engine supports a keyword called DISTANCE. This keyword is used to provide geographically sensitive filtering. This allows the calculation of the distance between a geographical reference point defined by you (a point on the earth's surface as defined by the latitude and longitude values) and the geographical location of the events contained in the event stream that you are filtering. The filter will find all events whose distance from the geographical reference point matches the given comparison criterion.</div><div id="wwID0EQBAR" class="Body">For example, if you were designing a system that tracked the location of a tornado, as the tornado moved position, the latitude and longitude would correspond to the geographical location on the earth's surface. As the position of a tornado changed, an event would be published containing the new latitude and longitude values as keys within the dictionary ('latitude' and 'longitude' respectively). Using this premise, you could provide a filter in the form of:</div><div id="wwID0E2BAR" class="Preformatted"><br />DISTANCE(Latitude, Longitude, Units)  Operator  Value<br /></div><div id="wwID0ECCAR" class="Body">where :</div><div id="wwID0ELCAR" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Latitude : the floating point value representing the latitude of your geographical reference point</div><div id="wwID0E3CAR" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Longitude : the floating point value representing the longitude of your geographical reference point</div><div id="wwID0ENDAR" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Units : an optional string indicating the unit of measurement to be used in the calculation</div><div id="wwID0EBEAR" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>K: Kilometers &lt; Default &gt;</div><div id="wwID0ESEAR" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>M : Miles</div><div id="wwID0EDFAR" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>N : Nautical Miles</div><div id="wwID0EWFAR" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Operator: a numerical comparison operator, such as &lt;, &gt;, =</div><div id="wwID0EIGAR" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Value: The required distance of the event's location from the geographical reference point.</div><div id="wwID0E2GAR" class="Body">For example :</div><div id="wwID0EAHAR" class="Preformatted"><br />DISTANCE ( 51.50, 0.16, M ) &lt; 100<br /></div><div id="wwID0EGHAR" class="Body">This will deliver events that correspond to tornadoes that are less than 100 miles away from the geographical reference point given by the latitude and longitude values (51.50, 0.16).</div><div id="wwID0EMHAR" class="Body">The DISTANCE keyword provides a valuable and powerful extension to Universal Messaging's filtering capabilities, if you require information that is sensitive to geographical locations.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright Â© 2013-2022&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>