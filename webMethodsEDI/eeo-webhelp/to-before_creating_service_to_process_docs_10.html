<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Logic for the Service to Process the Document Iteratively</title><link rel="Prev" href="to-before_creating_service_to_process_docs_9.html" title="Previous" /><link rel="Next" href="to-before_creating_service_to_process_docs_11.html" title="Next" /><link rel="StyleSheet" href="css/_edi_module_integrated_webhelp.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/_edi_module_integrated_webhelp_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/eeo-webhelp/to-before_creating_service_to_process_docs_10.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pziHxDVcGSNAY5eW3Tob_002bAg" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/eeo-webhelp/to-before_creating_service_to_process_docs_10.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>Module for EDI</span>&nbsp;9.12 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../eeo-webhelp/_edi_module_integrated_webhelp.1.055.html#wwconnect_header">Installing and Using EDI Module</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../eeo-webhelp/to-before_creating_service_to_process_docs.html#wwconnect_header">Before Creating the Service to Process EDI Documents</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../eeo-webhelp/to-before_creating_service_to_process_docs_4.html#wwconnect_header">Logic to Include in the Service to Process EDI Documents</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../eeo-webhelp/to-before_creating_service_to_process_docs_8.html#wwconnect_header">Processing the Document Iteratively, Segment by Segment</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">Logic for the Service to Process the Document Iteratively</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0E2EXQ" class="Heading_4">Logic for the Service to Process the Document Iteratively</div><div id="wwID0EEFXQ" class="Body">   This section describes the sample code for processing an inbound EDI document iteratively.    The steps for processing show how to map information from the line item segments of an ANSI X12 810 document into an internal-format document, and then send the document to an internal application, for example, a back-end system. For more information about all of the built-in services that the sample uses, see <span class="ph"> </span><span class="ph_002c_Citation">webMethods Module for EDI Built-In Services Reference</span>.</div><div class="ww_skin_page_overflow"><div id="wwID0E3HXQ" class="Figure"><img class="Default" src="../eeo-webhelp/images/EDI_ProcDocSegBySecPseudoCode.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 300px; max-width: 435px; top: 0pt" alt="" /></div></div><div class="ww_skin_page_overflow"><table class="rules1" cellspacing="0" summary=""><tr><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: 18.4%"><div id="wwID0EQJXQ" class="Table_Cell_Head">Flow operation</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: 81.6%"><div id="wwID0EWJXQ" class="Table_Cell_Head">Description</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EFKXQ" class="Table_Cell">1</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ELKXQ" class="Table_Cell">  Repeatedly invoke the <span class="apiname">wm.b2b.edi:convertToValues</span> service until your service has processed the entire EDI document. When you pass the <span class="varname">iterator</span> input parameter as true to the <span class="apiname">convertToValues</span> service, the output contains the object <span class="varname">ediObject,</span>, which is used to keep track of the input data segments. When the entire EDI document has been processed, <span class="varname">EDIObject</span> becomes null.</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ENMXQ" class="Table_Cell">2</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ETMXQ" class="Table_Cell">In the outer REPEAT loop, invoke the <span class="apiname">convertToValues</span> service to:</div><div id="wwID0ECNXQ" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>     Convert a segment or group of segments to an IData object</div><div id="wwID0E4OXQ" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Validate the EDI structure</div><div id="wwID0EPPXQ" class="Table_Cell">The inputs to the <span class="apiname">convertToValues</span> service include the String or InputStream that represents the EDI document and the customized flat file schema for the EDI document. The <span class="apiname">convertToValues</span> service uses the flat file schema to determine how many segments to read. It returns the object <span class="varname">ediObject</span>, which keeps track of its location in the EDI document. This object is input to subsequent invocations of the <span class="apiname">convertToValues</span> service to ensure the service continues where it left off at the last invocation.</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EPQXQ" class="Table_Cell">3</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EVQXQ" class="Table_Cell">Add BRANCH flow operations for each type of segment you expect the <span class="apiname">convertToValues</span> service to return.</div><div id="wwID0EARXQ" class="Table_Cell">For example, the first BRANCH under the call to the <span class="apiname">convertToValues</span> service checks for an <span class="varname">ISA</span> element in the returned IData object, <span class="varname">EDIValues</span>. If <span class="varname">EDIValues/ISA</span> exists and is not null, the flow service executes the logic under the <span class="codeph">BRANCH on â€˜EDIVAlues/ISA'</span> flow operation.</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EESXQ" class="Table_Cell">4</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EKSXQ" class="Table_Cell">Prepare to invoke the <span class="apiname">convertToValues</span> service against the unparsed sections of the document. An unparsed section is a section for which the EDI flat file schema for the EDI document did not have flat file structure and for which you created a separate flat file schema.</div><div id="wwID0EZSXQ" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Save information about where you are in processing the EDI document. The MAP flow operation saves the values of the <span class="varname">ediObject</span> and <span class="varname">EDIFFSchema</span> that the <span class="apiname">convertToValues</span> service in the outer REPEAT loop is using.</div><div id="wwID0EZTXQ" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Map the fully-qualified name of the flat file schema you created for the repeating section of the document into the <span class="varname">EDIFFSchema</span> parameter. Make sure the value of <span class="varname">ediObject</span> is null.</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E2UXQ" class="Table_Cell">5</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EBVXQ" class="Table_Cell">Repeatedly invoke the <span class="apiname">convertToValues</span> service in this inner REPEAT loop to process an unparsed section of the document.</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ESVXQ" class="Table_Cell">6</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EYVXQ" class="Table_Cell"> Invoke the <span class="apiname">wm.b2b.edi.util:EDIconcat</span> service to prepare the unparsed section for the call to the <span class="apiname">convertToValues</span> service.</div><div id="wwID0EWWXQ" class="Table_Cell">The <span class="apiname">EDIconcat</span> service automatically gets its input from either the <span class="varname">unDefData</span> or <span class="varname">_RID_</span> elements that the first pass of the <span class="apiname">convertToValues</span> service left in the pipeline for the unparsed sections. You can use the <span class="apiname">EDIconcat</span> service to add a header, a trailer, or both a header and trailer to the unparsed data, if needed.</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E2XXQ" class="Table_Cell">7</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EBYXQ" class="Table_Cell">In the inner REPEAT loop, invoke the <span class="apiname">convertToValues</span> service to:</div><div id="wwID0EQYXQ" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>  Convert the unparsed section to an IData object</div><div id="wwID0ESZXQ" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Validate the EDI structure</div><div id="wwID0EE1XQ" class="Table_Cell">Pass the output from the <span class="apiname">EDIconcat</span> service (<span class="varname">output</span> parameter) to the <span class="varname">edidata</span> input parameter of the <span class="apiname">convertToValues</span> service. In a previous flow operation, you set the value of the <span class="varname">EDIFFSchema</span> input parameter to the fully-qualified name of the flat file schema to use for this unparsed section of the EDI document.</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EJ2XQ" class="Table_Cell">8</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EP2XQ" class="Table_Cell">Map data from the unparsed section into the internal-format document. Depending on the complexity of your mapping requirements, you might need to add more logic than a MAP flow operation, or create a separate service to perform the mapping.</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E12XQ" class="Table_Cell">9</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EA3XQ" class="Table_Cell">Invoke the <span class="apiname">convertToString</span> service to convert the internal-format document from an IData object to String format.</div><div id="wwID0EL3XQ" class="Table_Cell">The inputs to the <span class="apiname">convertToString</span> service include the IData object that contains the data for your internal-format document and the flat file schema for the internal-format document. The <span class="apiname">convertToString</span> service uses the flat file schema to determine how to form the internal-format document. Alternatively, the <span class="apiname">convertToString</span> service can accept an IS document type to define the structure of the internal-format document.</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EG4XQ" class="Table_Cell">10</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EM4XQ" class="Table_Cell">Add your own logic or invoke a service that you create to send the internal-format document to your internal application, for example, a back-end system.</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EX4XQ" class="Table_Cell">11</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E44XQ" class="Table_Cell">Restore the values of the <span class="varname">ediObject</span> and <span class="varname">EDIFFSchema</span> parameters, which you saved in a previous flow operation, in preparation for invoking the <span class="apiname">convertToValues</span> service in the outer REPEAT loop.</div></td></tr></table></div><div id="wwID0EX5XQ" class="Note"><span class="Bold">Note:</span> If you want to perform the interchange (or transmission) envelope validation and the compliance check, you need to add logic to your service to do so. For more information, see 
    <a href="../eeo-webhelp/to-before_creating_service_to_process_docs_7.html#wwID0EMIWQ"
   
     title="Performing Envelope Validation and Compliance Checks"
    ><span class="heading-page">Performing Envelope Validation and
										Compliance Checks</span></a>.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright Â© 2000-2023&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>