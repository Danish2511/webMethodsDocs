<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Example: Custom Assertions</title><link rel="Prev" href="ta-policy_assertion_delete.html" title="Previous" /><link rel="Next" href="gtw_configure_kerberos.html" title="Next" /><link rel="StyleSheet" href="css/_api_gtw_integrated_webhelp.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/_api_gtw_integrated_webhelp_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/yai-webhelp/co-ag_config_assertion_samples.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pN43r00ZBQD3sXypkyzn2RSg" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/yai-webhelp/co-ag_config_assertion_samples.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>API Gateway</span>&nbsp;10.15 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/_api_gtw_integrated_webhelp.1.032.html#wwconnect_header">Administering API Gateway</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/_api_gtw_integrated_webhelp.1.303.html#wwconnect_header">Security Configuration</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/gtw_policy_assertions.html#wwconnect_header">Custom Assertions</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">Example: Custom Assertions</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0EFLOU" class="Heading_3">Example: Custom Assertions</div><div id="wwID0ENLOU" class="Body"><span class="ph">API Gateway</span>, by default, uses the asymmetric binding assertion with X.509v3 token for implementing SOAP message protection. If you would like to enforce any authentication (other than the predefined authentications shipped with <span class="ph">API Gateway</span>), include additional WSS custom assertions, sign and encrypt SOAP messages, and define custom properties, such as the algorithms and layout of security header, you can create custom assertions that would construct the custom policy file to suit your specific security requirements.</div><div id="wwID0E1LOU" class="Body">Following is a policy file that <span class="ph">API Gateway</span> generates when a WSS username token is enforced by the Inbound Authentication Message policy for an API.</div><div id="wwID0EEMOU" class="Preformatted">&lt;wsp:Policy wsu:Id="9dbda2fb-9cef-4ff9-bc70-115c942a3b76" <br />              xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy" <br />              xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/<br />                         oasis-200401-wss-wssecurity-utility-1.0.xsd"&gt;<br />		&lt;wsp:ExactlyOne&gt;<br />			&lt;wsp:All&gt;<br />(L01) &lt;sp:AsymmetricBinding xmlns:sp=<br />                  "http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" <br />              xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy"&gt;<br />   &lt;wsp:Policy&gt;<br />     &lt;sp:InitiatorToken&gt;<br />       &lt;wsp:Policy&gt;<br />         &lt;sp:X509Token sp:IncludeToken<br />                "http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702<br />                                                     /IncludeToken/Never"&gt;<br />          &lt;wsp:Policy&gt;<br />            &lt;sp:WssX509V3Token10 /&gt;<br />          &lt;/wsp:Policy&gt;<br />         &lt;/sp:X509Token&gt;<br />       &lt;/wsp:Policy&gt;<br />     &lt;/sp:InitiatorToken&gt;<br />     &lt;sp:RecipientToken&gt;<br /> 			   &lt;wsp:Policy&gt;<br /> 			     &lt;sp:X509Token sp:IncludeToken=<br />                "http://docs.oasis-open.org/ws-sx/ws-securitypolicy<br />                                              /200702/IncludeToken/Never"&gt;<br /> 					    &lt;wsp:Policy&gt;<br />            &lt;sp:WssX509V3Token10 /&gt;<br />          &lt;/wsp:Policy&gt;<br />         &lt;/sp:X509Token&gt;<br />       &lt;/wsp:Policy&gt;<br />     &lt;/sp:RecipientToken&gt;<br />     &lt;sp:AlgorithmSuite&gt;<br />       &lt;wsp:Policy&gt;<br />         &lt;sp:TripleDesRsa15 /&gt;<br />       &lt;/wsp:Policy&gt;<br />     &lt;/sp:AlgorithmSuite&gt;<br />     &lt;sp:Layout&gt;<br /> 			   &lt;wsp:Policy&gt;<br /> 				    &lt;sp:Strict /&gt;<br /> 			   &lt;/wsp:Policy&gt;<br />     &lt;/sp:Layout&gt;<br /> 	  &lt;sp:ProtectTokens/&gt; <br />   &lt;/wsp:Policy&gt;<br /> &lt;/sp:AsymmetricBinding&gt;<br /> &lt;sp:SupportingTokens xmlns:sp=<br />          "http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702"&gt;<br />			&lt;wsp:Policy&gt;<br />						&lt;sp:UsernameToken sp:IncludeToken=<br />          "http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/<br />                                     IncludeToken/AlwaysToRecipient"/&gt;<br />			&lt;/wsp:Policy&gt;<br />	&lt;/sp:SupportingTokens&gt;<br />			&lt;/wsp:All&gt;<br />		&lt;/wsp:ExactlyOne&gt;<br />	&lt;/wsp:Policy&gt;</div><div id="wwID0EKMOU" class="Body">You might have a requirement to change the policy assertion that is available by default in <span class="ph">API Gateway</span>. For example, you might want to generate the above security policy using a symmetric binding instead of the default asymmetric binding, and modify the username token that is defined by default as a supporting token to a signed supporting token. You could then create custom policy assertions to achieve these specific requirements.</div><div id="wwID0EUMOU" class="Important"><span class="Bold">Important:<br /></span>When adding a custom policy assertion, make sure that both the syntax and the semantics of the assertion are valid and in compliance with the Web Services Security Policy specification.</div><div id="wwID0ELNOU" class="Body"><span class="inlinetitle">Symmetric Binding Assertion</span></div><div id="wwID0EVNOU" class="Body">You might want to use a symmetric binding (instead of the default asymmetric binding) when only <span class="ph">API Gateway</span> possess the X.509v3 token for authentication. You might also want to sign and encrypt the SOAP messages, modify the encryption algorithm, and include timestamp on the SOAP messages. You would then create a custom binding assertion with the specific property lines:</div><div id="wwID0E6NOU" class="Preformatted">&lt;sp:SymmetricBinding <br />     xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" <br />     xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy"&gt;<br />	&lt;wsp:Policy&gt;<br />		&lt;sp:ProtectionToken&gt;<br />			&lt;wsp:Policy&gt;<br />				&lt;sp:X509Token sp:IncludeToken=<br />               "http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/<br />                                          IncludeToken/AlwaysToRecipient"&gt;<br />					&lt;wsp:Policy&gt;<br />						&lt;sp:WssX509V3Token10/&gt;<br />						&lt;sp:WssX509PkiPathV1Token10/&gt;<br />					&lt;/wsp:Policy&gt;<br />				&lt;/sp:X509Token&gt;<br />			&lt;/wsp:Policy&gt;<br />		&lt;/sp:ProtectionToken&gt;<br />		&lt;sp:AlgorithmSuite&gt;<br />			&lt;wsp:Policy&gt;<br />				&lt;sp:TripleDesRsa15/&gt;<br />			&lt;/wsp:Policy&gt;<br />		&lt;/sp:AlgorithmSuite&gt;<br />		&lt;sp:Layout&gt;<br />			&lt;wsp:Policy&gt;<br />				&lt;sp:Strict/&gt;<br />			&lt;/wsp:Policy&gt;<br />		&lt;/sp:Layout&gt;<br />		&lt;sp:IncludeTimestamp/&gt;<br />		&lt;sp:ProtectTokens/&gt;<br />		&lt;sp:OnlySignEntireHeadersAndBody/&gt;<br />		&lt;sp:SignBeforeEncrypting/&gt;<br />	&lt;/wsp:Policy&gt;<br />&lt;/sp:SymmetricBinding&gt;</div><div id="wwID0EFOOU" class="Body">You could create custom assertions to include one or more of the following security requirements:</div><div id="wwID0EKOOU" class="Body"><span class="inlinetitle">Supporting Token Assertions</span></div><div id="wwID0EUOOU" class="Body">You might want to sign the supporting token for example, WSS username token, and use SignedSupportingTokens assertion. You might also want to specify that the signed username token must always be included in the messages sent to the recipient. You would then create a custom token assertion with the specific property lines:</div><div id="wwID0EZOOU" class="Preformatted">&lt;sp:SignedSupportingTokens xmlns:sp=<br />               "http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702"&gt;<br />  &lt;wsp:Policy&gt;<br />					&lt;sp:UsernameToken sp:IncludeToken=<br />               "http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/<br />                                          IncludeToken/AlwaysToRecipient"/&gt;<br />		&lt;/wsp:Policy&gt;<br />&lt;/sp:SignedSupportingTokens&gt;</div><div id="wwID0E6OOU" class="Body"><span class="inlinetitle">WSS Token Assertions</span></div><div id="wwID0EJPOU" class="Body">You might want to include WSS10 and WSS11 assertions to provide additional SOAP message security. You would then create two separate custom token assertions with the specific property lines:</div><div id="wwID0EOPOU" class="Body">Wss10 assertion:</div><div id="wwID0ETPOU" class="Preformatted">&lt;sp:Wss10 <br />     xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702"              <br />     xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy"&gt;<br />	&lt;wsp:Policy&gt;		<br />		&lt;sp:MustSupportRefIssuerSerial/&gt;<br />	&lt;/wsp:Policy&gt;<br />&lt;/sp:Wss10&gt;</div><div id="wwID0EZPOU" class="Body">Wss11 assertion:</div><div id="wwID0E5POU" class="Preformatted">&lt;sp:Wss11 <br />     xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" <br />     xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy"&gt;<br />	&lt;wsp:Policy&gt;		<br />		&lt;sp:MustSupportRefIssuerSerial/&gt;<br />		&lt;sp:MustSupportRefThumbprint/&gt;<br />		&lt;sp:RequireSignatureConfirmation/&gt;<br />	&lt;/wsp:Policy&gt;<br />&lt;/sp:Wss11&gt;</div><div id="wwID0EEQOU" class="Body">After you have defined these custom assertions in <span class="ph">API Gateway</span>, execution of a policy that is configured with all of these custom assertions in the Inbound Auth - Message policy, would construct the custom security policy file as follows:</div><div id="wwID0EOQOU" class="Preformatted">&lt;wsp:Policy wsu:Id="1e747a18-b55d-4e99-ac67-80a8eafd76b3" <br />     xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy" <br />     xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/<br />                 oasis-200401-wss-wssecurity-utility-1.0.xsd"&gt;<br />		&lt;wsp:ExactlyOne&gt;<br />			&lt;wsp:All&gt;<br />				&lt;sp:SymmetricBinding xmlns:sp=<br />               "http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702"&gt;<br />					&lt;wsp:Policy&gt;<br />						&lt;sp:ProtectionToken&gt;<br />							&lt;wsp:Policy&gt;<br />								&lt;sp:X509Token sp:IncludeToken=<br />               "http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/<br />                                          IncludeToken/AlwaysToRecipient"&gt;<br />									&lt;wsp:Policy&gt;<br />										&lt;sp:WssX509PkiPathV1Token10/&gt;<br />									&lt;/wsp:Policy&gt;<br />								&lt;/sp:X509Token&gt;<br />							&lt;/wsp:Policy&gt;<br />						&lt;/sp:ProtectionToken&gt;<br />						&lt;sp:AlgorithmSuite&gt;<br />							&lt;wsp:Policy&gt;<br />								&lt;sp:TripleDesRsa15/&gt;<br />							&lt;/wsp:Policy&gt;<br />						&lt;/sp:AlgorithmSuite&gt;<br />						&lt;sp:Layout&gt;<br />							&lt;wsp:Policy&gt;<br />								&lt;sp:Strict/&gt;<br />							&lt;/wsp:Policy&gt;<br />						&lt;/sp:Layout&gt;<br />						&lt;sp:OnlySignEntireHeadersAndBody/&gt;<br />					&lt;/wsp:Policy&gt;<br />				&lt;/sp:SymmetricBinding&gt;<br />				&lt;sp:SignedSupportingTokens xmlns:sp=<br />               "http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702"&gt;<br />					&lt;wsp:Policy&gt;<br />						&lt;sp:UsernameToken sp:IncludeToken=<br />               "http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/<br />                                          IncludeToken/AlwaysToRecipient"/&gt;<br />					&lt;/wsp:Policy&gt;<br />				&lt;/sp:SignedSupportingTokens&gt;<br />				&lt;sp:Wss11 xmlns:sp=<br />               "http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702"&gt;<br />					&lt;wsp:Policy&gt;<br />						&lt;sp:MustSupportRefIssuerSerial/&gt;<br />						&lt;sp:MustSupportRefThumbprint/&gt;<br />						&lt;sp:RequireSignatureConfirmation/&gt;<br />					&lt;/wsp:Policy&gt;<br />				&lt;/sp:Wss11&gt;<br />				&lt;sp:Wss10 xmlns:sp=<br />               "http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702"&gt;<br />					&lt;wsp:Policy&gt;<br />						&lt;sp:MustSupportRefIssuerSerial/&gt;<br />					&lt;/wsp:Policy&gt;<br />				&lt;/sp:Wss10&gt;<br />				&lt;sp:EncryptedParts xmlns:sp<br />               "http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702"&gt;<br />					&lt;sp:Body/&gt;<br />				&lt;/sp:EncryptedParts&gt;<br />			&lt;/wsp:All&gt;<br />		&lt;/wsp:ExactlyOne&gt;<br />	&lt;/wsp:Policy&gt;</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright Â© 2016-2023&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>