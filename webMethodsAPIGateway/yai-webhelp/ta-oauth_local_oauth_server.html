<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Securing APIs using OAuth 2.0 in API Gateway with Local Authorization Server</title><link rel="Prev" href="co-oauth_usecase_workflow.html" title="Previous" /><link rel="Next" href="ta-oauth_remote_integration_server.html" title="Next" /><link rel="StyleSheet" href="css/_api_gtw_integrated_webhelp.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/_api_gtw_integrated_webhelp_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/yai-webhelp/ta-oauth_local_oauth_server.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pHGlCREjELLqy6cuwE5W43A" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/yai-webhelp/ta-oauth_local_oauth_server.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>API Gateway</span>&nbsp;10.15 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/_api_gtw_integrated_webhelp.1.503.html#wwconnect_header">Using API Gateway</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/_api_gtw_integrated_webhelp.1.535.html#wwconnect_header">Implement APIs</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/gtw_manage_policies.html#wwconnect_header">Policies</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/gtw_iam_policies.html#wwconnect_header">Identify and Access</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/re-iam_identify_authorize_app.html#wwconnect_header">Identify &amp; Authorize</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">Securing APIs using OAuth 2.0 in API Gateway with Local Authorization Server</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0EE2XX" class="Heading_5">Securing APIs using OAuth 2.0 in API Gateway with Local Authorization Server</div><div id="wwID0ET2XX" class="Body">This use case explains, with a simple example, how to secure an API with OAuth2 authentication with <span class="ph">API Gateway</span> configured as both Resource Server and Authorization Server. The diagram illustrates the work flow for this use case.</div><div class="ww_skin_page_overflow"><div id="wwID0E42XX" class="Figure"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_workflow.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 160px; max-width: 504px; top: 0pt" alt="API Gateway as local oauth server" /></div></div><div id="wwID0EN3XX" class="Note"><span class="Bold">Note:<br /></span>Using the Authorization Code Grant type in this example. To understand the grant types supported by <span class="ph">API Gateway</span>, see 
    <a href="../yai-webhelp/co-oauth_usecase_workflow.html#wwID0ECKXX"
   
     title="OAuth Authentication in API Gateway"
    ><span class="heading-page">Authorization Grant Types Supported</span></a></div><div id="wwID0EV4XX" class="Section_Title">Actors</div><div id="wwID0E54XX" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Developers with basic knowledge about <span class="ph">webMethods API Gateway</span>, <span class="ph">Integration Server</span>, OAuth2 architecture</div><div id="wwID0EX5XX" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Customers with basic knowledge about <span class="ph">webMethods API Gateway</span>, <span class="ph">Integration Server</span>, OAuth2 architecture</div><div id="wwID0EZ6XX" class="Section_Title">Before you begin</div><div id="wwID0E56XX" class="Body">Ensure that you have:</div><div id="wwID0EHAYX" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Installed <span class="ph">Integration Server</span> with <span class="ph">API Gateway</span></div><div id="wwID0E6AYX" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Knowledge about any REST Client</div><div id="wwID0EQBYX" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="ph">API Gateway</span> up and running</div><div id="wwID0ELCYX" class="Section_Title">Basic Flow</div><div id="wwID0EQCYX" class="Body">The following diagram depicts the high level steps of the basic flow for this use case.</div><div class="ww_skin_page_overflow"><div id="wwID0EVCYX" class="Figure"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_highlvl_steps.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 193px; max-width: 490px; top: 0pt" alt="Basic flow" /></div></div><div id="wwID0ENDYX" class="Section_Title">Step 1: Configure API Gateway as local Authorization Server</div><div id="wwID0ESDYX" class="Body">In <span class="ph">API Gateway</span>, by default the internal authorization server for JWT, OAuth, or OpenID is set as <span class="userinput">local</span>. It means that <span class="ph">API Gateway</span> acts as an authorization server.</div><div id="wwID0EIEYX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span>Expand the menu options in the title bar and select <span class="uicontrol">Administration</span>.</div><div id="wwID0E4EYX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span>Select <span class="uicontrol">Security</span> &gt; <span class="uicontrol">JWT/OAuth/OpenID</span>. Click <span class="uicontrol">local</span>. All configurable settings for the local authorization server appear.</div><div id="wwID0E1FYX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span>Expand <span class="uicontrol">local</span>.</div><div id="wwID0EPGYX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>4. </span></span>Expand <span class="uicontrol">OAuth Configuration</span>, <span class="uicontrol">OAuth tokens</span>, and <span class="uicontrol">OAuth scope</span> sections.</div><div id="wwID0EMHYX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>5. </span></span>In this use case, retain the default values of <span class="uicontrol">Authorization code expiration interval (seconds)</span> and <span class="uicontrol">Access token expiration interval (seconds) </span> in the <span class="uicontrol">OAuth Configuration</span> section. You can modify these values as required.</div><div class="ww_skin_page_overflow"><div id="wwID0EJIYX" class="Figure_1"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_config_apigw.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 204px; max-width: 504px; top: 0pt" alt="configure API GAteway as local auth server" /></div></div><div id="wwID0EZIYX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>6. </span></span>Create OAuth Scopes,</div><div id="wwID0EKJYX" class="Numbered_1_Continued">OAuth scopes allow you to limit the access level that is granted to an access token. In this use case, we define one OAuth Scope (OAuth2Scopes) to limit the resource usage.</div><div id="wwID0ESJYX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Expand <span class="uicontrol">OAuth scopes</span> to add scope.</div><div id="wwID0EHKYX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>Provide values in the following fields</div><div id="wwID0E2KYX" class="List_3"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="Bold">Provide Scope</span>: <span class="Italic">OAuth2Scopes</span></div><div id="wwID0EULYX" class="List_3"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="Bold">Scope description</span>: <span class="Italic">OAuth2Scopes</span></div><div id="wwID0EOMYX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>Click <span class="uicontrol">Add</span>.</div><div id="wwID0EDNYX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>Click <span class="uicontrol">Update</span>. The OAuth scope is created.</div><div class="ww_skin_page_overflow"><div id="wwID0EYNYX" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_create_oauthscope.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 414px; max-width: 504px; top: 0pt" alt="Create OAuth scope" /></div></div><div id="wwID0EQOYX" class="Section_Title">Step 2: Configure HTTPS port in API Gateway</div><div id="wwID0EVOYX" class="Body">In this example, authorization is through HTTPS. To enable <span class="ph">API Gateway</span> to accept request through https, define a new HTTPS port in <span class="ph">API Gateway</span> or use the default HTTPS port provided by <span class="ph">API Gateway</span>. The default HTTPS port is <span class="userinput">5543</span> and it must be enabled from the Ports section of <span class="ph">API Gateway</span>.</div><div id="wwID0ETPYX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span>Expand the menu options in the title bar and select <span class="uicontrol">Administration</span>.</div><div id="wwID0EIQYX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span>Select <span class="uicontrol">Security</span> &gt; <span class="uicontrol">Ports</span>.</div><div id="wwID0EBRYX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span>You can do one of the following:</div><div id="wwID0EVRYX" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Use the default HTTPS port</div><div id="wwID0EGSYX" class="List_2_Continued">Click the <span class="uicontrol">Enable</span> field next to the 5543 port and enable it. The port is enabled.</div><div class="ww_skin_page_overflow"><div id="wwID0EPSYX" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_default_httpsport.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 129px; max-width: 504px; top: 0pt" alt="Enable HTTPS port" /></div></div><div id="wwID0E6SYX" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Add a new HTTPS port</div><div id="wwID0ETTYX" class="Numbered_3"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span>Click <span class="uicontrol">Add ports</span> on the Ports page.</div><div id="wwID0EIUYX" class="Numbered_3"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span>Select <span class="userinput">HTTPS</span> from the drop-down, and click <span class="uicontrol">Add</span>.</div><div id="wwID0EBVYX" class="Numbered_3"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span>Provide <span class="userinput">4646</span> in the <span class="uicontrol">Ports</span> field.</div><div id="wwID0E1VYX" class="Numbered_3"><span class="WebWorks_Number" style="width: 18pt"><span>4. </span></span>Provide <span class="userinput">HTTP_Port</span> in the <span class="uicontrol">Alias</span> field</div><div id="wwID0ETWYX" class="Numbered_3"><span class="WebWorks_Number" style="width: 18pt"><span>5. </span></span><span class="emphasis">Optional</span>. Expand <span class="uicontrol">Listener specific credentials</span>.</div><div id="wwID0EMXYX" class="Numbered_3"><span class="WebWorks_Number" style="width: 18pt"><span>6. </span></span>Select <span class="userinput">DEFAULT_IS_KEYSTORE</span> from the <span class="uicontrol">Keystore</span> drop-down list. The Key alias value appears automatically.</div><div id="wwID0EFYYX" class="Numbered_3"><span class="WebWorks_Number" style="width: 18pt"><span>7. </span></span>Select <span class="userinput">DEFAULT_IS_TRUSTSTORE</span> from the <span class="uicontrol">Truststore</span> drop-down list.</div><div id="wwID0E5YYX" class="Numbered_3"><span class="WebWorks_Number" style="width: 18pt"><span>8. </span></span>Click <span class="uicontrol">Add</span>. The port appears on the Ports screen.</div><div class="ww_skin_page_overflow"><div id="wwID0ETZYX" class="Figure_3"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_new_httpsport.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 257px; max-width: 508px; top: 0pt" alt="Create new HTTPS port" /></div></div><div id="wwID0ED1YX" class="Numbered_3"><span class="WebWorks_Number" style="width: 18pt"><span>9. </span></span>Click the <span class="uicontrol">Enable</span> field next to the 4646 port to set the port to default.</div><div id="wwID0EB2YX" class="Section_Title">Step 3: Create an API with strategy</div><div id="wwID0EG2YX" class="Body">In this example you create an API by importing from the URL 
    <a href="https://petstore.swagger.io/v2/swagger.json"
   
     target="external_window"
    ><span class="heading-page">https://petstore.swagger.io/v2/swagger.json</span></a>.</div><div id="wwID0E12YX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span>In the <span class="uicontrol">APIs</span> tab click <span class="uicontrol">Create API</span>.</div><div id="wwID0ET3YX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span>Select <span class="uicontrol">Import API from URL</span>.</div><div id="wwID0EI4YX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span>Provide the following details.</div><div id="wwID0E34YX" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="uicontrol">Name</span>: <span class="userinput">RestOps</span></div><div id="wwID0ET5YX" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="uicontrol">Type</span>: <span class="userinput">Swagger</span></div><div id="wwID0EK6YX" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="uicontrol">Version</span>: <span class="userinput">1.0</span></div><div id="wwID0ECAZX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>4. </span></span>Click <span class="uicontrol">Create</span>. The API is created and the API details page for the API appears.</div><div class="ww_skin_page_overflow"><div id="wwID0EXAZX" class="Figure_1"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_create_api.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 294px; max-width: 504px; top: 0pt" alt="Create API" /></div></div><div id="wwID0EHBZX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>5. </span></span>Enforce OAUTH2 policy on the API.</div><div id="wwID0EYBZX" class="Numbered_1_Continued">You enforce OAuth2 policy on the <span class="apiname">RestOps</span> API. This policy ascertains that an OAuth token is required to access this API.</div><div id="wwID0EGCZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Click <span class="uicontrol">API</span> in the title navigation panel.</div><div id="wwID0E2CZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>Click <span class="uicontrol">RestOps</span>.</div><div id="wwID0EQDZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>Click the <span class="uicontrol">Policies</span> tab.</div><div id="wwID0EFEZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>Click <span class="uicontrol">Edit</span>.</div><div id="wwID0E1EZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>e. </span></span>Click <span class="uicontrol">Identify &amp; Access</span> in the Policy catalog section.</div><div id="wwID0EPFZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>f. </span></span>Select the <span class="uicontrol">OAuth2 Token</span> check box in the <span class="uicontrol">Identification Type</span> field of the Application Identification section and save the changes.</div><div id="wwID0EIGZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>g. </span></span>Click <span class="uicontrol">Activate</span> to activate the API on the API details page of the API.</div><div class="ww_skin_page_overflow"><div id="wwID0E4GZX" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_enforce_policy.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 317px; max-width: 504px; top: 0pt" alt="Enforce OAuth policy" /></div></div><div id="wwID0EOHZX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>6. </span></span>Create an application with strategy and register it to an API.</div><div id="wwID0ECIZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Click <span class="uicontrol">Applications</span> in the title navigation bar.</div><div id="wwID0EXIZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>Click <span class="uicontrol">Create application</span>.</div><div id="wwID0EMJZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>Provide the <span class="uicontrol">Name</span>: <span class="userinput">APIApplication</span></div><div id="wwID0EEKZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>Click <span class="uicontrol">Continue to Identifiers</span>.</div><div class="ww_skin_page_overflow"><div id="wwID0EZKZX" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_create_app1.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 209px; max-width: 504px; top: 0pt" alt="Create application" /></div></div><div id="wwID0EJLZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>e. </span></span>Click <span class="uicontrol">Continue to APIs</span>.</div><div id="wwID0E5LZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>f. </span></span>Search the API <span class="apiname">RestOps</span>, by typing <span class="userinput">RestOps</span> in the <span class="uicontrol">Find APIs</span> text box.</div><div id="wwID0E3MZX" class="Numbered_2_Continued">The <span class="apiname">RestOps</span> API appears in the <span class="uicontrol">Selected APIs</span> section.</div><div id="wwID0ELNZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>g. </span></span>Select the <span class="apiname">RestOps</span>API.</div><div id="wwID0EBOZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>h. </span></span>Click <span class="uicontrol">Continue to Advanced</span></div><div class="ww_skin_page_overflow"><div id="wwID0EVOZX" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_create_app2.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 221px; max-width: 504px; top: 0pt" alt="Associate APIs" /></div></div><div id="wwID0EFPZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>i. </span></span>Click <span class="uicontrol">Continue to Authentication</span>.</div><div id="wwID0E1PZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>j. </span></span>Click <span class="uicontrol">Create strategy</span>.</div><div id="wwID0EPQZX" class="Numbered_2_Continued">A strategy is a way to authenticate the incoming request and provides multiple authentication mechanisms or multiple authorization servers for a single authentication scheme. You can create multiple strategies authorized by an API for an application.</div><div id="wwID0EUQZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>k. </span></span>Provide the <span class="uicontrol">Name</span> as <span class="userinput">AppStrategy</span>.</div><div id="wwID0ENRZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>l. </span></span>Enable the toggle button <span class="uicontrol">Generate credentials</span> to generate the credentials dynamically in the authorization server. The client-id and client-secret get created automatically.</div><div id="wwID0ECSZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>m. </span></span>Select <span class="userinput">Confidential</span> from the <span class="uicontrol">Application type</span> drop-down list.</div><div id="wwID0E2SZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>n. </span></span>Specify the redirect URIs that the authorization server can use to redirect the resource owner's browser during the grant process. In this example, provide <span class="userinput">www.example.com</span>, which is not a valid URL.</div><div id="wwID0EQTZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>o. </span></span>Select the required Grant types. In this example, the selected grant types are <span class="userinput">authorization_code</span> and <span class="userinput">client_credentials</span>.</div><div id="wwID0EJUZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>p. </span></span>Provide <span class="userinput">OAuth2Scopes</span> in the <span class="uicontrol">Scope</span> text box and click the search icon. The matching OAuth2Scopes appear.</div><div id="wwID0ECVZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>q. </span></span>Click the <span class="uicontrol">+</span> icon next to the required scope to add the scope to the strategy.</div><div id="wwID0EXVZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>r. </span></span>Click <span class="uicontrol">Add</span> to add the strategy.</div><div id="wwID0EMWZX" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>s. </span></span>Click <span class="uicontrol">Save</span>. The application is registered.</div><div class="ww_skin_page_overflow"><div id="wwID0EBXZX" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_create_app3.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 302px; max-width: 504px; top: 0pt" alt="Register application" /></div></div><div id="wwID0EZXZX" class="Section_Title">Step 4: Map OAuth scopes</div><div id="wwID0E5XZX" class="Body">After registering an application, you must map the scope defined in the Authorization server with the APIs in <span class="ph">API Gateway</span> to authorize the access tokens used to access the protected resources. You can map either a complete API or parts (resources or methods) of an API to the scope or can add the scope details and modify the scope details as required from the OAuth/OpenID scopes page. In this example you select the OAuth2Scopes scope.</div><div id="wwID0EMYZX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span>Expand the menu options in the title bar and select <span class="uicontrol">OAuth/OpenID scopes</span>.</div><div id="wwID0EBZZX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span>Click <span class="uicontrol">Map scope</span>.</div><div id="wwID0EWZZX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span>Type <span class="userinput">OAuth2Scopes</span> in <span class="uicontrol">Select authorization server scope</span> and select the Authorization server scope from the search list.</div><div class="ww_skin_page_overflow"><div id="wwID0EP1ZX" class="Figure_1"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_map_scope1.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 210px; max-width: 504px; top: 0pt" alt="Map scope" /></div></div><div id="wwID0E61ZX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>4. </span></span>Select <span class="uicontrol">API scopes</span> in the left pane.</div><div id="wwID0EU2ZX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>5. </span></span>Type <span class="userinput">RestOps</span> or API Scope, which is to be linked to the authorization server, in the <span class="uicontrol">API scopes</span> text box.</div><div id="wwID0EN3ZX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>6. </span></span>Click <span class="uicontrol">Save</span>.</div><div id="wwID0EC4ZX" class="Numbered_1_Continued">The authorization server scope is mapped to the selected API scopes and the authorization scope appears in the in the scopes list.</div><div class="ww_skin_page_overflow"><div id="wwID0EG4ZX" class="Figure_1"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_map_scope2.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 178px; max-width: 504px; top: 0pt" alt="Create scope mapping" /></div></div><div id="wwID0E44ZX" class="Section_Title">Step 5: Get authorization code</div><div id="wwID0EG5ZX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span>In the title bar click <span class="uicontrol">Application</span>.</div><div id="wwID0E25ZX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span>Click the application <span class="userinput">APIApplication</span>.</div><div id="wwID0EQ6ZX" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span>Click <span class="uicontrol">AppStrategy</span>. Note the <span class="uicontrol">Client id</span> and <span class="uicontrol">Client secret</span> values. You require these to get access token.</div><div class="ww_skin_page_overflow"><div id="wwID0ENA1X" class="Figure_1"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_oauth_code1.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 188px; max-width: 504px; top: 0pt" alt="Client id and secret" /></div></div><div id="wwID0E4A1X" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>4. </span></span>Access the Authorization code using the URL<span class="codeph"> https://&lt;machinename&gt;:5555/invoke/pub.oauth/authorize?client_id=eedab424fde14e258b0ab5d572de152d&amp;redirect_uri=http://example.com/redirect&amp;response_type=code&amp;state=121</span>. Approve the approval page and provide Integration server credentials if it prompts with a login page.</div><div class="ww_skin_page_overflow"><div id="wwID0ESB1X" class="Figure_1"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_oauth_code2.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 119px; max-width: 504px; top: 0pt" alt="Access authorization code" /></div></div><div id="wwID0ECC1X" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>5. </span></span>Receive the Authorization code through URL.</div><div id="wwID0ETC1X" class="Numbered_1_Continued">You might get an error, but the authorization code is present in the URL as you are providing dummy redirect URI.</div><div class="ww_skin_page_overflow"><div id="wwID0EXC1X" class="Figure_1"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_oauth_code3.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 48px; max-width: 504px; top: 0pt" alt="Retrieve authorization code" /></div></div><div id="wwID0EGD1X" class="Numbered_1_Continued">The output is as follows:</div><div id="wwID0ELD1X" class="Preformatted_1"> …www.example.com/redirect?code=25991916ad4343c5887cb03abcb04f1&amp;grant_type=authorization_code&amp;redirect_uri=http%253A%252F%252Fexample.com%252Fredirect&amp;state=121&amp;scope=View</div><div id="wwID0EYD1X" class="Section_Title">Step 6: Get access token</div><div id="wwID0EBE1X" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span>Open Postman or any other REST Client</div><div id="wwID0ESE1X" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span>Copy the authorization code received.</div><div id="wwID0EDF1X" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span>Make a POST call to the following URL, with the hostname of the system where API Gateway is installed in place of localhost and use external port instead of default port <span class="codeph"> https://&lt;machinename&gt;:4646 /invoke/pub.apigateway.oauth2/getAccessToken</span></div><div id="wwID0EXF1X" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>4. </span></span>In the Body provide the following request payload</div><div id="wwID0EIG1X" class="Preformatted_1">{<br />"code":"25991916ad4343c5887cb03abcb04f1",<br />"redirect_uri":"http://example.com/redirect",<br />"grant_type":"authorization_code",<br />"scope":"OAuth2Scopes"<br />}<br /></div><div class="ww_skin_page_overflow"><div id="wwID0ENG1X" class="Figure_1"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_access_token1.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 135px; max-width: 504px; top: 0pt" alt="Request payload sample" /></div></div><div id="wwID0E4G1X" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>5. </span></span>Provide the client id and client secret in Basic Auth.</div><div class="ww_skin_page_overflow"><div id="wwID0EOH1X" class="Figure_1"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_access_token2.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 116px; max-width: 504px; top: 0pt" alt="Provide client id and secret" /></div></div><div id="wwID0E5H1X" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>6. </span></span>In <span class="uicontrol">Headers</span> select <span class="userinput">Content-Type</span> as <span class="userinput">application/json</span> and <span class="userinput">Accept</span> as <span class="userinput">application/json</span></div><div class="ww_skin_page_overflow"><div id="wwID0ECJ1X" class="Figure_1"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_access_token3.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 131px; max-width: 504px; top: 0pt" alt="Content type and accept conditions" /></div></div><div id="wwID0ESJ1X" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>7. </span></span>The output gives the access token</div><div class="ww_skin_page_overflow"><div id="wwID0EDK1X" class="Figure_1"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_access_token4.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 73px; max-width: 504px; top: 0pt" alt="generate access token" /></div></div><div id="wwID0E1K1X" class="Section_Title">Step 7: Invoke API</div><div id="wwID0E6K1X" class="Body">Invoke the API with the access token</div><div class="ww_skin_page_overflow"><div id="wwID0EEL1X" class="Figure"><img class="ScaleFit" src="../yai-webhelp/images/oauth_local_server_invoke_api.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 101px; max-width: 504px; top: 0pt" alt="Invoke API" /></div></div><div id="wwID0E1L1X" class="Section_Title">Alternative Steps</div><div id="wwID0E6L1X" class="Body">You can perform the same use case with Client Credentials as well. Acquire the access token through client credentials by providing the client_id and client_secret.</div><div id="wwID0EIM1X" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span>Open Postman or any other Rest Client.</div><div id="wwID0EZM1X" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span>Make a POST call to the following URL, with the hostname of the system where API Gateway is installed in place of localhost and use external port instead of default port. <span class="codeph">https://&lt;machinename&gt;:4646 /invoke/pub.apigateway.oauth2/getAccessToken</span></div><div id="wwID0ENN1X" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span>In Headers provide Content-Type as application/json (if not specified)</div><div id="wwID0E5N1X" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>4. </span></span>In the Body provide the following Request payload</div><div id="wwID0EPO1X" class="Preformatted_1">{ <br />   “client_id”:”xxxxx”,  <br />   “client_secret”:”xxxxx”,<br />   “ grant_type”:”client_credentials”<br />}<br /></div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright © 2016-2023&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>