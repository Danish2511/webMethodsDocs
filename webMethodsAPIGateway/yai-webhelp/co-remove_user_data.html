<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Removing User Data</title><link rel="Prev" href="_api_gtw_integrated_webhelp.1.459.html" title="Previous" /><link rel="Next" href="_api_gtw_integrated_webhelp.1.461.html" title="Next" /><link rel="StyleSheet" href="css/_api_gtw_integrated_webhelp.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/_api_gtw_integrated_webhelp_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/yai-webhelp/co-remove_user_data.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pJo9aYeFkRPIdh1I2TJJdCw" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/yai-webhelp/co-remove_user_data.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>API Gateway</span>&nbsp;10.15 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/_api_gtw_integrated_webhelp.1.032.html#wwconnect_header">Administering API Gateway</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/_api_gtw_integrated_webhelp.1.459.html#wwconnect_header">Remove User Data from API Gateway</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">Removing User Data</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0EABDW" class="Heading_2">Removing User Data</div><div id="wwID0EIBDW" class="Body">Data protection laws and regulations, such as the General Data Protection Regulation (GDPR) might require specific handling of user data, even after a user profile is removed. Additionally, employees or other clients with user accounts on <span class="ph">API Gateway</span> may request that any user identifying information such as user name, email addresses, or client IP addresses be removed from <span class="ph">API Gateway</span>. To comply with data protection requirements and user requests, in addition to deleting the user account, you may need to complete activities such as deleting or masking the user data.</div><div id="wwID0EWBDW" class="Note"><span class="Bold">Note:<br /></span><span class="ph">API Gateway</span> can optionally capture the runtime transaction logs, which contain the API request and response data (customer-defined) that flow through to the <span class="ph">API Gateway</span>. Though there are options to purge or clean up these data, this section does not define procedure for the same as the customer-defined data is out of the scope of this functionality.</div><div id="wwID0E1CDW" class="Section_Title">Types of Data and their stores in <span class="ph">API Gateway</span></div><div id="wwID0EJDDW" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="inlinetitle">Core data</span></div><div id="wwID0EAEDW" class="List_1_Continued">This consists of APIs, policies, applications, aliases, packages, plans, administration configurations, users, and groups. This is stored in API Data Store and <span class="ph">Integration Server</span> store.</div><div id="wwID0ELEDW" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="inlinetitle">Runtime transactions</span></div><div id="wwID0ECFDW" class="List_1_Continued">This consists of the transaction events, monitoring events, error events, policy violation events, threat protection events, lifecycle events and performance metrics. This information can be stored in API Data Store or external destinations.</div><div id="wwID0EIFDW" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="inlinetitle">Application logs</span></div><div id="wwID0E6FDW" class="List_1_Continued">This consists of UI, server, Elasticsearch, Kibana, filebeat, and Platform logs . This is stored in filesystem and API Data Store.</div><div id="wwID0EFGDW" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="inlinetitle">Audit logs</span></div><div id="wwID0E4GDW" class="List_1_Continued">This is stored in API Data Store.</div><div id="wwID0EDHDW" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="inlinetitle">Tracer logs</span></div><div id="wwID0E2HDW" class="List_1_Continued">This consists of the runtime transactions that are captured when you trace the API. This information can be stored in API Data Store.</div><div id="wwID0EKIDW" class="Section_Title">Handling Core Data</div><div id="wwID0EPIDW" class="Body"><span class="ph">API Gateway</span> strongly recommends the use of internal or technical user for policy configurations like Authorize user, Invoke IS Service and Outbound Authentication that has user credentials. This avoids the life cycle of actual or real user object from impacting the <span class="ph">API Gateway</span> configurations.</div><div id="wwID0E3IDW" class="Body">In case, real users are used in policy configurations, then the API Provider or API Administrators should take the responsibility of changing the configurations once the user is deleted from the system.</div><div id="wwID0EJJDW" class="Section_Title">Handling Application Logs</div><div id="wwID0EOJDW" class="Body">In <span class="ph">API Gateway</span>, as you increase the log level to Debug or Trace, there can be messages that include the userid. So when a user has to be deleted from the system, Administrators have to clean up this data. The application logs are stored in file system till <span class="ph">API Gateway</span> version 10.2. From <span class="ph">API Gateway</span> 10.3, API Administrators have an option to persist the logs additionally in API Data Store.</div><div id="wwID0EAKDW" class="Body">The following is a sample query run to mask the user data in the application log stored either in the API Data Store or an external data store.</div><div id="wwID0EFKDW" class="Preformatted">curl -X POST -H 'Accept: application/json' -H 'Content-Type: application/json'<br />http://<span class="varname">hostname:port</span>/gateway_default_log/doc/_update_by_query -d ' {<br />"script": { "id": "findAndReplace", "params": {<br />"find": "user123", "replace": "******"} } } </div><div id="wwID0EXKDW" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="varname">hostname:port</span> refers to the host name and port of the system where the API Data Store or the external data store that contains the data resides.</div><div id="wwID0EOLDW" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>The <span class="uicontrol">Find</span> field contains the data or user information, such as username, id, that is to be masked.</div><div id="wwID0EFMDW" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>The field <span class="uicontrol">Replace</span> contains the string that is used to mask the data mentioned in the <span class="uicontrol">Find</span> field and replaces the data with the string provided in the logs.</div><div id="wwID0EBNDW" class="Body">Logs are always persisted in a file system. You can perform a search and replace using text editing tools. For example, you could search all server.log files for the id of the user to be deleted and replace it with anonymous or blank string. Following logs need to be cleaned up.</div><div id="wwID0EMNDW" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="varname">Install Directory</span>\<span class="ph">Integration Server</span>\instances\<span class="varname">Instance_Name</span>\logs\server.log. For details to cleanup other <span class="ph">Integration Server</span> related logs, see <span class="ph"> </span><span class="ph_002c_Citation">webMethods Integration Server Administrator’s Guide</span>.</div><div id="wwID0E1ODW" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="varname">Install Directory</span>\<span class="ph">Integration Server</span>\instances\<span class="varname">Instance_Name</span>\logs\APIGateway.log.</div><div id="wwID0E1PDW" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="varname">Install Directory</span>\InternalDataStore\logs.</div><div id="wwID0E2QDW" class="Section_Title">Handling Audit Logs</div><div id="wwID0EARDW" class="Body">If enabled, audit logs would have information about user actions. This contains user reference and has to be cleaned up after user deletion. You can achieve the cleanup in the following ways:</div><div id="wwID0ELRDW" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>As an Administrator, you can clean up the audit logs persisted in API Data Store by running the following curl query to replace or mask the desired data.</div><div id="wwID0E5RDW" class="List_1_Continued">The following is a sample query run to mask the user data in the Audit logs stored in the API Data Store.</div><div id="wwID0EDSDW" class="Preformatted_1">curl -X POST -H 'Accept: application/json' -H 'Content-Type: application/json' <br />http://<span class="varname">hostname:port</span>/gateway_default_audit_auditlogs/_update_by_query -d ' { <br />"script": { "id": "findAndReplace", "params": { <br />"find": "user123", "replace": "******"} } } '</div><div id="wwID0EVSDW" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="varname">hostname:port</span> refers to the host name of the system where the API Data Store resides and the corresponding port.</div><div id="wwID0EMTDW" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>The <span class="uicontrol">Find</span> field contains the data or user information, such as username, id, that is to be masked.</div><div id="wwID0EDUDW" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>The field <span class="uicontrol">Replace</span> contains the string that is used to mask the data mentioned in the <span class="uicontrol">Find</span> field and replaces the data with the string provided in the logs.</div><div id="wwID0EAVDW" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>As an Administrator, you can use the extended setting <span class="userinput">saveAuditlogsWithPayload</span> to not store the request payloads in the audit logs. Though this does not completely eliminate the user information in audit logs it certainly minimizes the occurrences. <span class="ph">Software&nbsp;AG</span> recommends you to use this property with caution as turning on this option might lead to less audit data being captured.</div><div id="wwID0EEWDW" class="Section_Title">Handling Tracer Logs</div><div id="wwID0EJWDW" class="Body">If you enable the tracer, the data that <span class="ph">API Gateway</span> captures might have user-specific information. You can either mask or remove the user data from the server log trace span, mediator trace span, and request response trace span indices. You can either mask full or partial text in the user data.</div><div id="wwID0ETWDW" class="Body">The following sample query is used to mask the user data in the server log trace span:</div><div id="wwID0EYWDW" class="Preformatted">curl -X POST http(s)://elasticsearch_hostname:elasticsearch_port/<br />gateway_{tenant}_serverlogtracespans/_doc/_update_by_query?pretty -H 'Content-Type: application/json' -d'<br />{<br />"script": {<br />  "id": "findAndReplaceInTracerData",<br />    "params": {<br />      "find": "textToFind",<br />      "replace": "textToReplace"<br />    }<br />  }<br />}'</div><div id="wwID0E5WDW" class="Body">The following sample query is used to mask the user data in the mediator trace span:</div><div id="wwID0EDXDW" class="Preformatted">curl -X POST http(s)://elasticsearch_hostname:elasticsearch_port/<br />gateway_{tenant}_mediatortracespan/_doc/_update_by_query?pretty -H 'Content-Type: application/json' -d'<br />{<br />"script": {<br />  "id": "findAndReplaceInTracerData",<br />    "params": {<br />      "find": "textToFind",<br />      "replace": "textToReplace"<br />    }<br />  }<br />}<br />'</div><div id="wwID0EJXDW" class="Body">The following sample query is used to mask the user data in the request response trace span:</div><div id="wwID0EOXDW" class="Preformatted">curl -X POST http(s)://elasticsearch_hostname:elasticsearch_port/<br />gateway_{tenant}_requestresponsetracespans/_doc/_update_by_query?pretty -H 'Content-Type: application/json' -d'<br />{<br />"script": {<br />  "id": "findAndReplaceInTracerData",<br />    "params": {<br />      "find": "textToFind",<br />      "replace": "textToReplace"<br />    }<br />  }<br />}<br />'</div><div id="wwID0E1XDW" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>The <span class="uicontrol">Find</span> field contains the data or user information, such as username, id, that is to be masked.</div><div id="wwID0ERYDW" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>The field <span class="uicontrol">Replace</span> contains the string that is used to mask the data mentioned in the <span class="uicontrol">Find</span> field and replaces the data with the string provided in the server log trace span, mediator trace span, and request response trace span indices.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright © 2016-2023&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>