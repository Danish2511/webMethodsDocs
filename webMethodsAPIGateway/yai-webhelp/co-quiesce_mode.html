<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Quiesce Mode</title><link rel="Prev" href="ta-upgrade_cluster_deployments.html" title="Previous" /><link rel="Next" href="to-upgrade_external_es_kibana.html" title="Next" /><link rel="StyleSheet" href="css/_api_gtw_integrated_webhelp.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/_api_gtw_integrated_webhelp_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/yai-webhelp/co-quiesce_mode.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pPysnRUVRXZVl2x52JIddkQ" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/yai-webhelp/co-quiesce_mode.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>API Gateway</span>&nbsp;10.15 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/_api_gtw_integrated_webhelp.1.801.html#wwconnect_header">Upgrading and Migrating to API Gateway</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/to-upgrading_apigw_zero_downtime_landing_page.html#wwconnect_header">Upgrading API Gateway in Zero Downtime</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">Quiesce Mode</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0EH3U4" class="Heading_2">Quiesce Mode</div><div id="wwID0EV4U4" class="Body">Quiescing <span class="ph">API Gateway</span> temporarily disables access to the server so you can perform the required tasks while the server is not connected to any external resources. In <span class="ph">API Gateway</span> the quiesce mode is used during the zero downtime upgrade wherein the access to the server is temporarily disabled, so you can perform the upgrade tasks.</div><div id="wwID0ED5U4" class="Body"><span class="ph">API Gateway</span> supports the following two types of quiesce mode:</div><div id="wwID0ES5U4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Type 1: Blocks only design time requests.</div><div id="wwID0EF6U4" class="List_1_Continued">In this mode <span class="ph">API Gateway</span> server blocks all design time requests such as all the CRUD operations for <span class="ph">API Gateway</span> assets like APIs, policies, applications, and so on, and returns an appropriate status code (503) to the client. The following requests are an exception and are still allowed by <span class="ph">API Gateway</span>:</div><div id="wwID0E46U4" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>All GET requests</div><div id="wwID0EQAV4" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>/rest/apigateway/quiescemode</div><div id="wwID0EDBV4" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>/rest/apigateway/search</div><div id="wwID0EWBV4" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>/rest/facade/apigateway/searchApis</div><div id="wwID0ELCV4" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Type 2: Blocks all requests</div><div id="wwID0E5CV4" class="List_1_Continued">In this mode <span class="ph">API Gateway</span> becomes unreachable for all the requests, design time, and runtime. Any requests that are already in progress are permitted to finish, but any new inbound requests to the server are blocked. This mode is an extension of the <span class="ph">Integration Server</span> quiesce mode, where <span class="ph">API Gateway</span> flushes the Quota, performance, and transaction license metrics data to the data store before the <span class="ph">API Gateway</span> package is disabled. While flushing the performance, license, and quota metrics data, <span class="ph">API Gateway</span> performs the following operations:</div><div id="wwID0E5DV4" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Resets performance and license metrics intervals of the corresponding scheduler for all the APIs to be run immediately and flushes the data to be persisted into the database. For example:</div><div id="wwID0EXEV4" class="List_3"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="ph">API Gateway</span> publishes performance metrics as per the <span class="userinput">Publish interval</span> configured. That is, if the <span class="userinput">Publish interval</span> is set as 60 seconds, then <span class="ph">API Gateway</span> publishes the performance metrics to the configured destination after 60 seconds. But, in quiesce mode <span class="ph">API Gateway</span> immediately publishes the performance metrics to the database.</div><div id="wwID0E4FV4" class="List_3"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="ph">API Gateway</span> publishes transaction license metrics after 30 minutes, which is the default interval scheduled to publish the license metrics, to the data store. But in quiesce mode <span class="ph">API Gateway</span> immediately publishes the license metrics to the data store.</div><div id="wwID0EYGV4" class="List_2_Continued">In a cluster, only the controlling node performs this operation.</div><div id="wwID0E5GV4" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Starts the subscription quota intervals and counters persisting scheduler immediately to store the data in the database. For example, <span class="ph">API Gateway</span> runs the subscription quota counters for an interval configured as per the <span class="userinput">pgmen.quotaSurvival.interval</span> extended setting and publishes the data after the specified interval to the data store. But in quiesce mode <span class="ph">API Gateway</span> immediately publishes the quota metrics to the data store.</div><div id="wwID0E5HV4" class="List_1_Continued">When all the performance metrics and other data are flushed completely, a notification mentioning that quiesce mode for all is enabled is sent through a webhook. The CRUD operations of webhook objects are supported in the Administration REST API of <span class="ph">API Gateway</span>. For more details, see API Gateway Administration API in the 
    <a href="../yai-webhelp/co-restapi_apigw_config.html#wwID0EFLX4"
   
     title="API Gateway Administration"
    ><span class="ph_002c_heading-page">API Gateway
						Administration</span></a>.</div><div id="wwID0EYIV4" class="List_1_Continued">For details about quiesce mode in <span class="ph">Integration Server</span>, see <span class="ph"> </span><span class="ph_002c_Citation">webMethods Integration Server Administratorâ€™s Guide</span>.</div><div id="wwID0EVJV4" class="Section_Title">Enabling and Disabling Quiesce Mode</div><div id="wwID0E1JV4" class="Body"><span class="ph">API Gateway</span> provides a REST API to enable quiesce mode.</div><div id="wwID0EDKV4" class="Body">Enable or disable quiesce mode with the following REST call:</div><div id="wwID0EIKV4" class="Body"><span class="inlinetitle">PUT</span> /rest/apigateway/quiescemode</div><div id="wwID0ESKV4" class="Preformatted">{<br />    "enable": true/false,<br />    "block": "<span class="varname">designtime/all</span>"<br />    "flush": [<br />        "license_metrics",<br />        "performance_metrics",<br />        "subscription_quota"<br />    ]<br />}<br /></div><div id="wwID0E5KV4" class="Body">Set the block parameter as <span class="userinput">designtime</span> to block only design time requests. The flush parameter is not applicable when you set the block parameter as <span class="userinput">designtime</span>.</div><div id="wwID0EMLV4" class="Body">Set the block parameter as <span class="userinput">all</span> to block all requests. The flush parameter is applicable when you set the block parameter as <span class="userinput">all</span>. In the above example, when you set the block parameter as <span class="userinput">all</span>, <span class="ph">API Gateway</span> blocks all the requests and flushes the license metrics, performance metrics, and subscription quota data. If you do not specify anything for the flush parameter, then all the data is flushed.</div><div id="wwID0ECMV4" class="Body">Set the enable parameter as <span class="userinput">true</span> to enable quiesce mode.</div><div id="wwID0EMMV4" class="Body">Set the enable parameter as <span class="userinput">false</span> to disable the quiesce mode. This is supported only when the block parameter is set as <span class="userinput">designtime</span>. When the block parameter is set as <span class="userinput">all</span>, <span class="ph">API Gateway</span> is quiesced and is unreachable. Hence, you cannot disable the <span class="ph">API Gateway</span> quiesce mode by invoking this API.</div><div id="wwID0EGNV4" class="Body">Use the <span class="ph">Integration Server</span> API <span class="codeph">POST /invoke/wm.server.quiesce/setActiveModeinvoke/wm.server.quiesce/setActiveMode</span>, which is accessed through the quiesce port, to disable the <span class="ph">Integration Server</span> quiesce mode when the block parameter is set as <span class="userinput">all</span>. This, in turn, disables the quiesce mode for all requests in <span class="ph">API Gateway</span>.</div><div id="wwID0EAOV4" class="Note"><span class="Bold">Note:<br /></span>For invoking the quiesce mode for all requests, you must specify the port through which the server enters and exits quiesce mode. For details about specifying the quiesce port, see <span class="ph"> </span><span class="ph_002c_Citation">webMethods Integration Server Administratorâ€™s Guide</span>.</div><div id="wwID0EAPV4" class="Body">Retrieve the quiesce mode settings as well as the current status with the following REST call.</div><div id="wwID0EFPV4" class="Body"><span class="inlinetitle">GET</span> /rest/apigateway/quiescemode</div><div id="wwID0EPPV4" class="Preformatted">{<br />    "enable": true/false,<br />    "block": "designtime/all"<br />    "flush": [<br />        "license_metrics",<br />        "performance_metrics",<br />        "subscription_quota"<br />    ],<br />    "status": "success",<br />    "failureReason": null<br />}<br /></div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright Â© 2016-2023&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>