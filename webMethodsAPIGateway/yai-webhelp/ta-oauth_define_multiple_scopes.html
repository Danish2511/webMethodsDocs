<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Defining Multpile OAuth 2.0 Scopes in API Gateway</title><link rel="Prev" href="ta-oauth_secure_apis_external_ports.html" title="Previous" /><link rel="Next" href="ta-retrieve_oauth_token.html" title="Next" /><link rel="StyleSheet" href="css/_api_gtw_integrated_webhelp.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/_api_gtw_integrated_webhelp_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/yai-webhelp/ta-oauth_define_multiple_scopes.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pRGgGZAlk96AHIUgELHnGyA" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/yai-webhelp/ta-oauth_define_multiple_scopes.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>API Gateway</span>&nbsp;10.15 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/_api_gtw_integrated_webhelp.1.503.html#wwconnect_header">Using API Gateway</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/_api_gtw_integrated_webhelp.1.535.html#wwconnect_header">Implement APIs</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/gtw_manage_policies.html#wwconnect_header">Policies</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/gtw_iam_policies.html#wwconnect_header">Identify and Access</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/re-iam_identify_authorize_app.html#wwconnect_header">Identify &amp; Authorize</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">Defining Multpile OAuth 2.0 Scopes in API Gateway</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0EICGY" class="Heading_5">Defining Multpile OAuth 2.0 Scopes in API Gateway</div><div id="wwID0EXCGY" class="Body"><span class="emphasis">Scope</span> is a mechanism in OAuth 2.0 to limit an application's access to a user's account. Scope is required to get an access token. A <span class="emphasis">scope</span> is the definition of the resources the client application can access on behalf of a resource owner. In API Gateway, scope is defined for methods or resources of an API. You can apply Scope to an API from the <span class="inlinetitle">Identity and Access Policy</span> page.</div><div id="wwID0ELDGY" class="Body"><span class="inlinetitle">Types of Scopes</span></div><div id="wwID0EYDGY" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="inlinetitle">OAuth Scope:</span> Defined in Authorization Server</div><div id="wwID0ENEGY" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="inlinetitle">API Scope:</span> Scope defined in API</div><div id="wwID0EDFGY" class="Body">If you do not define scope for an API, a global scope is provided by default. This global scope is applicable for all the methods or resources of the API .</div><div id="wwID0EIFGY" class="Body"><span class="inlinetitle">Actors</span></div><div id="wwID0EXFGY" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Developers with basic knowledge on webMethods API Gateway, Integration Server, OAuth2 architecture</div><div id="wwID0EKGGY" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Customers with basic knowledge on webMethods API Gateway, Integration Server, OAuth2 architecture</div><div id="wwID0E5GGY" class="Body"><span class="inlinetitle">Before you begin</span></div><div id="wwID0EHHGY" class="Body">Ensure that you have:</div><div id="wwID0ESHGY" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Installed Integration Server with API Gateway</div><div id="wwID0EFIGY" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Knowledge on any REST Client</div><div id="wwID0EYIGY" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>API Gateway up and running</div><div id="wwID0EUJGY" class="Section_Title">Basic Flow</div><div id="wwID0EZJGY" class="Body">This section explains the following three flows :</div><div id="wwID0EEKGY" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Creating OAuth Scopes in the Local Authorization Server and mapping this scope to the Global Scope for an API</div><div id="wwID0EXKGY" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Creating OAuth Scopes in External Authorization Server and mapping this scope to the Global Scope for an API</div><div id="wwID0EKLGY" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Creating multiple OAuth Scopes in Local Authorization Server and mapping this scope to the Scope defined in the API</div><div id="wwID0EEMGY" class="Section_Title">Creating OAuth scopes in local authorization server and mapping this scope to the global Scope for an API</div><div id="wwID0EPMGY" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span>Create OAuth scope in local authorization server .</div><div id="wwID0ECNGY" class="Numbered_1_Continued">You can create the OAuth scope using the<span class="uicontrol"> Authorization Server</span> page.</div><div id="wwID0ERNGY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Expand the menu options in the title bar and select <span class="uicontrol">Administration</span></div><div id="wwID0EHOGY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>Select <span class="uicontrol">Security</span> &gt; <span class="uicontrol">JWT/OAuth/OpenID</span>. Click <span class="uicontrol">local</span>. All configurable settings for the local authorization server appears</div><div id="wwID0EGPGY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>Click <span class="uicontrol">local</span></div><div id="wwID0E3PGY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>Click <span class="uicontrol">OAuth Scope</span> to add Scope</div><div id="wwID0ETQGY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>e. </span></span>Provide the values in the following fields</div><div id="wwID0EHRGY" class="List_3"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="uicontrol">Scope:</span> OAuth2Scopes</div><div id="wwID0E2RGY" class="List_3"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="uicontrol">Scope description:</span> OAuth2Scopes</div><div id="wwID0EQSGY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>f. </span></span>Click <span class="uicontrol">Add</span>.</div><div class="ww_skin_page_overflow"><div id="wwID0EHTGY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_CreateMult_LocalServ.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 295px; max-width: 631px; top: 0pt" alt="Create OAuth in Local server" /></div></div><div id="wwID0EYTGY" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span>Map the OAuth scope to the global scope.</div><div id="wwID0ELUGY" class="Numbered_1_Continued">You must map the OAuth scope to the global scope or to a scope defined for the methods or resources of the API. Here, as the scope for the methods or resources of the API is not created, the methods or resources of the API is not restricted.The global scope is applicable to all the methods or resources of the API.</div><div id="wwID0EPUGY" class="Numbered_1_Continued">In this example, consider the global scope API scopes. Map the OAuth scope to the API scopes for an API <span class="emphasis">RestOps</span>.</div><div id="wwID0E6UGY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Expand the menu options in the title bar and select <span class="uicontrol">OAuth/OpenID scopes</span>.</div><div id="wwID0EWVGY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>Click<span class="uicontrol">Maps scope</span>. Type <span class="ph">OAuth2Scopes</span> in <span class="uicontrol">Select authorization server scope</span> and select the listed authorization server scope from list.</div><div class="ww_skin_page_overflow"><div id="wwID0EVWGY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Map_GobalScope1.png" width="100%" style="display: inline; float: none; left: 0pt; max-height: 263px; max-width: 631px; top: 0pt" alt="Map OAuth to global Scope" /></div></div><div id="wwID0EIXGY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>Click <span class="uicontrol">API scopes</span></div><div id="wwID0E5XGY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>Type either the the API <span class="ph">RestOps</span> or <span class="ph">API Scope</span> in <span class="uicontrol">API scopes</span>. This is the Global scope, which is to be linked to the authorization server.</div><div id="wwID0E4YGY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>e. </span></span>Save the changes. This maps the authorization server scope to the selected API scopes and lists the authorization scope in the scopes list.</div><div class="ww_skin_page_overflow"><div id="wwID0EQZGY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Map_GobalScope2.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 223px; max-width: 631px; top: 0pt" alt="Map OAuth to global scope" /></div></div><div id="wwID0E4YGY-3" class="Numbered_2_Continued">For details on other configurations and how to invoke the API, see 
    <a href="../yai-webhelp/ta-oauth_local_oauth_server.html#wwID0EE2XX"
   
     title="Securing APIs using OAuth 2.0 in API Gateway with Local Authorization Server"
    ><span class="heading-page"> Securing APIs using OAuth 2.0 in API Gateway with Local Authorization Server</span></a></div><div id="wwID0EV1GY" class="Section_Title">Creating OAuth scopes in External Authorization Server and mapping this scope to the Global Scope for an API</div><div id="wwID0E51GY" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span>Create OAuth scope in external authorization server.</div><div id="wwID0EP2GY" class="Numbered_1_Continued">In the authorization page the external authorization server is defined. Initially scope has to be created in the external authorization server. The same scope needs to be created or gets automatically listed with the discovery URL. Here the external authorization server is OKTA.</div><div id="wwID0EX2GY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Create scope getscope in OKTA.</div><div id="wwID0EI3GY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>Expand the menu options in the title bar and select<span class="uicontrol">Administration</span></div><div id="wwID0E43GY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>Select<span class="uicontrol">Security</span> &gt; <span class="uicontrol">JWT/OAuth/OpenID.</span>. Click <span class="uicontrol">local</span>. This displays all the configurable settings for the Authorization Server</div><div id="wwID0E14GY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>Click on <span class="uicontrol">okta-oauth-server</span></div><div id="wwID0EO5GY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>e. </span></span>Click <span class="uicontrol">Scopes</span></div><div id="wwID0ED6GY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>f. </span></span>Click on <span class="uicontrol">Scopes</span>. Verify getscope is present in the list.</div><div class="ww_skin_page_overflow"><div id="wwID0EY6GY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Create_in_ExtSer.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 173px; max-width: 631px; top: 0pt" alt="Create OAuth in External Authorization server" /></div></div><div id="wwID0EKAHY" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span>Map the external OAuth scope to the global scope.</div><div id="wwID0E2AHY" class="Numbered_1_Continued">You must map the scope specified in the OKTA Authorization server with the APIs in API Gateway to authorise the access tokens to access the protected resources.</div><div id="wwID0EDBHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Expand the menu options in the title bar and select <span class="uicontrol">OAuth/OpenID scopes</span>.</div><div id="wwID0EYBHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>Click <span class="uicontrol">Map scope</span>.</div><div id="wwID0ENCHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>Type <span class="ph">getscope</span> in <span class="uicontrol">select authorization server scope</span> and select the listed authorization server scope from the search list populated.</div><div id="wwID0EGDHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>Provide Audience : <span class="uicontrol">Administrator</span></div><div class="ww_skin_page_overflow"><div id="wwID0E2DHY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Map_ExtSer_GlobalScope1.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 237px; max-width: 631px; top: 0pt" alt="Mapping OAuth to External Server" /></div></div><div id="wwID0EMEHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>e. </span></span>Click <span class="uicontrol">API scopes</span>.</div><div id="wwID0EBFHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>f. </span></span>Type <span class="userinput">RestOps</span> or <span class="userinput">API scope</span>, which is to be linked to the authorization server, in API scopes search text box.</div><div id="wwID0E1FHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>g. </span></span>Save the changes. This maps the authorization server scope to the selected API scopes and lists the authorization scope in the scope list</div><div class="ww_skin_page_overflow"><div id="wwID0ELGHY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Map_ExtSer_GlobalScope2.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 225px; max-width: 631px; top: 0pt" alt="Mapping OAuth to Global Scope" /></div></div><div id="wwID0E1GHY" class="Numbered_2_Continued">For details on other configurations and how to invoke the API, see 
    <a href="../yai-webhelp/ta-oauth_thridparty_oauth_server.html#wwID0E3C5X"
   
     title="Securing APIs using OAuth 2.0 in API Gateway using Third Party Authorization Server"
    ><span class="heading-page"> Securing APIs using OAuth 2.0 in API Gateway using Third Party Authorization
    Server</span></a>.</div><div id="wwID0ESHHY" class="Section_Title">Creating multiple OAuth Scopes in Local Authorization Server and mapping this scope to the scope defined in the API</div><div id="wwID0E2HHY" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span>Create multiple OAuth scopes in local authorization server.</div><div id="wwID0ERIHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Expand the menu options in the title bar and select <span class="uicontrol">Administration</span></div><div id="wwID0EIJHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>Select <span class="uicontrol">Security</span> &gt; <span class="uicontrol">JWT/OAuth/OpenID</span>. Click<span class="uicontrol">Local</span>. This displays all the configurable settings for the authorization server</div><div id="wwID0EHKHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>Click on <span class="uicontrol">Local</span>.</div><div id="wwID0E5KHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>Click <span class="uicontrol">OAuth scopes</span> to add scope. Add the following OAuth scopes <span class="userinput">read</span>, <span class="userinput">write</span>, <span class="userinput">modify</span>, and <span class="userinput">delete</span> and click <span class="uicontrol">Add</span>.</div><div id="wwID0EJMHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>e. </span></span>Click <span class="uicontrol">Update</span>.</div><div class="ww_skin_page_overflow"><div id="wwID0EANHY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_CreateMult_LocalServ.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 295px; max-width: 631px; top: 0pt" alt="Creating Multiple OAuth Scopes" /></div></div><div id="wwID0EUNHY" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span>Create scopes for the API.</div><div id="wwID0EKOHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Navigate to <span class="uicontrol">APIs</span> in the title navigation bar.</div><div id="wwID0EBPHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>Click <span class="uicontrol">RestOps</span>.</div><div id="wwID0EYPHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>Click <span class="uicontrol">Scopes</span>.</div><div id="wwID0EPQHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>Click <span class="uicontrol">Edit</span>.</div><div id="wwID0EGRHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>e. </span></span>Click <span class="uicontrol">Add Scope</span>.</div><div class="ww_skin_page_overflow"><div id="wwID0E4RHY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Create_Scope_for_API1.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 140px; max-width: 631px; top: 0pt" alt="Creating API scopes" /></div></div><div id="wwID0EQSHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>f. </span></span>Provide the name: <span class="emphasis">readScope</span></div><div id="wwID0EITHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>g. </span></span>In <span class="uicontrol">Resources and methods</span> select GET for /store/inventory method. You can select other GET methods as well.</div><div id="wwID0E6THY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>h. </span></span>Click <span class="uicontrol">Save</span>.</div><div class="ww_skin_page_overflow"><div id="wwID0EWUHY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Create_Scope_for_API2.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 167px; max-width: 631px; top: 0pt" alt="Creating API scopes" /></div></div><div id="wwID0EJVHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>i. </span></span>Click <span class="uicontrol">Edit</span>.</div><div id="wwID0EAWHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>j. </span></span>Click <span class="uicontrol">Add Scope</span>.</div><div id="wwID0EXWHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>k. </span></span>Provide name: <span class="userinput">writeScope</span> and select POST in /user method.</div><div class="ww_skin_page_overflow"><div id="wwID0EOXHY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Create_Scope_for_API3.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 190px; max-width: 631px; top: 0pt" alt="Creating API scopes" /></div></div><div id="wwID0EBYHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>l. </span></span>Create scopes updateScope and select PUT in /user/{username}</div><div class="ww_skin_page_overflow"><div id="wwID0EUYHY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Create_Scope_for_API4.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 247px; max-width: 631px; top: 0pt" alt="Creating API Scopes" /></div></div><div id="wwID0EHZHY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>m. </span></span>Create scope deleteScope and select DELETE in /user/{username}</div><div class="ww_skin_page_overflow"><div id="wwID0E1ZHY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Create_Scope_for_API5.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 237px; max-width: 631px; top: 0pt" alt="Creating API scopes" /></div></div><div id="wwID0E61HY" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span>Enforce OAuth2 policy on the API RestOps with the required scope.</div><div id="wwID0ER2HY" class="Numbered_1_Continued">This policy ascertains that a OAuth token is required to access this API.</div><div id="wwID0E32HY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Click <span class="uicontrol">API</span> in the title navigation bar.</div><div id="wwID0ET3HY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>Click <span class="uicontrol">RestOps</span>.</div><div id="wwID0EK4HY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>Click <span class="uicontrol">Policies</span>.</div><div id="wwID0EB5HY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>Click <span class="uicontrol">Edit</span>.</div><div id="wwID0EY5HY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>e. </span></span>Click <span class="uicontrol">Identify &amp; Access </span>from the Policy catalog section .</div><div id="wwID0EP6HY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>f. </span></span>Click <span class="uicontrol">Save</span>.</div><div class="ww_skin_page_overflow"><div id="wwID0EGAIY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Enforcing_OAuth2_Policy.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 359px; max-width: 631px; top: 0pt" alt="Enforcing OAuth Policy" /></div></div><div id="wwID0E2AIY" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>4. </span></span><span class="inlinetitle">Map the OAuth scope to the API-level scope.</span></div><div id="wwID0EQBIY" class="Numbered_1_Continued">Here, you map the OAuth scope that was defined in the local Authorization server with the API-level scope defined in the <span class="apiname">RestOps</span> API.</div><div id="wwID0E5BIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Expand the menu options in the title bar and select <span class="uicontrol">OAuth/OpenID</span> scopes.</div><div id="wwID0ETCIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>Click Map Scope, type <span class="userinput">read</span> in select authorization server scope and select the listed authorization server scope from the search list populated.</div><div class="ww_skin_page_overflow"><div id="wwID0EIDIY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Mapping_to_APIlevelScope1.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 181px; max-width: 631px; top: 0pt" alt="Mapping OAuth scope to API scope" /></div></div><div id="wwID0EZDIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>Click <span class="uicontrol">API scopes.</span></div><div id="wwID0ENEIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>Type <span class="userinput">Restops</span> or <span class="userinput">readScope</span>, which is to be linked to the authorization server, in API scopes search text box.</div><div id="wwID0EGFIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>e. </span></span>Save the changes. This maps the authorization server scope to the selected API scopes and lists the authorization scope in the scopes list.</div><div class="ww_skin_page_overflow"><div id="wwID0EXFIY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Mapping_to_APIlevelScope2.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 150px; max-width: 631px; top: 0pt" alt="Mapping OAuth to API Scope" /></div></div><div id="wwID0EIGIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>f. </span></span>Similarly Map</div><div id="wwID0E3GIY" class="List_3"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>write OAuth Scope to <span class="emphasis">writeScope</span> of API.</div><div id="wwID0ESHIY" class="List_3"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>update OAuth Scope to <span class="emphasis">updateScope</span> of API.</div><div id="wwID0EIIIY" class="List_3"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>delete OAuth Scope to <span class="emphasis">delete Scope</span> of API.</div><div class="ww_skin_page_overflow"><div id="wwID0E5IIY" class="Figure_3"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Mapping_to_APIlevelScope3.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 140px; max-width: 631px; top: 0pt" alt="Mapping OAuth to API scope" /></div></div><div id="wwID0EQJIY" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>5. </span></span>Configure application and strategy.</div><div id="wwID0EGKIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Click <span class="uicontrol">Applications</span> in the title navigation bar.</div><div id="wwID0E2KIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>Click <span class="uicontrol">Create application</span> provide the Name: <span class="userinput">TestApplication</span>.</div><div id="wwID0EULIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>Click <span class="uicontrol">Continue to Identifiers</span>.</div><div class="ww_skin_page_overflow"><div id="wwID0ELMIY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Config_App_Strgy1.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 246px; max-width: 631px; top: 0pt" alt="Configuring Application strategy" /></div></div><div id="wwID0E5MIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>Click on <span class="uicontrol">Continue to APIs</span>.</div><div id="wwID0EVNIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>e. </span></span>Type <span class="userinput">RestOps</span> in the <span class="uicontrol">Find APIs</span> text box. The API is listed in the drop down box.</div><div id="wwID0EQOIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>f. </span></span>Select the <span class="userinput">RestOps</span> API.</div><div id="wwID0EHPIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>g. </span></span>Click <span class="uicontrol">Continue to Advanced</span>. In the Advanced page, no input is required.</div><div id="wwID0E5PIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>h. </span></span>Click on <span class="uicontrol">Continue to Authentication</span>.</div><div id="wwID0EVQIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>i. </span></span>Click <span class="uicontrol">Create Strategy</span>. A strategy is a way to authenticate the incoming request and provides multiple authentication mechanisms or multiple authorization servers for a single authentication scheme. You can create multiple strategies authorized by an API for an application.</div><div id="wwID0EMRIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>j. </span></span>Provide the Name: <span class="userinput">TestStrategy</span></div><div id="wwID0ECSIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>k. </span></span>Enable the toggle button <span class="uicontrol">Generate credentials</span> to dynamically generate the client in the authorization server. By enabling the toggle button client-id and client-secret are created automatically.</div><div id="wwID0EZSIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>l. </span></span>Select <span class="uicontrol">Confidential</span> as application type.</div><div id="wwID0EQTIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>m. </span></span>Specify the redirect URIs that the authorization server can use to redirect the resource owner's browser during the grant process. In this case, you are provided with www.example.com which is not a valid URL.</div><div id="wwID0EDUIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>n. </span></span>Select the required Grant types, <span class="userinput">authorization_code</span> and <span class="userinput">client_credentials</span>.</div><div id="wwID0E5UIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>o. </span></span>Provide the following scopes in the scope text box and click the search icon.</div><div id="wwID0EWVIY" class="Numbered_3"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>read, click <span class="uicontrol">Add </span></div><div id="wwID0ENWIY" class="Numbered_3"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>write, click <span class="uicontrol">Add </span></div><div id="wwID0EEXIY" class="Numbered_3"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>update, click <span class="uicontrol">Add </span></div><div id="wwID0E2XIY" class="Numbered_3"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>delete, click <span class="uicontrol">Add </span></div><div id="wwID0EUYIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>p. </span></span>Click <span class="uicontrol">Add</span> to add the trsategy.</div><div id="wwID0EJZIY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>q. </span></span>Click <span class="uicontrol">Save</span>.</div><div class="ww_skin_page_overflow"><div id="wwID0EA1IY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Config_App_Strgy2.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 292px; max-width: 631px; top: 0pt" alt="Configuring Application strategy" /></div></div><div id="wwID0EU1IY" class="Numbered_1"><span class="WebWorks_Number" style="width: 18pt"><span>6. </span></span>Get the authorization code.</div><div id="wwID0EF2IY" class="Numbered_1_Continued">You require the client_id and client_secret to get the authorization code.</div><div id="wwID0EP2IY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span>Navigate to Applications in the title Menu.</div><div id="wwID0EC3IY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span>Click on <span class="uicontrol">TestApplication </span>.</div><div id="wwID0EZ3IY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span>Under Authentication, click <span class="userinput">TestStrategy</span> strategy.</div><div id="wwID0EQ4IY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span>Copy the client id.</div><div id="wwID0ED5IY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>e. </span></span>Invoke the following url to get the authorization code</div><div id="wwID0EW5IY" class="Numbered_2_Continued"><span class="codeph">http://</span><span class="codeph_002c_varname">&lt;machinename&gt;</span><span class="codeph">:4444/invoke/pub.oauth/authorize?​client_id=01fc7b74-1f56-48d5-81fe-bcd6e895d40f&amp;​redirect_uri=www.example.com&amp;response_type=code&amp;state=121</span></div><div class="ww_skin_page_overflow"><div id="wwID0EE6IY" class="Figure_2"><img class="ScaleFit" src="../yai-webhelp/images/OAuth_Getng_Auth_code.png" width="100%" style="display: block; float: none; left: 0pt; max-height: 196px; max-width: 631px; top: 0pt" alt="Getting Authorization code" /></div></div><div id="wwID0EX6IY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>f. </span></span>If you select read, you get the authorization code only for read scope</div><div id="wwID0EKAJY" class="Numbered_2_Continued">Example <span class="codeph">http://&lt;machinename&gt;:4444/invoke/wm.server.oauth/www.example.com?​code=4c4f499e6b894103972bd12c6e8e49d7&amp;grant_type=authorization_code&amp;​redirect_uri=www.example.com&amp;state=121&amp;scope=read</span></div><div id="wwID0EVAJY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>g. </span></span>If you select only write, you get the authorization code only for write scope</div><div id="wwID0EIBJY" class="Numbered_2_Continued">Example <span class="codeph">http://&lt;machinename&gt;:4444/invoke/wm.server.oauth/www.example.com?​code=e295940d2daa4ac3887575400c81b78b&amp;grant_type=authorization_code&amp;​redirect_uri=www.example.com&amp;state=121&amp;scope=write </span></div><div id="wwID0ETBJY" class="Numbered_2"><span class="WebWorks_Number" style="width: 18pt"><span>h. </span></span>If you select all, you will get the authorization code only for read+write+update+delete scope</div><div id="wwID0EGCJY" class="Numbered_2_Continued">Example <span class="codeph">http://&lt;machinename&gt;:4444/invoke/wm.server.oauth/www.example.com?​code=3cbcfb3523624675a54925bd96b56bea&amp;grant_type=authorization_code&amp;​redirect_uri=www.example.com&amp;state=121&amp;scope=read+write+update+delete</span></div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright © 2016-2023&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>