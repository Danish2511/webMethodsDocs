<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Configuring Elasticsearch Cluster</title><link rel="Prev" href="co-api_gtw_data_store_configuration.html" title="Previous" /><link rel="Next" href="ta-add_node_to_cluster.html" title="Next" /><link rel="StyleSheet" href="css/_api_gtw_integrated_webhelp.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/_api_gtw_integrated_webhelp_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/yai-webhelp/ta-configure_api_gtw_data_store.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pvyT90SVDFwieoOgNQV_002fsaA" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/yai-webhelp/ta-configure_api_gtw_data_store.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>API Gateway</span>&nbsp;10.15 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/_api_gtw_integrated_webhelp.1.032.html#wwconnect_header">Administering API Gateway</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/_api_gtw_integrated_webhelp.1.033.html#wwconnect_header">Deployment</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/co-deploy_configuration.html#wwconnect_header">Deployment Configurations</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/co-cluster_deployment.html#wwconnect_header">Cluster Deployment</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/co-api_gtw_data_store_configuration.html#wwconnect_header">API Data Store Cluster Configuration</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">Configuring Elasticsearch Cluster</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0E4OBM" class="Heading_5">Configuring Elasticsearch Cluster</div><div id="wwID0EMPBM" class="Body">Before you start, ensure that the Elasticsearch is not started after <span class="ph">API Gateway</span> installation.</div><div id="wwID0E5PBM" class="procedure"><span><img src="icon_task_xpe.png" alt="*" border="0" width="20" height="13" /></span><span class="procedure">To configure an Elasticsearch cluster</span></div><div id="wwID0EPQBM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span><span class="Command">If you have started </span><span class="Command_002c_Command">API Gateway</span><span class="Command"> before setting up the Elasticsearch cluster configuration, perform the following steps before proceeding with the configuration: </span></div><div id="wwID0EZRBM" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Log off and exit from <span class="ph">API Gateway</span>.</div><div id="wwID0EQSBM" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Delete the nodes folder from the <span class="filepath_002c_varname">Installation Location</span><span class="filepath">\InternalDataStore\data</span> folder.</div><div id="wwID0ENTBM" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Make the necessary cluster configuration and start <span class="ph">API Gateway</span>.</div><div id="wwID0EEUBM" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Start Elasticsearch.</div><div id="wwID0EZUBM" class="Step_Result_1">A node is created in the Elasticsearch cluster.</div><div id="wwID0E6UBM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span><span class="Command">Open </span><span class="Command_002c_uicontrol">elasticsearch.yml</span><span class="Command"> from </span><span class="Command_002c_filepath_002c_varname">SAG_root</span><span class="Command_002c_filepath">/InternalDataStore/config/elasticsearch.yml</span><span class="Command"> in any node that you want to cluster. </span></div><div id="wwID0EKWBM" class="Step_Info_1">The following configuration is a sample of how the configuration appears initially.</div><div id="wwID0EPWBM" class="Preformatted_1">cluster.name:"SAG_EventDataStore"<br />node.name: node1<br />path.logs: SAG_root\InternalDataStore/logs<br />network.host:0.0.0.0<br />http.port:9240<br />discovery.seed_hosts: ["node1:9340"]<br />transport.port:9340<br />path.repo:['SAG_root\InternalDataStore/archives']<br />cluster.initial_master_nodes:["node1"]<br />xpack.ml.enabled: false<br />xpack.security.enabled: false<br />xpack.security.transport.ssl.enabled: false<br />xpack.security.http.ssl.enabled: false<br />action.destructive_requires_name: false</div><div id="wwID0EVWBM" class="Body_1"><span class="parmname">discovery.seed_hosts</span>. Provide a list of nodes to the Elasticsearch that it should try to contact. Once the node contacts a member of the unicast list, it receives a full cluster state that lists all nodes in the cluster. It then proceeds to contact the master and join the cluster.</div><div id="wwID0E6WBM" class="Body_1"><span class="parmname">path.repo</span>. This is a mandatory configuration for performing backup and restore. This is the location where the Elasticsearch writes the snapshots to. Hence, it is important to have a location that is accessible to all the nodes. The location must be network file system, S3 or Azure in the clustered setup.</div><div id="wwID0EJXBM" class="Body_1"><span class="parmname">cluster.initial_master_nodes</span>. This parameter must be set so that when you start a cluster for the first time cluster bootstrapping is performed. The parameter must contain the names of the master-eligible nodes in the initial cluster and must be defined on every master-eligible node in the cluster. This setting helps prevent split-brain, the existence of two masters in a single cluster.</div><div id="wwID0ETXBM" class="Body_1"><span class="parmname">action.destructive_requires_name</span>. This parameter is set to be <span class="emphasis">false</span> so that the migration and backup processes can be performed.</div><div id="wwID0ECYBM" class="Body_1">Elasticsearch provides an option to configure the locations where you would want to store your data and logs. Ensure that you specify the locations that are accessible and have enough disk space. It is also important to monitor and ensure basic house keeping of the data location by planning an effective data retention strategy. You can change the defaults using the following configuration:</div><div id="wwID0EHYBM" class="Preformatted_1">path.data: /var/lib/elasticsearch<br />path.logs: &lt;IS\_Installed\_Location&gt;/InternalDataStore/logs<br />// These values can be changed</div><div id="wwID0ENYBM" class="Body_1">Elasticsearch, by default, binds to loop back address and hence it is important to change it for a production deployment. For more details on this configuration, see 
    <a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.2/modules-network.html"
   
     target="external_window"
    ><span class="heading-page">https://www.elastic.co/guide/en/elasticsearch/reference/8.2/modules-network.html</span></a></div><div id="wwID0E6YBM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span><span class="Command">Provide the name of the cluster in the </span><span class="Command_002c_uicontrol">cluster.name</span><span class="Command"> property. </span></div><div id="wwID0E5ZBM" class="Step_Info_1">Nodes with same cluster names form a cluster. That is, if there are three nodes in the cluster, the value in the <span class="uicontrol">cluster.name</span> property must be same across all three nodes. In other words, Elasticsearch forms a cluster with nodes that have the same <span class="uicontrol">cluster.name</span>.</div><div id="wwID0EL1BM" class="Body_1"><span class="inlinetitle">For example,</span></div><div id="wwID0EV1BM" class="Preformatted_1">cluster.name:"SAG_EventDataStore"</div><div id="wwID0E41BM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>4. </span></span><span class="Command">Provide the names of all participating nodes, as seen in the </span><span class="Command_002c_uicontrol">node.name</span><span class="Command"> property, and the ports they use, as seen in the </span><span class="Command_002c_uicontrol">http.port</span><span class="Command"> property, in the </span><span class="Command_002c_uicontrol">discovery.seed_hosts</span><span class="Command"> property in the following format: </span></div><div id="wwID0EN3BM" class="Preformatted_1">host_name:port_name</div><div id="wwID0ET3BM" class="Body_1">If there are three nodes in the cluster, the value in the <span class="uicontrol">discovery.seed_hosts</span> property is as in the following example:</div><div id="wwID0E43BM" class="Preformatted_1">discovery.seed_hosts: ["node1:9340","node2:9340","node3":"9340"]</div><div id="wwID0ED4BM" class="Body_1">The names of all nodes appear in the <span class="uicontrol">cluster.initial_master_nodes</span> property. The node name displayed in this property is same as seen in the <span class="uicontrol">node.name</span> property.</div><div id="wwID0ER4BM" class="Body_1">Sample configuration of a node is as follows:</div><div id="wwID0EW4BM" class="Preformatted_1">cluster.name:"SAG_EventDataStore"<br />node.name: node1<br />path.logs: SAG_root\InternalDataStore/logs<br />network.host:0.0.0.0<br />http.port:9240<br />discovery.seed_hosts: ["hostname1:9340","hostname2:9340","hostname3:9340"]<br />transport.port:9340<br />path.repo:['SAG_root\InternalDataStore/archives']<br />cluster.initial_master_nodes:["node1","node2","node3"]<br />xpack.ml.enabled: false<br />xpack.security.enabled: false<br />xpack.security.transport.ssl.enabled: false<br />xpack.security.http.ssl.enabled: false<br />action.destructive_requires_name: false</div><div id="wwID0E54BM" class="Step_Result_1">The specified nodes are clustered.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright © 2016-2023&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>