<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>How Do I Monitor the Health Status of the Data Center?</title><link rel="Prev" href="co-DC_failure_detection.html" title="Previous" /><link rel="Next" href="ta-standalone_mode_final.html" title="Next" /><link rel="StyleSheet" href="css/_api_gtw_integrated_webhelp.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/_api_gtw_integrated_webhelp_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/yai-webhelp/ta-health_check.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="ptdNsnrnAhrDPVO2ik2yL7w" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/yai-webhelp/ta-health_check.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>API Gateway</span>&nbsp;10.15 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/_api_gtw_integrated_webhelp.1.032.html#wwconnect_header">Administering API Gateway</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/_api_gtw_integrated_webhelp.1.415.html#wwconnect_header">High Availability, Disaster Recovery, and Fault Tolerance</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/co-overview_ft_crossdc.html#wwconnect_header">High Availability and Fault Tolerance</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../yai-webhelp/co-DC_failure_detection.html#wwconnect_header">How does Cross-DC Support Detect Data Center Failures?</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">How Do I Monitor the Health Status of the Data Center?</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0EP1YV" class="Heading_4">How Do I Monitor the Health Status of the Data Center?</div><div id="wwID0E61YV" class="Body">This use case explains how to track and monitor the health status of the data centers in the consistent hash ring using the REST API <span class="uicontrol">GET /rest/apigateway/dataspace/status</span>. The status can be <span class="userinput">GREEN</span>, <span class="userinput">YELLOW</span>, or <span class="userinput">RED</span>.</div><div id="wwID0EV2YV" class="Body">If the health status is <span class="userinput">GREEN</span>, then all the data centers are able to communicate with one another without any problem.</div><div id="wwID0E62YV" class="Body">If the health status is <span class="userinput">YELLOW</span>, then it indicates that this data center is unable to communicate with one or more of the data centers in the ring. This might be because one or more data centers in the ring is down temporarily as it is getting restarted. It could also be permanently down because of connection issue or the API Gateway instance is down. The API Gateway waits for a certain period of time (as configured in the pg_Dataspace_TimeToFail) before marking the data center as down. Once the data center is marked as down, it will be marked as failed data center and health status will be marked as <span class="userinput">YELLOW</span>. The node gets marked as YELLOW until the time configured in the pg_Dataspace_WarmupTime property gets elapsed. If the data center is not up even after the time specified in the pg_Dataspace_WarmupTime property, then the health status is marked as <span class="userinput">RED</span>.</div><div id="wwID0ER3YV" class="Body">The following flow chart explains how the health of the data center is monitored using the GET /rest/apigateway/dataspace/status REST API:</div><div class="ww_skin_page_overflow"><div id="wwID0EY1YV-8" class="Context"><img class="ScaleFit" src="../yai-webhelp/images/flowchart_dc.png" width="100%" style="display: inline; float: none; left: 0pt; max-height: 641px; max-width: 906px; top: 0pt" alt="" /></div></div><div id="wwID0EE4YV" class="Body">For example, assume that you have three data centers DC 1, DC 2, and DC 3 in the following landscape:</div><div class="ww_skin_page_overflow"><table class="rules1" cellspacing="0" summary=""><tr><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: 16.8%"><div id="wwID0EI5YV" class="Table_Cell_Head">Data Center Name</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: 29.5%"><div id="wwID0EO5YV" class="Table_Cell_Head">Host Name</div></td><td class="Table_Cell_Head" style="background-color: #CFCFCE; border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: 53.6%"><div id="wwID0EU5YV" class="Table_Cell_Head">Region</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EB6YV" class="Table_Cell">DC 1</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EH6YV" class="Table_Cell">uk.myhost.com</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EN6YV" class="Table_Cell">United Kingdom</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EX6YV" class="Table_Cell">DC 2</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E46YV" class="Table_Cell">us.myhost.com</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EDAZV" class="Table_Cell">United States</div></td></tr><tr><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ENAZV" class="Table_Cell">DC 3</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ETAZV" class="Table_Cell">in.myhost.com</div></td><td class="Table_Cell" style="border-bottom-color: Black; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EZAZV" class="Table_Cell">India</div></td></tr></table></div><div id="wwID0EDBZV" class="Body">In general, the active-active mode can accommodate any number of data centers in the consistent hash ring. But in the hot standby mode there are only two nodes in the ring.</div><div id="wwID0EIBZV" class="procedure"><span><img src="icon_task_xpe.png" alt="*" border="0" width="20" height="13" /></span>To track the health status of the data centers</div><div id="wwID0EUBZV" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span><span class="Command">Invoke the REST API to track the health status. </span></div><div id="wwID0EMCZV" class="Step_Info_1">Track the health status of the data center in the consistent hash ring using the REST API <span class="uicontrol">GET /rest/apigateway/dataspace/status</span></div><div id="wwID0EVCZV" class="Note_1"><span class="Bold">Note:<br /></span>To invoke the REST API, you must provide the basic authentication.</div><div id="wwID0EMDZV" class="Step_Info_1">For example:</div><div id="wwID0ERDZV" class="Body_1">Request: <span class="userinput">GET http://uk.myhost.com:5555/rest/apigateway/dataspace/status</span>.</div><div id="wwID0E2DZV" class="Body_1">HTTP response appears as follows:</div><div id="wwID0EAEZV" class="Preformatted_1"><br />{<br />    "detectedNodes": [<br />        {<br />            "nodeName": "a04609a0-ca13-44db-98e1-f988ba18fbb4",<br />            "host": "us.myhost.com",<br />	           "port": 4440<br />        },<br />        {<br />            "nodeName": "4820681b-f2fd-42d7-bccd-cf580ea8bf1c"<br />            "host": "in.myhost.com",<br />	           "port": 4440<br />        }<br />    ],<br />    "liveNodes": "[a04609a0-ca13-44db-98e1-f988ba18fbb4],[4820681b-f2fd-42d7-bccd-cf580ea8bf1c]"<br />    "health": "GREEN"<br />}<br /></div><div id="wwID0EGEZV" class="Body_1">When all the data center is able to communicate, the response status code displays as <span class="emphasis">200</span> and health status displays as <span class="userinput">GREEN</span>.</div><div id="wwID0EXEZV" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span><span class="Command">Invoke the REST API to detect the failing nodes . </span></div><div id="wwID0EPFZV" class="Step_Info_1">Detect the failing nodes in the consistent hash ring when the health status is in <span class="userinput">YELLOW</span> using the REST API <span class="uicontrol">GET /rest/apigateway/dataspace/status?watchFailingNodes=true</span>. For example:</div><div id="wwID0E3FZV" class="Body_1">Request: <span class="userinput">GET http://uk.myhost.com:5555/rest/apigateway/dataspace/status?watchFailingNodes=true</span>.</div><div id="wwID0EGGZV" class="Body_1">HTTP response appears as follows:</div><div id="wwID0ELGZV" class="Preformatted_1"><br />{<br />    "detectedNodes": [<br />        {<br />            "nodeName": "a04609a0-ca13-44db-98e1-f988ba18fbb4",<br />            "host": "us.myhost.com",<br />	           "port": 4440<br />        },<br />        {<br />            "nodeName": "4820681b-f2fd-42d7-bccd-cf580ea8bf1c"<br />            "host": "in.myhost.com",<br />	           "port": 4440<br />        }<br />    ],<br />    "liveNodes": "[a04609a0-ca13-44db-98e1-f988ba18fbb4],[4820681b-f2fd-42d7-bccd-cf580ea8bf1c]"<br />    "failingNodes":"[4820681b-f2fd-42d7-bccd-cf580ea8bf1c]"<br />    "health": "YELLOW"<br />}<br /></div><div id="wwID0ERGZV" class="Body_1">Though the DC 3 is detected as failing node, the response status code displays as <span class="emphasis">200</span> and health status displays as <span class="userinput">YELLOW</span>.</div><div id="wwID0EAHZV" class="Note_1"><span class="Bold">Note:<br /></span>If the DC 3 does not come back even after the time specified in the pg_Dataspace_TimeToFail and pg_Dataspace_WarmupTime properties, then the health status is marked as <span class="userinput">RED</span>. In that case, the number of detected nodes and lives nodes differs in the response payload.</div><div id="wwID0E2HZV" class="Body_1">HTTP response appears as follows:</div><div id="wwID0EAIZV" class="Preformatted_1"><br />{<br />    "detectedNodes": [<br />        {<br />            "nodeName": "a04609a0-ca13-44db-98e1-f988ba18fbb4",<br />            "host": "us.myhost.com",<br />	           "port": 4440<br />        },<br />        {<br />            "nodeName": "4820681b-f2fd-42d7-bccd-cf580ea8bf1c"<br />            "host": "in.myhost.com",<br />	           "port": 4440<br />        }<br />    ],<br />    "liveNodes": "[a04609a0-ca13-44db-98e1-f988ba18fbb4]"<br />    "failingNodes":"[4820681b-f2fd-42d7-bccd-cf580ea8bf1c]"<br />    "health": "RED"<br />}<br /></div><div id="wwID0EPFZV-18" class="Step_Info_1">The response status code displays as <span class="emphasis">500</span> and health status displays as <span class="userinput">RED</span>.</div><div id="wwID0ERIZV" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span><span class="Command">Invoke the REST API to monitor the gossip data. </span></div><div id="wwID0EJJZV" class="Step_Info_1">Monitor the gossip vector element value in the nodes, when the health status is in <span class="userinput">YELLOW</span> using the REST API <span class="uicontrol">GET /rest/apigateway/dataspace/status?watchFailingNodes=true &amp;fetchGossipData=true</span> to ensure if the <span class="emphasis">Gossiping protocol</span> works well. For example:</div><div id="wwID0E2JZV" class="Body_1">Request: <span class="userinput">GET http://uk.myhost.com:5555/rest/apigateway/dataspace/status?watchFailingNodes=true &amp;fetchGossipData=true</span>.</div><div id="wwID0EFKZV" class="Body_1">HTTP response appears as follows:</div><div id="wwID0EKKZV" class="Preformatted_1"><br />{<br />    "detectedNodes": [<br />        {<br />            "nodeName": "a04609a0-ca13-44db-98e1-f988ba18fbb4",<br />            "host": "us.myhost.com",<br />	           "port": 4440<br />        },<br />        {<br />            "nodeName": "4820681b-f2fd-42d7-bccd-cf580ea8bf1c"<br />            "host": "in.myhost.com",<br />	           "port": 4440<br />        }<br />    ],<br />    "liveNodes": "[a04609a0-ca13-44db-98e1-f988ba18fbb4],[4820681b-f2fd-42d7-bccd-cf580ea8bf1c]"<br />    "failingNodes":"[4820681b-f2fd-42d7-bccd-cf580ea8bf1c]"<br />    "gossipData": "[a04609a0-ca13-44db-98e1-f988ba18fbb4, 121],[4820681b-f2fd-42d7-bccd-cf580ea8bf1c, 78]"<br />    "health": "YELLOW"<br />}<br /></div><div id="wwID0EQKZV" class="Body_1">The DC 3 is detected as failing node and the gossip vector element in the DC 3 does not get incremented, the response status code displays as <span class="emphasis">200</span> and health status displays as <span class="userinput">YELLOW</span>. API Gateway waits until the time specified in the pg_Dataspace_TimeToFail property, once the time elapses, then DC 3 is removed from the ring and marked as down.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright Â© 2016-2023&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>