<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Using REPEAT to Retry a Failed Step</title><link rel="Prev" href="esb.flow.repeat.failWhen.html" title="Previous" /><link rel="Next" href="esb.flow.repeat.retrySuccessful.html" title="Next" /><link rel="StyleSheet" href="css/is_integrated_webhelp.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/is_integrated_webhelp_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/integration-server-integrated-webhelp/esb.flow.repeat.retryFailed.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pi2FJUjyMpygxkYTpQ6Wh5A" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/integration-server-integrated-webhelp/esb.flow.repeat.retryFailed.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>Integration Server</span>&nbsp;10.11 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../integration-server-integrated-webhelp/to-webhelp_intro_sd_guide.html#wwconnect_header">Service Development Guide</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../integration-server-integrated-webhelp/esb.flow.html#wwconnect_header">Building Flow Services</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../integration-server-integrated-webhelp/esb.flow.repeat.html#wwconnect_header">The REPEAT Step</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">Using REPEAT to Retry a Failed Step</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0EXNANB" class="Heading_3">Using REPEAT to Retry a Failed Step</div><div id="wwID0EPOANB" class="Context">If your flow invokes services that access external systems, you can use the REPEAT step to accommodate network errors, such as busy servers or connection errors, at run time. If you use the REPEAT step for this purpose, keep the following points in mind:</div><div id="wwID0E3OANB" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>The following types of failures satisfy the FAILURE condition:</div><div id="wwID0EUPANB" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Expiration of a child step’s <span class="uicontrol">Timeout</span> limit</div><div id="wwID0ELQANB" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>An exception thrown by a Java service</div><div id="wwID0E5QANB" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>A document query that returns an unpermitted null value</div><div id="wwID0ETRANB" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>If you specify multiple children under a REPEAT step, the failure of any one of the children will cause the entire set of children to be re-executed.</div><div id="wwID0EGSANB" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>The REPEAT step immediately exits a set of children at the point of failure for the current iteration. That is, if the second child in a set of three fails, the third child is not executed in that iteration of the REPEAT step.</div><div id="wwID0EZSANB" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>When <span class="uicontrol">Repeat on</span> is set to FAILURE, the failure of a child within a REPEAT step does not cause the REPEAT step itself to fail unless the <span class="uicontrol">Count</span> limit is also reached.</div><div id="wwID0EUTANB" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>When <span class="uicontrol">Repeat on</span> is set to FAILURE and an iteration fails, the pipeline is restored to its original state as it was before that iteration started. Rollback operations are performed on the first level of the pipeline only. That is, first-level variables are restored to their original values before the iteration failed, but the server does not roll back changes to any documents to which the first-level variables refer.</div><div id="wwID0ELUANB" class="List_1_Continued">The <span class="uicontrol">Scope</span> property value, which restricts the REPEAT step to a particular document in the pipeline does not limit what is rolled back on failure. The rollback always occurs at the first level of the pipeline; the rollback does not occur at the scope level.</div><div id="wwID0EWUANB" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>The <span class="uicontrol">Timeout</span> property for the REPEAT step specifies the amount of time in which the entire REPEAT step, including all of its possible iterations, must complete. When you use REPEAT to retry on failure, you may want to leave the <span class="uicontrol">Timeout</span> value at 0 (no limit) or set it to a very high value. You can also set the property to the value of a pipeline variable by typing the name of the variable between % symbols. The variable you specify must be a String.</div><div id="wwID0ERVANB" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>As a developer, you must be thoroughly familiar with the processes you include within a REPEAT step. Make certain that the child steps you specify can safely be repeated in the event that a failure occurs. You don’t want to use REPEAT if there is the possibility that a single action, such as accepting an order or crediting an account balance, could be applied twice.</div><div id="wwID0EFWANB" class="procedure"><span><img src="icon_task_xpe.png" alt="*" border="0" width="20" height="13" /></span>To build a REPEAT step that re-executes failed steps</div><div id="wwID0ERWANB" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span><span class="Command">If you are inserting a REPEAT step into an existing flow service, display that service in the editor and highlight the step immediately above where you want the REPEAT step inserted. </span></div><div id="wwID0EJXANB" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span><span class="Command">Do one of the following: </span></div><div class="ww_skin_page_overflow"><div id="wwID0EGYANB" class="Choice_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Click the <img class="Default" src="../integration-server-integrated-webhelp/images/bulletDown.gif" width="100%" style="display: inline; float: none; left: 0pt; max-height: 9px; max-width: 10px; top: 0pt" alt="" /> button next to <img class="Default" src="../integration-server-integrated-webhelp/images/ns_flow.gif" width="100%" style="display: inline; float: none; left: 0pt; max-height: 11px; max-width: 11px; top: 0pt" alt="" /> on the flow service editor toolbar and click <img class="Default" src="../integration-server-integrated-webhelp/images/Repeat.gif" width="100%" style="display: inline; float: none; left: 0pt; max-height: 11px; max-width: 11px; top: 0pt" alt="" />.</div></div><div class="ww_skin_page_overflow"><div id="wwID0E4ZANB" class="Choice_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Click <img class="Default" src="../integration-server-integrated-webhelp/images/thin_view_menu_left.GIF" width="100%" style="display: inline; float: none; left: 0pt; max-height: 8px; max-width: 11px; top: 0pt" alt="" /> by the side of the flow service editor to open the Palette view. Click <img class="Default" src="../integration-server-integrated-webhelp/images/Repeat.gif" width="100%" style="display: inline; float: none; left: 0pt; max-height: 11px; max-width: 11px; top: 0pt" alt="" /> and drag it to the flow service editor.</div></div><div id="wwID0EK2ANB" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span><span class="Command">Complete the following fields on the Properties view: </span></div><div class="ww_skin_page_overflow"><table class="norules2" cellspacing="4" summary=""><tr><td class="Table_Cell_Head" style="border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: 23.3%"><div id="wwID0EM4ANB" class="Table_Cell_Head">For this property...</div></td><td class="Table_Cell_Head" style="border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: 76.6%"><div id="wwID0ES4ANB" class="Table_Cell_Head">Specify...</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EB5ANB" class="Table_Cell"><span class="uicontrol">Comments</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EM5ANB" class="Table_Cell">An optional descriptive comment for this step.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EX5ANB" class="Table_Cell"><span class="uicontrol">Scope</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EC6ANB" class="Table_Cell">The name of a document (IData object) in the pipeline to which you want to restrict this step. If you want this step to have access to the entire pipeline, leave this property blank.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EN6ANB" class="Table_Cell"><span class="uicontrol">Timeout</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EY6ANB" class="Table_Cell">Optional. Specifies the maximum number of seconds that this step should run. If this time elapses before the step completes, <span class="ph">Integration Server</span> issues a FlowTimeoutException and execution continues with the next step in the service.</div><div id="wwID0ECABNB" class="Table_Cell">If you want to use the value of a pipeline variable for this property, type the variable name between % symbols. For example, <span class="codeph">%expiration%</span>. The variable you specify must be a String.</div><div id="wwID0EMABNB" class="Table_Cell">If you do not need to specify a time-out period, leave <span class="uicontrol">Timeout</span> blank.</div><div id="wwID0EWABNB" class="Table_Cell">For more information about how <span class="ph">Integration Server</span> handles flow step timeouts, refer to the description of the watt.server.threadKill.timeout.enabled configuration parameter in <span class="ph"> </span><span class="ph_002c_Citation">webMethods Integration Server Administrator’s Guide</span>.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EQBBNB" class="Table_Cell"><span class="uicontrol">Label</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E2BBNB" class="Table_Cell">An optional name for this specific REPEAT step, or a null, unmatched, or empty string (<span class="uicontrol">$null</span>, <span class="uicontrol">$default</span>, blank).</div><div id="wwID0EJCBNB" class="Important"><span class="Bold">Important:<br /></span>If you use this step as a target for a BRANCH or EXIT step, you must specify a value in the <span class="uicontrol">Label</span> property. For more information about the BRANCH and EXIT steps, see 
    <a href="../integration-server-integrated-webhelp/esb.flow.branch.html#wwID0E5D4MB"
   
     title="The BRANCH Step"
    ><span class="heading-page">The BRANCH Step</span></a> or 
    <a href="../integration-server-integrated-webhelp/esb.flow.exit.html#wwID0EU5DNB"
   
     title="The EXIT Step"
    ><span class="heading-page">The EXIT Step</span></a>.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E3DBNB" class="Table_Cell"><span class="uicontrol">Count</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EHEBNB" class="Table_Cell">The maximum number of times you want the children to be re-executed. If you want to use the value of a pipeline variable for this property, type the variable name between % symbols (for example, <span class="codeph">%servicecount%</span>). The variable you specify must be a String.</div><div id="wwID0EREBNB" class="Table_Cell">If you want the children re-executed until they are all successful (that is, no maximum limit), set this value to –1.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E3EBNB" class="Table_Cell"><span class="uicontrol">Repeat interval</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EHFBNB" class="Table_Cell">The length of time (in seconds) that you want the server to wait between iterations of the children.</div><div id="wwID0ENFBNB" class="Table_Cell">If you want to use the value of a pipeline variable for this property, type the variable name between % symbols (for example, <span class="codeph">%waittime%</span>). The variable you specify must be a String.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E4FBNB" class="Table_Cell"><span class="uicontrol">Repeat on</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EIGBNB" class="Table_Cell"><span class="uicontrol">FAILURE</span></div></td></tr></table></div><div id="wwID0EZGBNB" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>4. </span></span><span class="Command">Beneath the REPEAT step, use the following steps to insert each step that you want to repeat: </span></div><div id="wwID0EWHBNB" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span><span class="Command">Insert a flow step using the buttons on the flow service editor toolbar. </span></div><div class="ww_skin_page_overflow"><div id="wwID0EOIBNB" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span><span class="Command">Indent that flow step using <img class="Default" src="../integration-server-integrated-webhelp/images/move_right.gif" width="100%" style="display: inline; float: none; left: 0pt; max-height: 11px; max-width: 11px; top: 0pt" alt="" /> on the flow service editor toolbar. (Make it a child of the REPEAT step.) </span></div></div><div id="wwID0ETJBNB" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span><span class="Command">Set the properties for the child step as needed. </span></div><div id="wwID0ENKBNB" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>5. </span></span><span class="Command">Click </span><span class="Command_002c_uicontrol">File &gt; Save</span><span class="Command">. </span></div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright © 2007-2022&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>