<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>How to Create a Service that Sends a Reply Document</title><link rel="Prev" href="to-publishing_documents_18.html" title="Previous" /><link rel="Next" href="esb_2.blt.html" title="Next" /><link rel="StyleSheet" href="css/is_integrated_webhelp.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/is_integrated_webhelp_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/integration-server-integrated-webhelp/to-publishing_documents_19.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pfXs7ipUoRG_002fJhf5Cbh5G_002bA" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/integration-server-integrated-webhelp/to-publishing_documents_19.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>Integration Server</span>&nbsp;10.11 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../integration-server-integrated-webhelp/to-webhelp_intro_is_pubsub_guide.html#wwconnect_header">Publish-Subscribe Developer’s Guide</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../integration-server-integrated-webhelp/to-publishing_documents.html#wwconnect_header">Publishing Documents</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../integration-server-integrated-webhelp/to-publishing_documents_17.html#wwconnect_header">Replying to a Published or Delivered Document</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">How to Create a Service that Sends a Reply Document</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0EBLC4B" class="Heading_3">How to Create a Service that Sends a Reply Document</div><div id="wwID0ERLC4B" class="Body">The following describes the general steps you take to code a service that sends a reply document in response to a received document.</div><div id="wwID0E4LC4B" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span><span class="Command"> </span><span class="Command_002c_inlinetitle">Declare a document reference to the publishable document type.</span><span class="Command"> In the input signature of the service, declare a document reference to the publishable document type for the received document. The name of the document reference must be the fully qualified name of the publishable document type.</span></div><div id="wwID0EBNC4B" class="Body_1">If you intend to use the service to reply to documents that satisfy a join condition (a condition that associates multiple publishable document types with a service), the service’s input signature must have a document reference for each publishable document type. The names of these document reference fields must be the fully qualified names of the publishable document type they reference.</div><div id="wwID0EINC4B" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span><span class="Command"> </span><span class="Command_002c_inlinetitle">Create a document reference to the publishable document type that you want to use as the reply document.</span><span class="Command"> You can accomplish this by:</span></div><div id="wwID0ESOC4B" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Declaring a document reference in the input signature of the replying service</div><div id="wwID0EFPC4B" class="List_2_Continued">-OR-</div><div id="wwID0ELPC4B" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>Inserting a MAP step in the replying service and adding the document reference to <span class="uicontrol">Pipeline Out</span>. You must <span class="emphasis">immediately</span> link or assign a value to the document reference. If you do not, the document reference is automatically cleared the next time the Pipeline view is refreshed.</div><div id="wwID0EIQC4B" class="Note_1"><span class="Bold">Note:<br /></span>If the publishing service requires that the reply document be an instance of a specific publishable document type, make sure that the document reference variable refers to this publishable document type.</div><div class="ww_skin_page_overflow"><div id="wwID0EARC4B" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span><span class="Command"> </span><span class="Command_002c_inlinetitle">Add content to the reply document.</span><span class="Command"> You can add content to the reply document by linking fields to the document reference or by using the </span><span class="Command_002c_uicontrol">Set Value</span><span class="Command"> modifier <img class="Default" src="../integration-server-integrated-webhelp/images/pipesetvalue_3.gif" width="100%" style="display: inline; float: none; left: 0pt; max-height: 16px; max-width: 16px; top: 0pt" alt="" /> to assign values to the fields in the document reference.</span></div></div><div id="wwID0EPSC4B" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>4. </span></span><span class="Command"> </span><span class="Command_002c_inlinetitle">Assign values to fields in the envelope (_</span><span class="Command_002c_inlinetitle_002c_varname">env</span><span class="Command_002c_inlinetitle"> field) of the reply document.</span><span class="Command"> When a service or adapter notification publishes a document, </span><span class="Command_002c_Command">Integration Server</span><span class="Command"> and </span><span class="Command_002c_Command">Broker</span><span class="Command"> automatically assign values to fields in the document envelope. When you create a service that sends a reply document, </span><span class="Command_002c_Command">Integration Server</span><span class="Command"> uses the field in the envelope of the received document to populate the reply document envelope. However, you can manually set some of these fields. </span><span class="Command_002c_Command">Integration Server</span><span class="Command"> and </span><span class="Command_002c_Command">Broker</span><span class="Command"> do not overwrite fields that you set manually. For more information, see </span>
    <a href="../integration-server-integrated-webhelp/to-publishing_documents_3.html#wwID0ELG23B"
   
     title="Setting Fields in the Document Envelope"
    ><span class="Command_002c_heading-page">Setting Fields in the Document Envelope</span></a><span class="Command">.</span></div><div id="wwID0E4UC4B" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>5. </span></span><span class="Command"> </span><span class="Command_002c_inlinetitle">Set values for custom header fields.</span><span class="Command"> When publishing a document to </span><span class="Command_002c_Command">Universal Messaging</span><span class="Command">, you can add custom header fields to the document by assigning values to a </span><span class="Command_002c_varname">_properties</span><span class="Command"> document variable in the publishable document type. </span><span class="Command_002c_Command">Integration Server</span><span class="Command"> adds the contents of </span><span class="Command_002c_varname">_properties</span><span class="Command"> as name=value pairs to the header. Subscribers of the publishable document type can register filters that indicate which documents the subscriber wants to receive based on the custom header field contents. When </span><span class="Command_002c_Command">Universal Messaging</span><span class="Command"> receives the published document, it applies the filter and only routes the document to the subscriber if the filter criteria is met.</span></div><div id="wwID0E1WC4B" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>6. </span></span><span class="Command"> </span><span class="Command_002c_inlinetitle">Invoke pub.publish:reply to publish the reply document.</span><span class="Command"> This service takes the reply document you created and delivers it to the client specified in the envelope of the received document.</span></div><div id="wwID0E5XC4B" class="Body_1">The <span class="apiname">pub.publish:reply</span> service expects to find a document (IData object) named <span class="varname">document</span> in the pipeline. If you are building a flow service, you will need to use the Pipeline view to map the document reference for the document you want to publish to <span class="varname">document</span>.</div><div id="wwID0ETYC4B" class="Body_1">In addition to the document reference that you map into <span class="varname">document</span>, you must provide the following parameters to the <span class="apiname">pub.publish:reply</span> service.</div><div class="ww_skin_page_overflow"><table class="norules2" cellspacing="4" summary=""><tr><td class="Table_Cell_Head" style="border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: 29.9%"><div id="wwID0EJ1C4B" class="Table_Cell_Head">Name</div></td><td class="Table_Cell_Head" style="border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: 70%"><div id="wwID0EP1C4B" class="Table_Cell_Head">Description</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E51C4B" class="Table_Cell"><span class="varname">documentTypeName</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EK2C4B" class="Table_Cell">A String specifying the fully qualified name of the publishable document type for the reply document. The publishable document type must exist on <span class="ph">Integration Server</span>.</div></td></tr></table></div><div id="wwID0EZ2C4B" class="Important_1"><span class="Bold">Important:<br /></span>Services that publish or deliver a request and wait for a reply can specify a publishable document type to which reply documents must conform. If the reply document is not of the type specified in <span class="varname">receiveDocumentTypeName</span> parameter of the <span class="apiname">pub.publish:publishAndWait</span> or <span class="apiname">pub.publish:deliverAndWait</span> service, the publishing service will not receive the reply. You need to work closely with the developer of the publishing service to make sure that your reply document is an instance of the correct publishable document type.</div><div id="wwID0E63C4B" class="Body_1">You may also provide the following optional parameters.</div><div class="ww_skin_page_overflow"><table class="norules2" cellspacing="4" summary=""><tr><td class="Table_Cell_Head" style="border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: 32.7%"><div id="wwID0EK5C4B" class="Table_Cell_Head">Name</div></td><td class="Table_Cell_Head" style="border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: 67.2%"><div id="wwID0EQ5C4B" class="Table_Cell_Head">Description</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E65C4B" class="Table_Cell"><span class="varname">receivedDocumentEnvelope</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EL6C4B" class="Table_Cell">A document (IData object) containing the envelope of the received document. By default, <span class="ph">Integration Server</span> uses the information in the received document’s envelope to determine where to send the reply document.</div><div id="wwID0EV6C4B" class="Table_Cell">If the service executes because two or more documents satisfied an <span class="uicontrol">All (AND)</span> join condition, <span class="ph">Integration Server</span> uses the envelope of the last document that satisfied the join condition. If you want <span class="ph">Integration Server</span> to always use the envelope from the same document type, link the envelope of that publishable document type to <span class="varname">receivedDocumentEnvelope</span>. If you want each document publisher to receive a reply document, you must invoke the <span class="apiname">pub.publish:reply</span> service for each document in the join.</div></td></tr></table></div><div id="wwID0EWAD4B" class="Important_1"><span class="Bold">Important:<br /></span>If the replying service executes because a document satisfied an <span class="uicontrol">Any (OR)</span> or <span class="uicontrol">Only one (XOR)</span> join condition, do not map or assign a value to the <span class="varname">receivedDocumentEnvelope</span>. It is impossible to know which document in the <span class="uicontrol">Any (OR)</span> or <span class="uicontrol">Only one (XOR)</span> join will be received first. For example, suppose that an <span class="uicontrol">Only one (XOR)</span> join condition specified document types documentA and documentB. <span class="ph">Integration Server</span> uses the envelope of whichever document it received first as the <span class="varname">receivedDocumentEnvelope</span> value. If you map the envelope of documentA to <span class="varname">receivedDocumentEnvelope</span>, but <span class="ph">Integration Server</span> receives documentB first, the reply service will fail.</div><div class="ww_skin_page_overflow"><table class="norules2" cellspacing="4" summary=""><tr><td class="Table_Cell_Head" style="border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: 30.4%"><div id="wwID0EFED4B" class="Table_Cell_Head">Name</div></td><td class="Table_Cell_Head" style="border-bottom-color: #0899CC; border-bottom-style: solid; border-bottom-width: thin; padding-left: 2pt; padding-right: 2pt; width: 69.5%" colspan="2"><div id="wwID0ELED4B" class="Table_Cell_Head">Description</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top; width: 30.4%"><div id="wwID0E3ED4B" class="Table_Cell"><span class="varname">delayUntilServiceSuccess</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top; width: 69.5%" colspan="2"><div id="wwID0EIFD4B" class="Table_Cell">A String specifying that <span class="ph">Integration Server</span> will delay publishing the reply document until the top-level service executes successfully. If the top-level service fails, <span class="ph">Integration Server</span> will not publish the reply document.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top; width: 30.4%"></td><td class="internalheadrule" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top; width: 18.1%"><div id="wwID0EEGD4B" class="internalheadrule">Set to...</div></td><td class="internalheadrule" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top; width: 51.3%"><div id="wwID0EKGD4B" class="internalheadrule">To...</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0E2GD4B" class="Table_Cell"><span class="codeph">true</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EGHD4B" class="Table_Cell">Delay publishing until after the top-level service executes successfully.</div></td></tr><tr><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0EXHD4B" class="Table_Cell"><span class="codeph">false</span></div></td><td class="Table_Cell" style="padding-left: 2pt; padding-right: 2pt; vertical-align: top"><div id="wwID0ECID4B" class="Table_Cell">Publish the document when the <span class="apiname">pub.publish:reply</span> service executes. This is the default.</div></td></tr></table></div><div id="wwID0EUID4B" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>7. </span></span><span class="Command"> </span><span class="Command_002c_inlinetitle">Build a trigger.</span><span class="Command"> For this service to execute when </span><span class="Command_002c_Command">Integration Server</span><span class="Command"> receives documents of a specified type, you need to create a trigger. The trigger needs to contain a condition that associates the publishable document type used for the request document with this reply service. For more information about creating a trigger, see </span><span class="Command_002c_Command"> </span><span class="Command_002c_Command_002c_Citation">webMethods Service Development Help</span><span class="Command">.</span></div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright © 2007-2022&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>