<!DOCTYPE html ><html xml:lang="en" lang="en" data-highlight-require-whitespace="true" xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="shortcut icon" href="favicon.ico" type="image/x-icon" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><title>Configure API Portal with Microsoft® SQL Server</title><link rel="Prev" href="co-config_configuration_api_portal_external_db.html" title="Previous" /><link rel="Next" href="ta-config_apiportal_oracle_db.html" title="Next" /><link rel="StyleSheet" href="css/_apiportal_integrated_webhelp_restructured_diba2.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/skin.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/social.css" type="text/css" media="all" /><link rel="StyleSheet" href="css/webworks.css" type="text/css" media="all" /><!--[if IE 7]><link rel="StyleSheet" href="css/_apiportal_integrated_webhelp_restructured_diba2_IE7.css" type="text/css" media="all" /><![endif]--><link rel="StyleSheet" href="css/print.css" type="text/css" media="print" /><script type="text/javascript">
    'use strict';

    var redirect_url, page_hash;

    if ((window === window.top) && (window.navigator.userAgent.indexOf('bot/') === -1)) {
        // Redirect
        //
        redirect_url = "../index.html#page/api-portal-integrated-webhelp/ta-config_apiportal_ms_sqlserver.html";
        if (window.document.location.hash.length > 1) {
            // Sanitize and append it
            //
            page_hash = window.document.location.hash.substring(1);
            page_hash = page_hash.replace(/[\\><:;"]|%5C|%3C|%3E|%3A|%3B|%22/gi, '');
            redirect_url += '#' + page_hash;
        }
        window.document.location.replace(redirect_url);
    }
</script><script type="text/javascript" src="scripts/common.js"></script><script type="text/javascript" src="scripts/page.js"></script><script type="text/javascript" src="scripts/search-client.js"></script><script type="text/javascript" src="scripts/unidata.js"></script><script type="text/javascript" src="scripts/unibreak.js"></script></head><body id="pKWLL_002fknSIQr5V8FCYp_002bhjQ" class="ww_skin_page_body" onload="Page.OnLoad('../index.html#page/api-portal-integrated-webhelp/ta-config_apiportal_ms_sqlserver.html');"><header id="wwconnect_header"><!-- Produkt Name und Version in Breadcrumbs SQ --><div class="ww_skin_breadcrumbs"><span>API Portal</span>&nbsp;10.7 |
		     <span class="ww_skin_breadcrumbs_parent"><a href="../api-portal-integrated-webhelp/_apiportal_integrated_webhelp_restructured_diba2.1.006.html#wwconnect_header">webMethods API Portal for Administrators</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../api-portal-integrated-webhelp/_apiportal_integrated_webhelp_restructured_diba2.1.028.html#wwconnect_header">Configuring API Portal</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_parent"><a href="../api-portal-integrated-webhelp/co-config_configuration_api_portal_external_db.html#wwconnect_header">Configuring API Portal with External Databases</a></span><span class="ww_skin_breadcrumbs_divider"> | </span><span class="ww_skin_breadcrumbs_current">Configure API Portal with Microsoft® SQL Server</span></div><div class="ww_skin_page_toolbar"><a class="ww_behavior_print ww_skin ww_skin_print" title="Print" href="#">&nbsp;</a></div></header><div id="wwID0E1GHM" class="Heading_3">Configure <span class="ph">API Portal</span> with Microsoft<span class="Superscript">®</span> SQL Server</div><div id="wwID0ETHHM" class="Body">To customize the <span class="ph">API Portal</span> with Microsoft<span class="Superscript">®</span> SQL Server 2016 and SQL Server 2017, you need the following components:</div><div id="wwID0EHIHM" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>An operating Microsoft<span class="Superscript">®</span> SQL Server database.</div><div id="wwID0E6IHM" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>The Microsoft<span class="Superscript">®</span> JDBC Driver sqljdbc7.jar. You can download this driver from the Microsoft Web Site to a directory of your choice.</div><div id="wwID0EXJHM" class="List_1"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>SQL scripts and all additional files. These scripts can be downloaded from the 
    <a href="http://aris.softwareag.com"
   
     target="external_window"
    ><span class="heading-page">ARIS Download Center</span></a>. For <span class="ph">API Portal</span> 10.7, you must download the 10SR14 scripts (ARIS10.0.SR14.DatabaseScripts.zip)</div><div id="wwID0E1KHM" class="Body">The SQL scripts creates a database and necessary database objects required by the <span class="ph">API Portal</span> components.</div><div id="wwID0EELHM" class="Note"><span class="Bold">Note:<br /></span>Database scripts should be executed from the machine where sqlcmd client is running.</div><div id="wwID0E1LHM" class="procedure"><span><img src="icon_task_xpe.png" alt="*" border="0" width="20" height="13" /></span>To configure <span class="ph">API Portal</span> with Microsoft <span class="Superscript">®</span> SQL Server</div><div id="wwID0EQMHM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>1. </span></span><span class="Command">Back up data from </span><span class="Command_002c_Command">API Portal</span><span class="Command">. </span></div><div id="wwID0EUNHM" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span><span class="Command">Log on to </span><span class="Command_002c_Command">API Portal</span><span class="Command"> as an Administrator. </span></div><div class="ww_skin_page_overflow"><div id="wwID0ETOHM" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span><span class="Command">Click <img class="Default" src="../api-portal-integrated-webhelp/images/menu.png" width="100%" style="display: inline; float: none; left: 0pt; max-height: 11px; max-width: 14px; top: 0pt" alt="" /> in the right top corner of the </span><span class="Command_002c_Command">API Portal</span><span class="Command"> window to display the menu options. </span></div></div><div id="wwID0E3PHM" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span><span class="Command">Click </span><span class="Command_002c_uicontrol">Administration</span><span class="Command"> &gt; </span><span class="Command_002c_uicontrol">Manage data</span><span class="Command">. </span></div><div id="wwID0EBRHM" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span><span class="Command">Select </span><span class="Command_002c_uicontrol">Backup</span><span class="Command">. </span></div><div id="wwID0EASHM" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>e. </span></span><span class="Command">Select the relevant options and click </span><span class="Command_002c_uicontrol">Backup</span><span class="Command">. </span></div><div id="wwID0E6SHM" class="Step_Info_2">A success message appears when the backup process is completed. The backup file with an extension <span class="codeph">.acb</span> is created and saved in the downloads section. You can move the file and save it in another location of your choice.</div><div id="wwID0EMTHM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>2. </span></span><span class="Command">Open </span><span class="Command_002c_Command">API Portal Cloud Controller</span><span class="Command"> and execute the following commands. </span></div><div id="wwID0EQUHM" class="Preformatted_1">stopall <br />deconfigure postgres_s<br />start zoo_s <br />												</div><div id="wwID0EYUHM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>3. </span></span><span class="Command">To configure envset.bat, login to the machine where MSSQL server is running and go to the directory where the script files are downloaded from ARIS Download centre. Scripts are present in the folder, </span><span class="Command_002c_filepath_002c_varname">download_root_folder</span><span class="Command_002c_filepath">\ARIS.xxx.DatabaseScripts\DatabaseScripts\Design&amp;ConnectServer\mssql </span><span class="Command"> </span></div><div id="wwID0ECWHM" class="Note_1"><span class="Bold">Note:<br /></span>For <span class="ph">API Portal</span> 10.7, download <span class="codeph">ARIS.10.0.SR14.DatabaseScripts.zip</span> file. If it is not available, then download <span class="codeph">ARIS.10.0.SR13.DatabaseScripts.zip</span>.</div><div id="wwID0EGXHM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>4. </span></span><span class="Command">Open the </span><span class="Command_002c_cmdname">envset.bat</span><span class="Command"> file, modify the following fields, and save the file: </span></div><div id="wwID0EQYHM" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>SET MSSQL_SAG_MSSQL_SERVER_NAME=<span class="varname">Server Name (Machine name where MSSQL server is running)</span></div><div id="wwID0EIZHM" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>SET MSSQL_SAG_DATABASE_NAME=<span class="varname">Database name (Ex: Portal107DB)</span></div><div id="wwID0EA1HM" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>SET MSSQL_SAG_FILEGROUP_FILE_DIR=<span class="varname">MS SQL file path</span> (for example, C:\msqldata\<span class="varname">Database name</span></div><div id="wwID0E41HM" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>SET MSSQL_SAG_APP_USER=<span class="varname">UserName (Application username which will be created. Ex: dbuser)</span></div><div id="wwID0EV2HM" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span>SET MSSQL_SAG_APP_PWD=<span class="varname">Password (Password of the application user. Ex: dbuser123)</span></div><div id="wwID0EQ3HM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>5. </span></span><span class="Command">Before running the database scripts ensure that the Microsoft SQL Server client (sqlcmd) is available in the command prompt. Run the </span><span class="Command_002c_cmdname">inst.bat</span><span class="Command"> file; this drops the existing schema and creates new schema. Run the following 2 commands, which will create 2 schemas, one for the master tenant and one for the default tenant. </span></div><div id="wwID0E14HM" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="cmdname">create_schema_for_tenant.bat CIP_MASTER</span></div><div id="wwID0ER5HM" class="List_2"><span class="WebWorks_Number" style="width: 18pt"><span><img src="chapterTOC_bullet.png" alt="*" border="0" width="10" height="10" /></span></span><span class="cmdname">create_schema_for_tenant.bat CIP_DEFAULT</span></div><div id="wwID0EL6HM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>6. </span></span><span class="Command">Switch to the machine where API Portal is installed. Add the JDBC drivers to </span><span class="Command_002c_Command">API Portal</span><span class="Command"> classpath. </span></div><div id="wwID0EPAIM" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span><span class="Command">Start </span><span class="Command_002c_Command">API Portal Cloud Controller</span><span class="Command">. </span></div><div id="wwID0EOBIM" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span><span class="Command">Run the following command: </span></div><div id="wwID0ELCIM" class="Preformatted_2">enhance apiportalbundle_s with commonsClasspath <br />local file "<span class="varname">sqljdbc_jar_location</span>"</div><div id="wwID0EXCIM" class="Body_2">Example:</div><div id="wwID0E3CIM" class="Preformatted_2">ACC + localhost&gt; enhance apiportalbundle_s with commonsClasspath<br />local file "C:/jars/sqlserver/sqljdbc7.jar"</div><div id="wwID0EGDIM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>7. </span></span><span class="Command">Register the external service database. </span></div><div id="wwID0EDEIM" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span><span class="Command">In </span><span class="Command_002c_Command">API Portal Cloud Controller</span><span class="Command">, run the following commands: </span></div><div id="wwID0EHFIM" class="Preformatted_2">register external service db url="jdbc:sqlserver://<br />servername:port;<br />DatabaseName=databasename" <br />driverClassName="com.microsoft.sqlserver.jdbc.SQLServerDriver" <br />username="<span class="varname">app_username</span>" password="<span class="varname">app_password</span>" <br />maxIdle=15 maxActive=300 maxWait=10000 <br />removeAbandoned=false removeAbandonedTimeout=600 <br />logAbandoned=true defaultAutoCommit=false <br />rollbackOnReturn=true host=servername jmxEnabled=true<br />database.admin.user="<span class="varname">database.admin.user</span>" <br />database.admin.password="<span class="varname">database.admin.password</span>"</div><div id="wwID0ECFIM-2" class="Step_Info_2">For example,</div><div id="wwID0ECGIM" class="Preformatted_2">register external service db url="jdbc:sqlserver://<br />machinename:1433;<br />DatabaseName=PORTAL107DB" <br />driverClassName="com.microsoft.sqlserver.jdbc.SQLServerDriver" <br />username="<span class="varname">dbuser107</span>" password="<span class="varname">dbuser107123</span>" <br />maxIdle=15 maxActive=300 maxWait=10000 <br />removeAbandoned=false removeAbandonedTimeout=600 <br />logAbandoned=true defaultAutoCommit=false <br />rollbackOnReturn=true host=machinename jmxEnabled=true <br />database.admin.user="<span class="varname">sa</span>" <br />database.admin.password="<span class="varname">Password</span>"</div><div id="wwID0E5GIM" class="Step_Info_2">An external service identifier is returned once the above command is executed, for example, it returns the service id as db0000000000.</div><div id="wwID0EEHIM" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span><span class="Command">Run the following command to assign the service to the default and master tenants: </span><span class="Command"> </span><span class="Command"> </span></div><div id="wwID0EOIIM" class="Preformatted_2">assign tenant default to service db0000000000 com.aris.cip.db.schema=CIP_DEFAULT<br />assign tenant master to service db0000000000 com.aris.cip.db.schema=CIP_MASTER</div><div id="wwID0EYIIM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>8. </span></span><span class="Command">In </span><span class="Command_002c_Command">API Portal Cloud Controller</span><span class="Command">, run the following command to start all the runnables: </span></div><div id="wwID0E3JIM" class="Preformatted_1">startall</div><div id="wwID0EEKIM" class="Step_1"><span class="WebWorks_Number" style="width: 18pt"><span>9. </span></span><span class="Command">Restore the backed up data. </span></div><div id="wwID0EBLIM" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>a. </span></span><span class="Command">Log on to </span><span class="Command_002c_Command">API Portal</span><span class="Command"> as an Administrator. </span></div><div class="ww_skin_page_overflow"><div id="wwID0EAMIM" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>b. </span></span><span class="Command">Click <img class="Default" src="../api-portal-integrated-webhelp/images/menu.png" width="100%" style="display: inline; float: none; left: 0pt; max-height: 11px; max-width: 14px; top: 0pt" alt="" /> in the right top corner of the </span><span class="Command_002c_Command">API Portal</span><span class="Command"> window to display the menu options. </span></div></div><div id="wwID0EJNIM" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>c. </span></span><span class="Command">Click </span><span class="Command_002c_uicontrol">Administration</span><span class="Command"> &gt; </span><span class="Command_002c_uicontrol">Manage data</span><span class="Command">. </span></div><div id="wwID0EOOIM" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>d. </span></span><span class="Command">Select </span><span class="Command_002c_uicontrol">Restore</span><span class="Command">. </span></div><div id="wwID0ENPIM" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>e. </span></span><span class="Command">Click </span><span class="Command_002c_uicontrol">Upload</span><span class="Command"> and select the relevant backup file to be uploaded. </span></div><div id="wwID0EMQIM" class="Substep_2"><span class="WebWorks_Number" style="width: 18pt"><span>f. </span></span><span class="Command">Select the relevant options and click </span><span class="Command_002c_uicontrol">Restore</span><span class="Command">. </span></div><div id="wwID0ELRIM" class="Step_Info_2">A success message appears when the restore process is completed.</div><footer><!-- Related Topics --><!--                --><!-- Disqus --><!--        --><!-- Google Translation --><!--                    --><!-- SQ insert Footer --><br /><hr style="border:1px solid; border-color: #1776BF; " /><!-- FRWE: Why is the font family information hard-coded?? --><div style="font-family: 'Roboto', Sans-Serif; font-size: 10px; margin-top: 6px; margin-bottom: 6px; text-align: center;"><a href="http://www.softwareag.com/licenses">Copyright © 2014-2022&nbsp;Software AG, Darmstadt, Germany and/or Software AG USA, Inc., Reston, VA, USA, and/or its subsidiaries and/or its affiliates and/or their licensors</a></div><!-- SQ insert Date 
	 <div style="text-align: center; font-weight: bold;" wwpage:content="pub-date">January 1, 2015</div> --><!-- old Footer 2016
	  <div class="footer">Copyright &#169; <span wwpage:content="sag:product-copyrfirst"></span>, <span wwpage:content="sag:organization-copyrholder"></span>, <a href="http://sag.com/" wwpage:attribute-href="sag:organization-url" wwpage:content="sag:organization-url">http://sag.com/</a>
   --><!-- SQ Variablen --><!-- Copyright Test --><!--	  <div style="text-decoration: underline">Copyright Import Test:</div>
	  <wwpage:Import wwpage:content-from-file="Copyright/copyright_en.asp" />
	  <br></br>--><!--
	  <!-\- SQ Variables - Information from xresources -\->
	  <div style="text-decoration: underline">From xresources:</div>
	  <div>sag:organization-id == <span wwpage:content="sag:organization-id"></span></div>
	  <div>sag:organization-name == <span wwpage:content="sag:organization-name"></span></div>
	  <div>sag:organization-copyrholder == <span wwpage:content="sag:organization-copyrholder"></span></div>
	  <div>sag:organization-url == <span wwpage:content="sag:organization-url"></span></div>
	  
	  <div>sag:family-id == <span wwpage:content="sag:family-id"></span></div>
	  <div>sag:family-name == <span wwpage:content="sag:family-name"></span></div>
	  <div>sag:family-organization == <span wwpage:content="sag:family-organization"></span></div>
	  
	  <div>sag:product-id == <span wwpage:content="sag:product-id"></span></div>
	  <div>sag:product-name == <span wwpage:content="sag:product-name"></span></div>
	  <div>sag:product-copyrfirst == <span wwpage:content="sag:product-copyrfirst"></span></div>
	  <div>sag:product-family == <span wwpage:content="sag:product-family"></span></div>
	  
	  <!-\- SQ Variables - Values from DITA-Map and Keymap-\->
	  <br></br>
	  <div style="text-decoration: underline">From DITA/Book-Map:</div>
	  <div>ProdInfo Prodname == <span wwpage:replace="wwvars:ProdInfoProdName"></span></div>
	  <div>ProdInfo Mod First == <span wwpage:replace="wwvars:ProdInfoModFirst"></span></div>
	  <div>ProdInfo Mod Last == <span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>ProdInfo Rel First == <span wwpage:replace="wwvars:ProdInfoRelFirst"></span></div>
	  <div>ProdInfo Rel Last == <span wwpage:replace="wwvars:ProdInfoRelLast"></span></div>
	  <div>ProdInfo Vers First == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span></div>
	  <div>ProdInfo Vers Last == <span wwpage:replace="wwvars:ProdInfoVersLast"></span></div>
	  <div>ProdInfo vrm vers.rel.mod == <span wwpage:replace="wwvars:ProdInfoVersFirst"></span>.<span wwpage:replace="wwvars:ProdInfoRelLast"></span>.<span wwpage:replace="wwvars:ProdInfoModLast"></span></div>
	  <div>BookID PartNo == <span wwpage:replace="wwvars:BookPartNo"></span></div>
	  <div>othermeta release-version == <span wwpage:replace="wwvars:ReleaseVersion"></span></div>
	  <div>othermeta release-date == <span wwpage:replace="wwvars:ReleaseDate"></span></div>
	  <div>othermeta release-edition == <span wwpage:replace="wwvars:ReleaseEdition"></span></div>
	  <div>othermeta product == <span wwpage:replace="wwvars:Product"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">From x_runtime/keymap.ditamap:</div>
	  <div>sag:product-shortname == <span wwpage:replace="wwvars:sag:product-shortname"></span></div>
	  <div>sag:product-longname == <span wwpage:replace="wwvars:sag:product-longname"></span></div>
	  <div>versionAdd == <span wwpage:replace="wwvars:versionAdd"></span></div>
	  <div>yearFYLY == <span wwpage:replace="wwvars:yearFYLY"></span></div>
	  <div>fingerprint == <span wwpage:replace="wwvars:fingerprint"></span></div>
	  <div>sag:CopyrightDeclaration == <span wwpage:replace="wwvars:sag:CopyrightDeclaration"></span></div>
	  <div>pdfReleaseDate == <span wwpage:replace="wwvars:pdfReleaseDate"></span></div>
	  <div>documentID == <span wwpage:replace="wwvars:documentID"></span></div>
	  <br></br>
	  <div style="text-decoration: underline">Reserve:</div>
	  <div>organization == <span wwpage:content="organization"></span></div>
	  <div>product-name == <span wwpage:content="product-name"></span></div>
	  <div>copyright-first == <span wwpage:content="copyright-first"></span></div>
	  <div>copyright-last == <span wwpage:content="copyright-last"></span></div>
	  <div>copyright-first-b == <span wwpage:content="wwvars:copyright-first-b"></span></div>
	  <div>copyright-last-b == <span wwpage:content="copyright-last-b"></span></div>
	  <div>doc-id-one == <span wwpage:content="doc-id-one"></span></div>
	  <div>doc-id-two == <span wwpage:content="doc-id-two"></span></div>  
	  <div>Published == <span wwpage:content="pub-date"></span></div>
	  --></footer></body></html>